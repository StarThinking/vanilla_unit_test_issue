2020-12-03 07:23:19,564 [main] INFO  hdfs.AppendTestUtil (AppendTestUtil.java:<clinit>(53)) - seed=9039938344731020867
2020-12-03 07:23:19,578 [main] INFO  hdfs.AppendTestUtil (AppendTestUtil.java:initialValue(64)) - main: seed=-2231536638808488566
2020-12-03 07:23:19,579 [main] INFO  hdfs.AppendTestUtil (AppendTestUtil.java:randomBytes(79)) - seed=-618532509, size=10241
2020-12-03 07:23:19,640 [main] INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:<init>(493)) - starting cluster: numNameNodes=1, numDataNodes=1
2020-12-03 07:23:20,422 [main] DEBUG namenode.NameNode (NameNode.java:initializeGenericKeys(1737)) - Setting fs.defaultFS to hdfs://127.0.0.1:0
Formatting using clusterid: testClusterID
2020-12-03 07:23:20,449 [main] INFO  namenode.FSEditLog (FSEditLog.java:newInstance(229)) - Edit logging is async:true
2020-12-03 07:23:20,463 [main] INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(755)) - KeyProvider: null
2020-12-03 07:23:20,465 [main] INFO  namenode.FSNamesystem (FSNamesystemLock.java:<init>(123)) - fsLock is fair: true
2020-12-03 07:23:20,465 [main] INFO  namenode.FSNamesystem (FSNamesystemLock.java:<init>(141)) - Detailed lock hold time metrics enabled: false
2020-12-03 07:23:20,473 [main] INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(780)) - fsOwner             = root (auth:SIMPLE)
2020-12-03 07:23:20,474 [main] INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(781)) - supergroup          = supergroup
2020-12-03 07:23:20,474 [main] INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(782)) - isPermissionEnabled = true
2020-12-03 07:23:20,475 [main] INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(793)) - HA Enabled: false
2020-12-03 07:23:20,515 [main] INFO  common.Util (Util.java:isDiskStatsEnabled(395)) - dfs.datanode.fileio.profiling.sampling.percentage set to 0. Disabling file IO profiling
2020-12-03 07:23:20,521 [main] INFO  Configuration.deprecation (Configuration.java:logDeprecation(1395)) - hadoop.configured.node.mapping is deprecated. Instead, use net.topology.configured.node.mapping
2020-12-03 07:23:20,521 [main] INFO  blockmanagement.DatanodeManager (DatanodeManager.java:<init>(303)) - dfs.block.invalidate.limit: configured=1000, counted=60, effected=1000
2020-12-03 07:23:20,523 [main] INFO  blockmanagement.DatanodeManager (DatanodeManager.java:<init>(311)) - dfs.namenode.datanode.registration.ip-hostname-check=true
2020-12-03 07:23:20,529 [main] INFO  blockmanagement.BlockManager (InvalidateBlocks.java:printBlockDeletionTime(79)) - dfs.namenode.startup.delay.block.deletion.sec is set to 000:00:00:00.000
2020-12-03 07:23:20,530 [main] INFO  blockmanagement.BlockManager (InvalidateBlocks.java:printBlockDeletionTime(85)) - The block deletion will start around 2020 Dec 03 07:23:20
2020-12-03 07:23:20,533 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(395)) - Computing capacity for map BlocksMap
2020-12-03 07:23:20,533 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(396)) - VM type       = 64-bit
2020-12-03 07:23:20,536 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(397)) - 2.0% max memory 1.9 GB = 39.3 MB
2020-12-03 07:23:20,536 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(402)) - capacity      = 2^22 = 4194304 entries
2020-12-03 07:23:20,559 [main] INFO  blockmanagement.BlockManager (BlockManager.java:createSPSManager(5183)) - Storage policy satisfier is disabled
2020-12-03 07:23:20,559 [main] INFO  blockmanagement.BlockManager (BlockManager.java:createBlockTokenSecretManager(595)) - dfs.block.access.token.enable = false
2020-12-03 07:23:20,566 [main] INFO  Configuration.deprecation (Configuration.java:logDeprecation(1395)) - No unit for dfs.namenode.safemode.extension(0) assuming MILLISECONDS
2020-12-03 07:23:20,566 [main] INFO  blockmanagement.BlockManagerSafeMode (BlockManagerSafeMode.java:<init>(161)) - dfs.namenode.safemode.threshold-pct = 0.9990000128746033
2020-12-03 07:23:20,567 [main] INFO  blockmanagement.BlockManagerSafeMode (BlockManagerSafeMode.java:<init>(162)) - dfs.namenode.safemode.min.datanodes = 0
2020-12-03 07:23:20,567 [main] INFO  blockmanagement.BlockManagerSafeMode (BlockManagerSafeMode.java:<init>(164)) - dfs.namenode.safemode.extension = 0
2020-12-03 07:23:20,568 [main] INFO  blockmanagement.BlockManager (BlockManager.java:<init>(581)) - defaultReplication         = 1
2020-12-03 07:23:20,568 [main] INFO  blockmanagement.BlockManager (BlockManager.java:<init>(582)) - maxReplication             = 512
2020-12-03 07:23:20,569 [main] INFO  blockmanagement.BlockManager (BlockManager.java:<init>(583)) - minReplication             = 1
2020-12-03 07:23:20,569 [main] INFO  blockmanagement.BlockManager (BlockManager.java:<init>(584)) - maxReplicationStreams      = 2
2020-12-03 07:23:20,569 [main] INFO  blockmanagement.BlockManager (BlockManager.java:<init>(585)) - redundancyRecheckInterval  = 3000ms
2020-12-03 07:23:20,570 [main] INFO  blockmanagement.BlockManager (BlockManager.java:<init>(586)) - encryptDataTransfer        = false
2020-12-03 07:23:20,570 [main] INFO  blockmanagement.BlockManager (BlockManager.java:<init>(587)) - maxNumBlocksToLog          = 1000
2020-12-03 07:23:20,615 [main] INFO  namenode.FSDirectory (SerialNumberManager.java:<clinit>(51)) - GLOBAL serial map: bits=29 maxEntries=536870911
2020-12-03 07:23:20,616 [main] INFO  namenode.FSDirectory (SerialNumberManager.java:<clinit>(51)) - USER serial map: bits=24 maxEntries=16777215
2020-12-03 07:23:20,616 [main] INFO  namenode.FSDirectory (SerialNumberManager.java:<clinit>(51)) - GROUP serial map: bits=24 maxEntries=16777215
2020-12-03 07:23:20,616 [main] INFO  namenode.FSDirectory (SerialNumberManager.java:<clinit>(51)) - XATTR serial map: bits=24 maxEntries=16777215
2020-12-03 07:23:20,637 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(395)) - Computing capacity for map INodeMap
2020-12-03 07:23:20,638 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(396)) - VM type       = 64-bit
2020-12-03 07:23:20,639 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(397)) - 1.0% max memory 1.9 GB = 19.6 MB
2020-12-03 07:23:20,639 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(402)) - capacity      = 2^21 = 2097152 entries
2020-12-03 07:23:20,647 [main] INFO  namenode.FSDirectory (FSDirectory.java:<init>(290)) - ACLs enabled? false
2020-12-03 07:23:20,648 [main] INFO  namenode.FSDirectory (FSDirectory.java:<init>(294)) - POSIX ACL inheritance enabled? true
2020-12-03 07:23:20,648 [main] INFO  namenode.FSDirectory (FSDirectory.java:<init>(298)) - XAttrs enabled? true
2020-12-03 07:23:20,648 [main] INFO  namenode.NameNode (FSDirectory.java:<init>(362)) - Caching file names occurring more than 10 times
2020-12-03 07:23:20,655 [main] INFO  snapshot.SnapshotManager (SnapshotManager.java:<init>(124)) - Loaded config captureOpenFiles: false, skipCaptureAccessTimeOnlyChange: false, snapshotDiffAllowSnapRootDescendant: true, maxSnapshotLimit: 65536
2020-12-03 07:23:20,658 [main] INFO  snapshot.SnapshotManager (DirectoryDiffListFactory.java:init(43)) - SkipList is disabled
2020-12-03 07:23:20,665 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(395)) - Computing capacity for map cachedBlocks
2020-12-03 07:23:20,665 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(396)) - VM type       = 64-bit
2020-12-03 07:23:20,666 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(397)) - 0.25% max memory 1.9 GB = 4.9 MB
2020-12-03 07:23:20,667 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(402)) - capacity      = 2^19 = 524288 entries
2020-12-03 07:23:20,680 [main] INFO  metrics.TopMetrics (TopMetrics.java:logConf(76)) - NNTop conf: dfs.namenode.top.window.num.buckets = 10
2020-12-03 07:23:20,680 [main] INFO  metrics.TopMetrics (TopMetrics.java:logConf(78)) - NNTop conf: dfs.namenode.top.num.users = 10
2020-12-03 07:23:20,681 [main] INFO  metrics.TopMetrics (TopMetrics.java:logConf(80)) - NNTop conf: dfs.namenode.top.windows.minutes = 1,5,25
2020-12-03 07:23:20,687 [main] INFO  namenode.FSNamesystem (FSNamesystem.java:initRetryCache(996)) - Retry cache on namenode is enabled
2020-12-03 07:23:20,688 [main] INFO  namenode.FSNamesystem (FSNamesystem.java:initRetryCache(1004)) - Retry cache will use 0.03 of total heap and retry cache entry expiry time is 600000 millis
2020-12-03 07:23:20,691 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(395)) - Computing capacity for map NameNodeRetryCache
2020-12-03 07:23:20,692 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(396)) - VM type       = 64-bit
2020-12-03 07:23:20,692 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(397)) - 0.029999999329447746% max memory 1.9 GB = 603.0 KB
2020-12-03 07:23:20,693 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(402)) - capacity      = 2^16 = 65536 entries
2020-12-03 07:23:20,739 [main] INFO  namenode.FSImage (FSImage.java:format(185)) - Allocated new BlockPoolId: BP-1458564024-172.17.0.11-1606980200717
2020-12-03 07:23:20,805 [main] INFO  common.Storage (NNStorage.java:format(595)) - Storage directory /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/name-0-1 has been successfully formatted.
2020-12-03 07:23:20,968 [main] INFO  common.Storage (NNStorage.java:format(595)) - Storage directory /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/name-0-2 has been successfully formatted.
2020-12-03 07:23:21,009 [FSImageSaver for /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/name-0-1 of type IMAGE_AND_EDITS] INFO  namenode.FSImageFormatProtobuf (FSImageFormatProtobuf.java:save(512)) - Saving image file /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/name-0-1/current/fsimage.ckpt_0000000000000000000 using no compression
2020-12-03 07:23:21,009 [FSImageSaver for /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/name-0-2 of type IMAGE_AND_EDITS] INFO  namenode.FSImageFormatProtobuf (FSImageFormatProtobuf.java:save(512)) - Saving image file /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/name-0-2/current/fsimage.ckpt_0000000000000000000 using no compression
2020-12-03 07:23:21,165 [FSImageSaver for /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/name-0-1 of type IMAGE_AND_EDITS] INFO  namenode.FSImageFormatProtobuf (FSImageFormatProtobuf.java:save(516)) - Image file /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/name-0-1/current/fsimage.ckpt_0000000000000000000 of size 399 bytes saved in 0 seconds .
2020-12-03 07:23:21,165 [FSImageSaver for /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/name-0-2 of type IMAGE_AND_EDITS] INFO  namenode.FSImageFormatProtobuf (FSImageFormatProtobuf.java:save(516)) - Image file /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/name-0-2/current/fsimage.ckpt_0000000000000000000 of size 399 bytes saved in 0 seconds .
2020-12-03 07:23:21,243 [main] INFO  namenode.NNStorageRetentionManager (NNStorageRetentionManager.java:getImageTxIdToRetain(203)) - Going to retain 1 images with txid >= 0
2020-12-03 07:23:21,249 [main] INFO  namenode.NameNode (NameNode.java:createNameNode(1632)) - createNameNode []
2020-12-03 07:23:21,673 [main] INFO  impl.MetricsConfig (MetricsConfig.java:loadFirst(118)) - Loaded properties from hadoop-metrics2.properties
2020-12-03 07:23:21,789 [main] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:startTimer(374)) - Scheduled Metric snapshot period at 0 second(s).
2020-12-03 07:23:21,789 [main] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:start(191)) - NameNode metrics system started
2020-12-03 07:23:21,824 [main] INFO  namenode.NameNodeUtils (NameNodeUtils.java:getClientNamenodeAddress(79)) - fs.defaultFS is hdfs://127.0.0.1:0
2020-12-03 07:23:21,825 [main] DEBUG namenode.NameNode (NameNode.java:initializeGenericKeys(1737)) - Setting fs.defaultFS to hdfs://127.0.0.1:0
2020-12-03 07:23:21,886 [org.apache.hadoop.util.JvmPauseMonitor$Monitor@4dbb42b7] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2020-12-03 07:23:21,910 [main] INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hdfs at: http://localhost:0
2020-12-03 07:23:21,918 [main] INFO  http.HttpServer2 (HttpServer2.java:getWebAppsPath(1072)) - Web server is in development mode. Resources will be read from the source tree.
2020-12-03 07:23:21,941 [main] INFO  util.log (Log.java:initialized(192)) - Logging initialized @3924ms
2020-12-03 07:23:22,113 [main] INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2020-12-03 07:23:22,119 [main] INFO  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(81)) - Http request log for http.requests.namenode is not defined
2020-12-03 07:23:22,120 [main] INFO  http.HttpServer2 (HttpServer2.java:getWebAppsPath(1072)) - Web server is in development mode. Resources will be read from the source tree.
2020-12-03 07:23:22,135 [main] INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(990)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2020-12-03 07:23:22,138 [main] INFO  http.HttpServer2 (HttpServer2.java:addFilter(963)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hdfs
2020-12-03 07:23:22,138 [main] INFO  http.HttpServer2 (HttpServer2.java:addFilter(973)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2020-12-03 07:23:22,138 [main] INFO  http.HttpServer2 (HttpServer2.java:addFilter(973)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2020-12-03 07:23:22,174 [main] INFO  http.HttpServer2 (NameNodeHttpServer.java:initWebHdfs(102)) - Added filter 'org.apache.hadoop.hdfs.web.AuthFilter' (class=org.apache.hadoop.hdfs.web.AuthFilter)
2020-12-03 07:23:22,174 [main] INFO  http.HttpServer2 (HttpServer2.java:addJerseyResourcePackage(806)) - addJerseyResourcePackage: packageName=org.apache.hadoop.hdfs.server.namenode.web.resources;org.apache.hadoop.hdfs.web.resources, pathSpec=/webhdfs/v1/*
2020-12-03 07:23:22,185 [main] INFO  http.HttpServer2 (HttpServer2.java:bindListener(1206)) - Jetty bound to port 39815
2020-12-03 07:23:22,188 [main] INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2020-12-03 07:23:22,247 [main] INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@14bdbc74{/logs,file:///root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/log/,AVAILABLE}
2020-12-03 07:23:22,249 [main] INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@5a7fe64f{/static,file:///root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/src/main/webapps/static/,AVAILABLE}
2020-12-03 07:23:22,307 [main] INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@12299890{/,file:///root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/src/main/webapps/hdfs/,AVAILABLE}{/hdfs}
2020-12-03 07:23:22,324 [main] INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@51c693d{HTTP/1.1,[http/1.1]}{localhost:39815}
2020-12-03 07:23:22,328 [main] INFO  server.Server (Server.java:doStart(419)) - Started @4311ms
2020-12-03 07:23:22,350 [main] INFO  namenode.FSEditLog (FSEditLog.java:newInstance(229)) - Edit logging is async:true
2020-12-03 07:23:22,351 [main] INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(755)) - KeyProvider: null
2020-12-03 07:23:22,351 [main] INFO  namenode.FSNamesystem (FSNamesystemLock.java:<init>(123)) - fsLock is fair: true
2020-12-03 07:23:22,351 [main] INFO  namenode.FSNamesystem (FSNamesystemLock.java:<init>(141)) - Detailed lock hold time metrics enabled: false
2020-12-03 07:23:22,352 [main] INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(780)) - fsOwner             = root (auth:SIMPLE)
2020-12-03 07:23:22,352 [main] INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(781)) - supergroup          = supergroup
2020-12-03 07:23:22,352 [main] INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(782)) - isPermissionEnabled = true
2020-12-03 07:23:22,352 [main] INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(793)) - HA Enabled: false
2020-12-03 07:23:22,353 [main] INFO  common.Util (Util.java:isDiskStatsEnabled(395)) - dfs.datanode.fileio.profiling.sampling.percentage set to 0. Disabling file IO profiling
2020-12-03 07:23:22,354 [main] INFO  blockmanagement.DatanodeManager (DatanodeManager.java:<init>(303)) - dfs.block.invalidate.limit: configured=1000, counted=60, effected=1000
2020-12-03 07:23:22,354 [main] INFO  blockmanagement.DatanodeManager (DatanodeManager.java:<init>(311)) - dfs.namenode.datanode.registration.ip-hostname-check=true
2020-12-03 07:23:22,355 [main] INFO  blockmanagement.BlockManager (InvalidateBlocks.java:printBlockDeletionTime(79)) - dfs.namenode.startup.delay.block.deletion.sec is set to 000:00:00:00.000
2020-12-03 07:23:22,355 [main] INFO  blockmanagement.BlockManager (InvalidateBlocks.java:printBlockDeletionTime(85)) - The block deletion will start around 2020 Dec 03 07:23:22
2020-12-03 07:23:22,356 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(395)) - Computing capacity for map BlocksMap
2020-12-03 07:23:22,356 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(396)) - VM type       = 64-bit
2020-12-03 07:23:22,356 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(397)) - 2.0% max memory 1.8 GB = 36.4 MB
2020-12-03 07:23:22,357 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(402)) - capacity      = 2^22 = 4194304 entries
2020-12-03 07:23:22,373 [main] INFO  blockmanagement.BlockManager (BlockManager.java:createSPSManager(5183)) - Storage policy satisfier is disabled
2020-12-03 07:23:22,374 [main] INFO  blockmanagement.BlockManager (BlockManager.java:createBlockTokenSecretManager(595)) - dfs.block.access.token.enable = false
2020-12-03 07:23:22,374 [main] INFO  Configuration.deprecation (Configuration.java:logDeprecation(1395)) - No unit for dfs.namenode.safemode.extension(0) assuming MILLISECONDS
2020-12-03 07:23:22,375 [main] INFO  blockmanagement.BlockManagerSafeMode (BlockManagerSafeMode.java:<init>(161)) - dfs.namenode.safemode.threshold-pct = 0.9990000128746033
2020-12-03 07:23:22,375 [main] INFO  blockmanagement.BlockManagerSafeMode (BlockManagerSafeMode.java:<init>(162)) - dfs.namenode.safemode.min.datanodes = 0
2020-12-03 07:23:22,376 [main] INFO  blockmanagement.BlockManagerSafeMode (BlockManagerSafeMode.java:<init>(164)) - dfs.namenode.safemode.extension = 0
2020-12-03 07:23:22,376 [main] INFO  blockmanagement.BlockManager (BlockManager.java:<init>(581)) - defaultReplication         = 1
2020-12-03 07:23:22,376 [main] INFO  blockmanagement.BlockManager (BlockManager.java:<init>(582)) - maxReplication             = 512
2020-12-03 07:23:22,377 [main] INFO  blockmanagement.BlockManager (BlockManager.java:<init>(583)) - minReplication             = 1
2020-12-03 07:23:22,377 [main] INFO  blockmanagement.BlockManager (BlockManager.java:<init>(584)) - maxReplicationStreams      = 2
2020-12-03 07:23:22,377 [main] INFO  blockmanagement.BlockManager (BlockManager.java:<init>(585)) - redundancyRecheckInterval  = 3000ms
2020-12-03 07:23:22,378 [main] INFO  blockmanagement.BlockManager (BlockManager.java:<init>(586)) - encryptDataTransfer        = false
2020-12-03 07:23:22,378 [main] INFO  blockmanagement.BlockManager (BlockManager.java:<init>(587)) - maxNumBlocksToLog          = 1000
2020-12-03 07:23:22,379 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(395)) - Computing capacity for map INodeMap
2020-12-03 07:23:22,379 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(396)) - VM type       = 64-bit
2020-12-03 07:23:22,379 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(397)) - 1.0% max memory 1.8 GB = 18.2 MB
2020-12-03 07:23:22,380 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(402)) - capacity      = 2^21 = 2097152 entries
2020-12-03 07:23:22,386 [main] INFO  namenode.FSDirectory (FSDirectory.java:<init>(290)) - ACLs enabled? false
2020-12-03 07:23:22,386 [main] INFO  namenode.FSDirectory (FSDirectory.java:<init>(294)) - POSIX ACL inheritance enabled? true
2020-12-03 07:23:22,387 [main] INFO  namenode.FSDirectory (FSDirectory.java:<init>(298)) - XAttrs enabled? true
2020-12-03 07:23:22,387 [main] INFO  namenode.NameNode (FSDirectory.java:<init>(362)) - Caching file names occurring more than 10 times
2020-12-03 07:23:22,387 [main] INFO  snapshot.SnapshotManager (SnapshotManager.java:<init>(124)) - Loaded config captureOpenFiles: false, skipCaptureAccessTimeOnlyChange: false, snapshotDiffAllowSnapRootDescendant: true, maxSnapshotLimit: 65536
2020-12-03 07:23:22,387 [main] INFO  snapshot.SnapshotManager (DirectoryDiffListFactory.java:init(43)) - SkipList is disabled
2020-12-03 07:23:22,388 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(395)) - Computing capacity for map cachedBlocks
2020-12-03 07:23:22,388 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(396)) - VM type       = 64-bit
2020-12-03 07:23:22,388 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(397)) - 0.25% max memory 1.8 GB = 4.6 MB
2020-12-03 07:23:22,389 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(402)) - capacity      = 2^19 = 524288 entries
2020-12-03 07:23:22,390 [main] INFO  metrics.TopMetrics (TopMetrics.java:logConf(76)) - NNTop conf: dfs.namenode.top.window.num.buckets = 10
2020-12-03 07:23:22,390 [main] INFO  metrics.TopMetrics (TopMetrics.java:logConf(78)) - NNTop conf: dfs.namenode.top.num.users = 10
2020-12-03 07:23:22,390 [main] INFO  metrics.TopMetrics (TopMetrics.java:logConf(80)) - NNTop conf: dfs.namenode.top.windows.minutes = 1,5,25
2020-12-03 07:23:22,390 [main] INFO  namenode.FSNamesystem (FSNamesystem.java:initRetryCache(996)) - Retry cache on namenode is enabled
2020-12-03 07:23:22,391 [main] INFO  namenode.FSNamesystem (FSNamesystem.java:initRetryCache(1004)) - Retry cache will use 0.03 of total heap and retry cache entry expiry time is 600000 millis
2020-12-03 07:23:22,391 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(395)) - Computing capacity for map NameNodeRetryCache
2020-12-03 07:23:22,391 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(396)) - VM type       = 64-bit
2020-12-03 07:23:22,392 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(397)) - 0.029999999329447746% max memory 1.8 GB = 559.3 KB
2020-12-03 07:23:22,392 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(402)) - capacity      = 2^16 = 65536 entries
2020-12-03 07:23:22,447 [main] INFO  common.Storage (Storage.java:tryLock(923)) - Lock on /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/name-0-1/in_use.lock acquired by nodename 11675@18628722660d
2020-12-03 07:23:22,515 [main] INFO  common.Storage (Storage.java:tryLock(923)) - Lock on /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/name-0-2/in_use.lock acquired by nodename 11675@18628722660d
2020-12-03 07:23:22,519 [main] INFO  namenode.FileJournalManager (FileJournalManager.java:recoverUnfinalizedSegments(428)) - Recovering unfinalized segments in /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/name-0-1/current
2020-12-03 07:23:22,520 [main] INFO  namenode.FileJournalManager (FileJournalManager.java:recoverUnfinalizedSegments(428)) - Recovering unfinalized segments in /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/name-0-2/current
2020-12-03 07:23:22,521 [main] INFO  namenode.FSImage (FSImage.java:loadFSImage(733)) - No edit log streams selected.
2020-12-03 07:23:22,521 [main] INFO  namenode.FSImage (FSImage.java:loadFSImageFile(797)) - Planning to load image: FSImageFile(file=/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/name-0-1/current/fsimage_0000000000000000000, cpktTxId=0000000000000000000)
2020-12-03 07:23:22,559 [main] INFO  namenode.FSImageFormatPBINode (FSImageFormatPBINode.java:loadINodeSection(234)) - Loading 1 INodes.
2020-12-03 07:23:22,566 [main] INFO  namenode.FSImageFormatProtobuf (FSImageFormatProtobuf.java:load(246)) - Loaded FSImage in 0 seconds.
2020-12-03 07:23:22,566 [main] INFO  namenode.FSImage (FSImage.java:loadFSImage(978)) - Loaded image for txid 0 from /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/name-0-1/current/fsimage_0000000000000000000
2020-12-03 07:23:22,572 [main] INFO  namenode.FSNamesystem (FSNamesystem.java:loadFSImage(1110)) - Need to save fs image? false (staleImage=false, haEnabled=false, isRollingUpgrade=false)
2020-12-03 07:23:22,573 [main] INFO  namenode.FSEditLog (FSEditLog.java:startLogSegment(1365)) - Starting log segment at 1
2020-12-03 07:23:22,774 [main] INFO  namenode.NameCache (NameCache.java:initialized(143)) - initialized with 0 entries 0 lookups
2020-12-03 07:23:22,774 [main] INFO  namenode.FSNamesystem (FSNamesystem.java:loadFromDisk(727)) - Finished loading FSImage in 380 msecs
2020-12-03 07:23:23,020 [main] INFO  namenode.NameNode (NameNodeRpcServer.java:<init>(448)) - RPC server is binding to localhost:0
2020-12-03 07:23:23,061 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 1000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2020-12-03 07:23:23,075 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1219)) - Starting Socket Reader #1 for port 0
2020-12-03 07:23:23,384 [Listener at localhost/37786] INFO  namenode.NameNode (NameNode.java:initialize(722)) - Clients are to use localhost:37786 to access this namenode/service.
2020-12-03 07:23:23,389 [Listener at localhost/37786] INFO  namenode.FSNamesystem (FSNamesystem.java:registerMBean(5090)) - Registered FSNamesystemState, ReplicatedBlocksState and ECBlockGroupsState MBeans.
2020-12-03 07:23:23,416 [Listener at localhost/37786] INFO  namenode.LeaseManager (LeaseManager.java:getNumUnderConstructionBlocks(171)) - Number of blocks under construction: 0
2020-12-03 07:23:23,420 [org.apache.hadoop.hdfs.server.blockmanagement.PendingReconstructionBlocks$PendingReconstructionMonitor@609640d5] DEBUG blockmanagement.BlockManager (PendingReconstructionBlocks.java:pendingReconstructionCheck(261)) - PendingReconstructionMonitor checking Q
2020-12-03 07:23:23,433 [Listener at localhost/37786] INFO  blockmanagement.BlockManager (BlockManager.java:initializeReplQueues(4922)) - initializing replication queues
2020-12-03 07:23:23,434 [Listener at localhost/37786] INFO  hdfs.StateChange (BlockManagerSafeMode.java:leaveSafeMode(400)) - STATE* Leaving safe mode after 0 secs
2020-12-03 07:23:23,435 [Listener at localhost/37786] INFO  hdfs.StateChange (BlockManagerSafeMode.java:leaveSafeMode(406)) - STATE* Network topology has 0 racks and 0 datanodes
2020-12-03 07:23:23,435 [Listener at localhost/37786] INFO  hdfs.StateChange (BlockManagerSafeMode.java:leaveSafeMode(408)) - STATE* UnderReplicatedBlocks has 0 blocks
2020-12-03 07:23:23,440 [Reconstruction Queue Initializer] INFO  blockmanagement.BlockManager (BlockManager.java:processMisReplicatesAsync(3585)) - Total number of blocks            = 0
2020-12-03 07:23:23,440 [Reconstruction Queue Initializer] INFO  blockmanagement.BlockManager (BlockManager.java:processMisReplicatesAsync(3586)) - Number of invalid blocks          = 0
2020-12-03 07:23:23,440 [Reconstruction Queue Initializer] INFO  blockmanagement.BlockManager (BlockManager.java:processMisReplicatesAsync(3587)) - Number of under-replicated blocks = 0
2020-12-03 07:23:23,440 [Reconstruction Queue Initializer] INFO  blockmanagement.BlockManager (BlockManager.java:processMisReplicatesAsync(3588)) - Number of  over-replicated blocks = 0
2020-12-03 07:23:23,441 [Reconstruction Queue Initializer] INFO  blockmanagement.BlockManager (BlockManager.java:processMisReplicatesAsync(3590)) - Number of blocks being written    = 0
2020-12-03 07:23:23,441 [Reconstruction Queue Initializer] INFO  hdfs.StateChange (BlockManager.java:processMisReplicatesAsync(3593)) - STATE* Replication Queue initialization scan for invalid, over- and under-replicated blocks completed in 7 msec
2020-12-03 07:23:23,490 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1460)) - IPC Server Responder: starting
2020-12-03 07:23:23,490 [IPC Server listener on 0] INFO  ipc.Server (Server.java:run(1298)) - IPC Server listener on 0: starting
2020-12-03 07:23:23,494 [Listener at localhost/37786] INFO  namenode.NameNode (NameNode.java:startCommonServices(828)) - NameNode RPC up at: localhost/127.0.0.1:37786
2020-12-03 07:23:23,499 [Listener at localhost/37786] INFO  namenode.FSNamesystem (FSNamesystem.java:startActiveServices(1222)) - Starting services required for active state
2020-12-03 07:23:23,500 [Listener at localhost/37786] INFO  namenode.FSDirectory (FSDirectory.java:updateCountForQuota(777)) - Initializing quota with 4 thread(s)
2020-12-03 07:23:23,510 [Listener at localhost/37786] INFO  namenode.FSDirectory (FSDirectory.java:updateCountForQuota(786)) - Quota initialization completed in 9 milliseconds
name space=1
storage space=0
storage types=RAM_DISK=0, SSD=0, DISK=0, ARCHIVE=0, PROVIDED=0
2020-12-03 07:23:23,516 [CacheReplicationMonitor(271906504)] INFO  blockmanagement.CacheReplicationMonitor (CacheReplicationMonitor.java:run(160)) - Starting CacheReplicationMonitor with interval 30000 milliseconds
2020-12-03 07:23:23,521 [Listener at localhost/37786] INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:startDataNodes(1659)) - Starting DataNode 0 with dfs.datanode.data.dir: [DISK]file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1,[DISK]file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2
2020-12-03 07:23:23,589 [Listener at localhost/37786] INFO  checker.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(137)) - Scheduling a check for [DISK]file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1
2020-12-03 07:23:23,614 [Listener at localhost/37786] INFO  checker.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(137)) - Scheduling a check for [DISK]file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2
2020-12-03 07:23:23,654 [Listener at localhost/37786] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - DataNode metrics system started (again)
2020-12-03 07:23:23,660 [Listener at localhost/37786] INFO  common.Util (Util.java:isDiskStatsEnabled(395)) - dfs.datanode.fileio.profiling.sampling.percentage set to 0. Disabling file IO profiling
2020-12-03 07:23:23,664 [Listener at localhost/37786] INFO  datanode.BlockScanner (BlockScanner.java:<init>(184)) - Initialized block scanner with targetBytesPerSec 1048576
2020-12-03 07:23:23,668 [Listener at localhost/37786] DEBUG datanode.DataNode (DataNode.java:<init>(493)) - File descriptor passing was not configured.
2020-12-03 07:23:23,669 [Listener at localhost/37786] INFO  datanode.DataNode (DataNode.java:<init>(500)) - Configured hostname is 127.0.0.1
2020-12-03 07:23:23,670 [Listener at localhost/37786] INFO  common.Util (Util.java:isDiskStatsEnabled(395)) - dfs.datanode.fileio.profiling.sampling.percentage set to 0. Disabling file IO profiling
2020-12-03 07:23:23,675 [Listener at localhost/37786] INFO  datanode.DataNode (DataNode.java:startDataNode(1400)) - Starting DataNode with maxLockedMemory = 0
2020-12-03 07:23:23,682 [Listener at localhost/37786] INFO  datanode.DataNode (DataNode.java:initDataXceiver(1148)) - Opened streaming server at /127.0.0.1:45491
2020-12-03 07:23:23,685 [Listener at localhost/37786] INFO  datanode.DataNode (DataXceiverServer.java:<init>(78)) - Balancing bandwidth is 10485760 bytes/s
2020-12-03 07:23:23,685 [Listener at localhost/37786] INFO  datanode.DataNode (DataXceiverServer.java:<init>(79)) - Number threads for balancing is 50
2020-12-03 07:23:23,709 [Listener at localhost/37786] INFO  http.HttpServer2 (HttpServer2.java:getWebAppsPath(1072)) - Web server is in development mode. Resources will be read from the source tree.
2020-12-03 07:23:23,712 [Listener at localhost/37786] INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2020-12-03 07:23:23,719 [Listener at localhost/37786] INFO  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(81)) - Http request log for http.requests.datanode is not defined
2020-12-03 07:23:23,721 [Listener at localhost/37786] INFO  http.HttpServer2 (HttpServer2.java:getWebAppsPath(1072)) - Web server is in development mode. Resources will be read from the source tree.
2020-12-03 07:23:23,730 [Listener at localhost/37786] INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(990)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2020-12-03 07:23:23,732 [Listener at localhost/37786] INFO  http.HttpServer2 (HttpServer2.java:addFilter(963)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context datanode
2020-12-03 07:23:23,733 [Listener at localhost/37786] INFO  http.HttpServer2 (HttpServer2.java:addFilter(973)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2020-12-03 07:23:23,733 [Listener at localhost/37786] INFO  http.HttpServer2 (HttpServer2.java:addFilter(973)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2020-12-03 07:23:23,742 [Listener at localhost/37786] INFO  http.HttpServer2 (HttpServer2.java:bindListener(1206)) - Jetty bound to port 37336
2020-12-03 07:23:23,743 [Listener at localhost/37786] INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2020-12-03 07:23:23,745 [Listener at localhost/37786] INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@6d366c9b{/logs,file:///root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/log/,AVAILABLE}
2020-12-03 07:23:23,746 [Listener at localhost/37786] INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@24faea88{/static,file:///root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/src/main/webapps/static/,AVAILABLE}
2020-12-03 07:23:23,755 [Listener at localhost/37786] INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@68759011{/,file:///root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/src/main/webapps/datanode/,AVAILABLE}{/datanode}
2020-12-03 07:23:23,757 [Listener at localhost/37786] INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@7e242b4d{HTTP/1.1,[http/1.1]}{localhost:37336}
2020-12-03 07:23:23,762 [Listener at localhost/37786] INFO  server.Server (Server.java:doStart(419)) - Started @5745ms
2020-12-03 07:23:24,473 [Listener at localhost/37786] INFO  web.DatanodeHttpServer (DatanodeHttpServer.java:start(255)) - Listening HTTP traffic on /127.0.0.1:33275
2020-12-03 07:23:24,474 [org.apache.hadoop.util.JvmPauseMonitor$Monitor@2cd2c8fe] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2020-12-03 07:23:24,476 [Listener at localhost/37786] INFO  datanode.DataNode (DataNode.java:startDataNode(1428)) - dnUserName = root
2020-12-03 07:23:24,476 [Listener at localhost/37786] INFO  datanode.DataNode (DataNode.java:startDataNode(1429)) - supergroup = supergroup
2020-12-03 07:23:24,499 [Listener at localhost/37786] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 5000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2020-12-03 07:23:24,502 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1219)) - Starting Socket Reader #1 for port 0
2020-12-03 07:23:24,511 [Listener at localhost/33659] INFO  datanode.DataNode (DataNode.java:initIpcServer(1034)) - Opened IPC server at /127.0.0.1:33659
2020-12-03 07:23:24,529 [Listener at localhost/33659] DEBUG datanode.DataNode (ErasureCodingWorker.java:initializeStripedReadThreadPool(76)) - Using striped reads
2020-12-03 07:23:24,531 [Listener at localhost/33659] DEBUG datanode.DataNode (ErasureCodingWorker.java:initializeStripedBlkReconstructionThreadPool(107)) - Using striped block reconstruction; pool threads=8
2020-12-03 07:23:24,534 [Listener at localhost/33659] INFO  datanode.DataNode (BlockPoolManager.java:refreshNamenodes(149)) - Refresh request received for nameservices: null
2020-12-03 07:23:24,536 [Listener at localhost/33659] INFO  datanode.DataNode (BlockPoolManager.java:doRefreshNamenodes(210)) - Starting BPOfferServices for nameservices: <default>
2020-12-03 07:23:24,549 [Thread-59] INFO  datanode.DataNode (BPServiceActor.java:run(817)) - Block pool <registering> (Datanode Uuid unassigned) service to localhost/127.0.0.1:37786 starting to offer service
2020-12-03 07:23:24,556 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1460)) - IPC Server Responder: starting
2020-12-03 07:23:24,556 [IPC Server listener on 0] INFO  ipc.Server (Server.java:run(1298)) - IPC Server listener on 0: starting
2020-12-03 07:23:24,635 [Listener at localhost/33659] DEBUG hdfs.DFSClient (DFSClient.java:<init>(318)) - Sets dfs.client.block.write.replace-datanode-on-failure.min-replication to 0
2020-12-03 07:23:24,914 [Thread-59] DEBUG datanode.DataNode (BPServiceActor.java:retrieveNamespaceInfo(232)) - Block pool <registering> (Datanode Uuid unassigned) service to localhost/127.0.0.1:37786 received versionRequest response: lv=-65;cid=testClusterID;nsid=1892489455;c=1606980200717;bpid=BP-1458564024-172.17.0.11-1606980200717
2020-12-03 07:23:24,920 [Thread-59] INFO  datanode.DataNode (BPOfferService.java:verifyAndSetNamespaceInfo(378)) - Acknowledging ACTIVE Namenode during handshakeBlock pool <registering> (Datanode Uuid unassigned) service to localhost/127.0.0.1:37786
2020-12-03 07:23:24,922 [Thread-59] INFO  common.Storage (DataStorage.java:getParallelVolumeLoadThreadsNum(354)) - Using 2 threads to upgrade data directories (dfs.datanode.parallel.volumes.load.threads.num=2, dataDirs=2)
2020-12-03 07:23:24,956 [Thread-59] INFO  common.Storage (Storage.java:tryLock(923)) - Lock on /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/in_use.lock acquired by nodename 11675@18628722660d
2020-12-03 07:23:24,957 [Thread-59] INFO  common.Storage (DataStorage.java:loadStorageDirectory(282)) - Storage directory with location [DISK]file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1 is not formatted for namespace 1892489455. Formatting...
2020-12-03 07:23:24,958 [Thread-59] INFO  common.Storage (DataStorage.java:createStorageID(160)) - Generated new storageID DS-634fcf0b-cfbf-4df0-b7a1-9f98805233fb for directory /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1 
2020-12-03 07:23:25,035 [Thread-59] INFO  common.Storage (Storage.java:tryLock(923)) - Lock on /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/in_use.lock acquired by nodename 11675@18628722660d
2020-12-03 07:23:25,036 [Thread-59] INFO  common.Storage (DataStorage.java:loadStorageDirectory(282)) - Storage directory with location [DISK]file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2 is not formatted for namespace 1892489455. Formatting...
2020-12-03 07:23:25,036 [Thread-59] INFO  common.Storage (DataStorage.java:createStorageID(160)) - Generated new storageID DS-bfd35249-c440-48e2-9558-cf86da199a4b for directory /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2 
2020-12-03 07:23:25,120 [Thread-59] INFO  common.Storage (BlockPoolSliceStorage.java:recoverTransitionRead(251)) - Analyzing storage directories for bpid BP-1458564024-172.17.0.11-1606980200717
2020-12-03 07:23:25,121 [Thread-59] INFO  common.Storage (Storage.java:lock(882)) - Locking is disabled for /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-1458564024-172.17.0.11-1606980200717
2020-12-03 07:23:25,122 [Thread-59] INFO  common.Storage (BlockPoolSliceStorage.java:loadStorageDirectory(168)) - Block pool storage directory for location [DISK]file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1 and block pool id BP-1458564024-172.17.0.11-1606980200717 is not formatted. Formatting ...
2020-12-03 07:23:25,122 [Thread-59] INFO  common.Storage (BlockPoolSliceStorage.java:format(280)) - Formatting block pool BP-1458564024-172.17.0.11-1606980200717 directory /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-1458564024-172.17.0.11-1606980200717/current
2020-12-03 07:23:25,181 [Thread-59] INFO  common.Storage (BlockPoolSliceStorage.java:recoverTransitionRead(251)) - Analyzing storage directories for bpid BP-1458564024-172.17.0.11-1606980200717
2020-12-03 07:23:25,182 [Thread-59] INFO  common.Storage (Storage.java:lock(882)) - Locking is disabled for /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1458564024-172.17.0.11-1606980200717
2020-12-03 07:23:25,182 [Thread-59] INFO  common.Storage (BlockPoolSliceStorage.java:loadStorageDirectory(168)) - Block pool storage directory for location [DISK]file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2 and block pool id BP-1458564024-172.17.0.11-1606980200717 is not formatted. Formatting ...
2020-12-03 07:23:25,182 [Thread-59] INFO  common.Storage (BlockPoolSliceStorage.java:format(280)) - Formatting block pool BP-1458564024-172.17.0.11-1606980200717 directory /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1458564024-172.17.0.11-1606980200717/current
2020-12-03 07:23:25,188 [IPC Server handler 2 on default port 37786] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8074)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=datanodeReport	src=null	dst=null	perm=null	proto=rpc
2020-12-03 07:23:25,196 [Listener at localhost/33659] INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:shouldWait(2782)) - dnInfo.length != numDataNodes
2020-12-03 07:23:25,196 [Listener at localhost/33659] INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:waitActive(2703)) - Waiting for cluster to become active
2020-12-03 07:23:25,241 [Thread-59] INFO  datanode.DataNode (DataNode.java:initStorage(1746)) - Setting up storage: nsid=1892489455;bpid=BP-1458564024-172.17.0.11-1606980200717;lv=-57;nsInfo=lv=-65;cid=testClusterID;nsid=1892489455;c=1606980200717;bpid=BP-1458564024-172.17.0.11-1606980200717;dnuuid=null
2020-12-03 07:23:25,302 [IPC Server handler 3 on default port 37786] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8074)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=datanodeReport	src=null	dst=null	perm=null	proto=rpc
2020-12-03 07:23:25,304 [Listener at localhost/33659] INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:shouldWait(2782)) - dnInfo.length != numDataNodes
2020-12-03 07:23:25,305 [Listener at localhost/33659] INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:waitActive(2703)) - Waiting for cluster to become active
2020-12-03 07:23:25,311 [Thread-59] INFO  datanode.DataNode (DataNode.java:checkDatanodeUuid(1546)) - Generated and persisted new Datanode UUID 7455378e-99a9-49fc-9e03-4efd4d351125
2020-12-03 07:23:25,407 [IPC Server handler 4 on default port 37786] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8074)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=datanodeReport	src=null	dst=null	perm=null	proto=rpc
2020-12-03 07:23:25,409 [Listener at localhost/33659] INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:shouldWait(2782)) - dnInfo.length != numDataNodes
2020-12-03 07:23:25,409 [Listener at localhost/33659] INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:waitActive(2703)) - Waiting for cluster to become active
2020-12-03 07:23:25,451 [Thread-59] INFO  impl.FsDatasetImpl (FsVolumeList.java:addVolume(304)) - Added new volume: DS-634fcf0b-cfbf-4df0-b7a1-9f98805233fb
2020-12-03 07:23:25,452 [Thread-59] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:addVolume(450)) - Added volume - [DISK]file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1, StorageType: DISK
2020-12-03 07:23:25,455 [Thread-59] INFO  impl.FsDatasetImpl (FsVolumeList.java:addVolume(304)) - Added new volume: DS-bfd35249-c440-48e2-9558-cf86da199a4b
2020-12-03 07:23:25,456 [Thread-59] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:addVolume(450)) - Added volume - [DISK]file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2, StorageType: DISK
2020-12-03 07:23:25,460 [Thread-59] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:registerMBean(2280)) - Registered FSDatasetState MBean
2020-12-03 07:23:25,467 [Thread-59] INFO  checker.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(137)) - Scheduling a check for /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1
2020-12-03 07:23:25,476 [Thread-59] INFO  checker.DatasetVolumeChecker (DatasetVolumeChecker.java:checkAllVolumes(222)) - Scheduled health check for volume /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1
2020-12-03 07:23:25,478 [Thread-59] INFO  checker.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(137)) - Scheduling a check for /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2
2020-12-03 07:23:25,478 [Thread-59] INFO  checker.DatasetVolumeChecker (DatasetVolumeChecker.java:checkAllVolumes(222)) - Scheduled health check for volume /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2
2020-12-03 07:23:25,478 [Thread-59] DEBUG datanode.DataNode (DataNode.java:checkDiskError(3390)) - checkDiskError encountered no failures
2020-12-03 07:23:25,478 [Thread-59] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:addBlockPool(2791)) - Adding block pool BP-1458564024-172.17.0.11-1606980200717
2020-12-03 07:23:25,479 [Thread-117] INFO  impl.FsDatasetImpl (FsVolumeList.java:run(406)) - Scanning block pool BP-1458564024-172.17.0.11-1606980200717 on volume /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1...
2020-12-03 07:23:25,480 [Thread-118] INFO  impl.FsDatasetImpl (FsVolumeList.java:run(406)) - Scanning block pool BP-1458564024-172.17.0.11-1606980200717 on volume /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2...
2020-12-03 07:23:25,505 [Thread-117] INFO  impl.FsDatasetImpl (FsVolumeList.java:run(411)) - Time taken to scan block pool BP-1458564024-172.17.0.11-1606980200717 on /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1: 25ms
2020-12-03 07:23:25,507 [Thread-118] INFO  impl.FsDatasetImpl (FsVolumeList.java:run(411)) - Time taken to scan block pool BP-1458564024-172.17.0.11-1606980200717 on /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2: 26ms
2020-12-03 07:23:25,507 [Thread-59] INFO  impl.FsDatasetImpl (FsVolumeList.java:addBlockPool(431)) - Total time to scan all replicas for block pool BP-1458564024-172.17.0.11-1606980200717: 29ms
2020-12-03 07:23:25,509 [Thread-121] INFO  impl.FsDatasetImpl (FsVolumeList.java:run(199)) - Adding replicas to map for block pool BP-1458564024-172.17.0.11-1606980200717 on volume /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1...
2020-12-03 07:23:25,509 [Thread-122] INFO  impl.FsDatasetImpl (FsVolumeList.java:run(199)) - Adding replicas to map for block pool BP-1458564024-172.17.0.11-1606980200717 on volume /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2...
2020-12-03 07:23:25,510 [Thread-121] INFO  impl.BlockPoolSlice (BlockPoolSlice.java:readReplicasFromCache(876)) - Replica Cache file: /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-1458564024-172.17.0.11-1606980200717/current/replicas doesn't exist 
2020-12-03 07:23:25,511 [Thread-121] INFO  impl.FsDatasetImpl (FsVolumeList.java:run(204)) - Time to add replicas to map for block pool BP-1458564024-172.17.0.11-1606980200717 on volume /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1: 2ms
2020-12-03 07:23:25,510 [Thread-122] INFO  impl.BlockPoolSlice (BlockPoolSlice.java:readReplicasFromCache(876)) - Replica Cache file: /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1458564024-172.17.0.11-1606980200717/current/replicas doesn't exist 
2020-12-03 07:23:25,515 [IPC Server handler 0 on default port 37786] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8074)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=datanodeReport	src=null	dst=null	perm=null	proto=rpc
2020-12-03 07:23:25,518 [Thread-122] INFO  impl.FsDatasetImpl (FsVolumeList.java:run(204)) - Time to add replicas to map for block pool BP-1458564024-172.17.0.11-1606980200717 on volume /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2: 9ms
2020-12-03 07:23:25,518 [Thread-59] INFO  impl.FsDatasetImpl (FsVolumeList.java:getAllVolumesMap(225)) - Total time to add all replicas to map for block pool BP-1458564024-172.17.0.11-1606980200717: 10ms
2020-12-03 07:23:25,519 [Listener at localhost/33659] INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:shouldWait(2782)) - dnInfo.length != numDataNodes
2020-12-03 07:23:25,519 [Listener at localhost/33659] INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:waitActive(2703)) - Waiting for cluster to become active
2020-12-03 07:23:25,520 [VolumeScannerThread(/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1)] INFO  datanode.VolumeScanner (VolumeScanner.java:findNextUsableBlockIter(381)) - Now scanning bpid BP-1458564024-172.17.0.11-1606980200717 on volume /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1
2020-12-03 07:23:25,521 [VolumeScannerThread(/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2)] INFO  datanode.VolumeScanner (VolumeScanner.java:findNextUsableBlockIter(381)) - Now scanning bpid BP-1458564024-172.17.0.11-1606980200717 on volume /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2
2020-12-03 07:23:25,522 [VolumeScannerThread(/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1)] INFO  datanode.VolumeScanner (VolumeScanner.java:runLoop(539)) - VolumeScanner(/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1, DS-634fcf0b-cfbf-4df0-b7a1-9f98805233fb): finished scanning block pool BP-1458564024-172.17.0.11-1606980200717
2020-12-03 07:23:25,522 [VolumeScannerThread(/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2)] INFO  datanode.VolumeScanner (VolumeScanner.java:runLoop(539)) - VolumeScanner(/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2, DS-bfd35249-c440-48e2-9558-cf86da199a4b): finished scanning block pool BP-1458564024-172.17.0.11-1606980200717
2020-12-03 07:23:25,542 [VolumeScannerThread(/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2)] INFO  datanode.VolumeScanner (VolumeScanner.java:findNextUsableBlockIter(398)) - VolumeScanner(/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2, DS-bfd35249-c440-48e2-9558-cf86da199a4b): no suitable block pools found to scan.  Waiting 1814399978 ms.
2020-12-03 07:23:25,542 [VolumeScannerThread(/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1)] INFO  datanode.VolumeScanner (VolumeScanner.java:findNextUsableBlockIter(398)) - VolumeScanner(/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1, DS-634fcf0b-cfbf-4df0-b7a1-9f98805233fb): no suitable block pools found to scan.  Waiting 1814399978 ms.
2020-12-03 07:23:25,545 [Thread-59] INFO  datanode.DirectoryScanner (DirectoryScanner.java:start(284)) - Periodic Directory Tree Verification scan starting at 12/3/20 8:14 AM with interval of 21600000ms
2020-12-03 07:23:25,552 [BP-1458564024-172.17.0.11-1606980200717 heartbeating to localhost/127.0.0.1:37786] INFO  datanode.DataNode (BPServiceActor.java:register(767)) - Block pool BP-1458564024-172.17.0.11-1606980200717 (Datanode Uuid 7455378e-99a9-49fc-9e03-4efd4d351125) service to localhost/127.0.0.1:37786 beginning handshake with NN
2020-12-03 07:23:25,565 [IPC Server handler 2 on default port 37786] INFO  hdfs.StateChange (DatanodeManager.java:registerDatanode(1042)) - BLOCK* registerDatanode: from DatanodeRegistration(127.0.0.1:45491, datanodeUuid=7455378e-99a9-49fc-9e03-4efd4d351125, infoPort=33275, infoSecurePort=0, ipcPort=33659, storageInfo=lv=-57;cid=testClusterID;nsid=1892489455;c=1606980200717) storage 7455378e-99a9-49fc-9e03-4efd4d351125
2020-12-03 07:23:25,568 [IPC Server handler 2 on default port 37786] INFO  net.NetworkTopology (NetworkTopology.java:add(145)) - Adding a new node: /default-rack/127.0.0.1:45491
2020-12-03 07:23:25,568 [IPC Server handler 2 on default port 37786] INFO  blockmanagement.BlockReportLeaseManager (BlockReportLeaseManager.java:registerNode(204)) - Registered DN 7455378e-99a9-49fc-9e03-4efd4d351125 (127.0.0.1:45491).
2020-12-03 07:23:25,581 [BP-1458564024-172.17.0.11-1606980200717 heartbeating to localhost/127.0.0.1:37786] INFO  datanode.DataNode (BPServiceActor.java:register(786)) - Block pool Block pool BP-1458564024-172.17.0.11-1606980200717 (Datanode Uuid 7455378e-99a9-49fc-9e03-4efd4d351125) service to localhost/127.0.0.1:37786 successfully registered with NN
2020-12-03 07:23:25,581 [BP-1458564024-172.17.0.11-1606980200717 heartbeating to localhost/127.0.0.1:37786] INFO  datanode.DataNode (BPServiceActor.java:offerService(616)) - For namenode localhost/127.0.0.1:37786 using BLOCKREPORT_INTERVAL of 21600000msec CACHEREPORT_INTERVAL of 10000msec Initial delay: 0msec; heartBeatInterval=3000
2020-12-03 07:23:25,583 [BP-1458564024-172.17.0.11-1606980200717 heartbeating to localhost/127.0.0.1:37786] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(497)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1458564024-172.17.0.11-1606980200717 (Datanode Uuid 7455378e-99a9-49fc-9e03-4efd4d351125) service to localhost/127.0.0.1:37786
2020-12-03 07:23:25,599 [IPC Server handler 3 on default port 37786] INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateStorage(987)) - Adding new storage ID DS-634fcf0b-cfbf-4df0-b7a1-9f98805233fb for DN 127.0.0.1:45491
2020-12-03 07:23:25,600 [IPC Server handler 3 on default port 37786] INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateStorage(987)) - Adding new storage ID DS-bfd35249-c440-48e2-9558-cf86da199a4b for DN 127.0.0.1:45491
2020-12-03 07:23:25,622 [IPC Server handler 4 on default port 37786] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8074)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=datanodeReport	src=null	dst=null	perm=null	proto=rpc
2020-12-03 07:23:25,632 [Listener at localhost/33659] INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:waitActive(2758)) - Cluster is active
2020-12-03 07:23:25,639 [IPC Server handler 5 on default port 37786] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReport(1566)) - *BLOCK* NameNode.blockReport: from DatanodeRegistration(127.0.0.1:45491, datanodeUuid=7455378e-99a9-49fc-9e03-4efd4d351125, infoPort=33275, infoSecurePort=0, ipcPort=33659, storageInfo=lv=-57;cid=testClusterID;nsid=1892489455;c=1606980200717), reports.length=2
2020-12-03 07:23:25,640 [Listener at localhost/33659] DEBUG hdfs.DFSClient (DFSClient.java:<init>(318)) - Sets dfs.client.block.write.replace-datanode-on-failure.min-replication to 0
2020-12-03 07:23:25,644 [Block report processor] INFO  BlockStateChange (BlockManager.java:processReport(2648)) - BLOCK* processReport 0x56cd14ac60933840: Processing first storage report for DS-bfd35249-c440-48e2-9558-cf86da199a4b from datanode 7455378e-99a9-49fc-9e03-4efd4d351125
2020-12-03 07:23:25,646 [Block report processor] INFO  BlockStateChange (BlockManager.java:processReport(2677)) - BLOCK* processReport 0x56cd14ac60933840: from storage DS-bfd35249-c440-48e2-9558-cf86da199a4b node DatanodeRegistration(127.0.0.1:45491, datanodeUuid=7455378e-99a9-49fc-9e03-4efd4d351125, infoPort=33275, infoSecurePort=0, ipcPort=33659, storageInfo=lv=-57;cid=testClusterID;nsid=1892489455;c=1606980200717), blocks: 0, hasStaleStorage: true, processing time: 2 msecs, invalidatedBlocks: 0
2020-12-03 07:23:25,647 [Block report processor] INFO  BlockStateChange (BlockManager.java:processReport(2648)) - BLOCK* processReport 0x56cd14ac60933840: Processing first storage report for DS-634fcf0b-cfbf-4df0-b7a1-9f98805233fb from datanode 7455378e-99a9-49fc-9e03-4efd4d351125
2020-12-03 07:23:25,647 [Block report processor] INFO  BlockStateChange (BlockManager.java:processReport(2677)) - BLOCK* processReport 0x56cd14ac60933840: from storage DS-634fcf0b-cfbf-4df0-b7a1-9f98805233fb node DatanodeRegistration(127.0.0.1:45491, datanodeUuid=7455378e-99a9-49fc-9e03-4efd4d351125, infoPort=33275, infoSecurePort=0, ipcPort=33659, storageInfo=lv=-57;cid=testClusterID;nsid=1892489455;c=1606980200717), blocks: 0, hasStaleStorage: false, processing time: 0 msecs, invalidatedBlocks: 0
2020-12-03 07:23:25,648 [Listener at localhost/33659] DEBUG hdfs.DFSClient (DFSClient.java:create(1216)) - /simpleAppend.dat: masked={ masked: rw-r--r--, unmasked: rw-rw-rw- }
2020-12-03 07:23:25,649 [IPC Server handler 5 on default port 37786] DEBUG blockmanagement.BlockManager (BlockManager.java:removeBRLeaseIfNeeded(2700)) - Processing RPC with index 0 out of total 1 RPCs in processReport 0x56cd14ac60933840
2020-12-03 07:23:25,661 [IPC Server handler 7 on default port 37786] DEBUG hdfs.StateChange (NameNodeRpcServer.java:create(774)) - *DIR* NameNode.create: file /simpleAppend.dat for DFSClient_NONMAPREDUCE_-126688406_1 at 127.0.0.1
2020-12-03 07:23:25,662 [IPC Server handler 7 on default port 37786] DEBUG hdfs.StateChange (FSNamesystem.java:startFileInt(2460)) - DIR* NameSystem.startFile: src=/simpleAppend.dat, holder=DFSClient_NONMAPREDUCE_-126688406_1, clientMachine=127.0.0.1, createParent=true, replication=1, createFlag=[CREATE, OVERWRITE], blockSize=1024, supportedVersions=[CryptoProtocolVersion{description='Encryption zones', version=2, unknownValue=null}]
2020-12-03 07:23:25,682 [BP-1458564024-172.17.0.11-1606980200717 heartbeating to localhost/127.0.0.1:37786] INFO  datanode.DataNode (BPServiceActor.java:blockReport(424)) - Successfully sent block report 0x56cd14ac60933840,  containing 2 storage report(s), of which we sent 2. The reports had 0 total blocks and used 1 RPC(s). This took 4 msec to generate and 61 msecs for RPC and NN processing. Got back one command: FinalizeCommand/5.
2020-12-03 07:23:25,682 [BP-1458564024-172.17.0.11-1606980200717 heartbeating to localhost/127.0.0.1:37786] INFO  datanode.DataNode (BPOfferService.java:processCommandFromActive(759)) - Got finalize command for block pool BP-1458564024-172.17.0.11-1606980200717
2020-12-03 07:23:25,685 [IPC Server handler 7 on default port 37786] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addFile(579)) - DIR* addFile: simpleAppend.dat is added
2020-12-03 07:23:25,687 [IPC Server handler 7 on default port 37786] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:startFile(415)) - DIR* NameSystem.startFile: added /simpleAppend.dat inode 16386 DFSClient_NONMAPREDUCE_-126688406_1
2020-12-03 07:23:25,707 [IPC Server handler 7 on default port 37786] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8074)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=create	src=/simpleAppend.dat	dst=null	perm=root:supergroup:rw-r--r--	proto=rpc
2020-12-03 07:23:25,733 [Listener at localhost/33659] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/simpleAppend.dat, chunkSize=516, chunksPerPacket=126, packetSize=65016
Created file simpleAppend.dat
Writing 186 bytes to file /simpleAppend.dat
2020-12-03 07:23:25,748 [Listener at localhost/33659] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=0, src=/simpleAppend.dat, packetSize=65016, chunksPerPacket=126, bytesCurBlock=0, DFSOutputStream:block==null
2020-12-03 07:23:25,757 [IPC Server handler 8 on default port 37786] DEBUG hdfs.StateChange (FSNamesystem.java:getAdditionalBlock(2767)) - BLOCK* getAdditionalBlock: /simpleAppend.dat  inodeId 16386 for DFSClient_NONMAPREDUCE_-126688406_1
2020-12-03 07:23:25,765 [IPC Server handler 8 on default port 37786] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addBlock(524)) - DIR* FSDirectory.addBlock: /simpleAppend.dat with blk_1073741825_1001 block is added to the in-memory file system
2020-12-03 07:23:25,765 [IPC Server handler 8 on default port 37786] INFO  hdfs.StateChange (FSDirWriteFileOp.java:logAllocatedBlock(798)) - BLOCK* allocate blk_1073741825_1001, replicas=127.0.0.1:45491 for /simpleAppend.dat
2020-12-03 07:23:25,765 [IPC Server handler 8 on default port 37786] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistNewBlock(758)) - persistNewBlock: /simpleAppend.dat with new block blk_1073741825_1001, current total block count is 1
2020-12-03 07:23:25,793 [Thread-126] INFO  sasl.SaslDataTransferClient (SaslDataTransferClient.java:checkTrustAndSend(239)) - SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
2020-12-03 07:23:25,807 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@3f28bd56] DEBUG datanode.DataNode (DataXceiver.java:<init>(154)) - Number of active connections is: 1
2020-12-03 07:23:25,875 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54618 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741825_1001]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(728)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-126688406_1
  block  =BP-1458564024-172.17.0.11-1606980200717:blk_1073741825_1001, newGs=0, bytesRcvd=[0, 0]
  targets=[]; pipelineSize=1, srcDataNode=:0, pinning=false
2020-12-03 07:23:25,876 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54618 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741825_1001]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(734)) - isDatanode=false, isClient=true, isTransfer=false
2020-12-03 07:23:25,876 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54618 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741825_1001]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(736)) - writeBlock receive buf size 531128 tcp no delay true
2020-12-03 07:23:25,876 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54618 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741825_1001]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(747)) - Receiving BP-1458564024-172.17.0.11-1606980200717:blk_1073741825_1001 src: /127.0.0.1:54618 dest: /127.0.0.1:45491
2020-12-03 07:23:25,887 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54618 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741825_1001]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1458564024-172.17.0.11-1606980200717:blk_1073741825_1001
 storageType=DISK, inAddr=/127.0.0.1:54618, myAddr=/127.0.0.1:45491
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-126688406_1, srcDataNode=:0, datanode=127.0.0.1:45491
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-bfd35249-c440-48e2-9558-cf86da199a4b
2020-12-03 07:23:25,902 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54618 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741825_1001]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-1458564024-172.17.0.11-1606980200717/current/rbw/blk_1073741825 of size 0
2020-12-03 07:23:25,902 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54618 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741825_1001]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-1458564024-172.17.0.11-1606980200717/current/rbw/blk_1073741825_1001.meta of size 0
2020-12-03 07:23:25,915 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741825_1001, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741825_1001, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-12-03 07:23:25,930 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54618 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741825_1001]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1458564024-172.17.0.11-1606980200717:blk_1073741825_1001: PacketHeader with packetLen=194 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 186

2020-12-03 07:23:25,932 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54618 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741825_1001]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741825_1001, type=LAST_IN_PIPELINE: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=186, ackEnqueueNanoTime=141197706814152, ackStatus=SUCCESS)
2020-12-03 07:23:25,938 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54618 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741825_1001]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1458564024-172.17.0.11-1606980200717:blk_1073741825_1001: PacketHeader with packetLen=4 header data: offsetInBlock: 186
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-12-03 07:23:25,938 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54618 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741825_1001]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1458564024-172.17.0.11-1606980200717:blk_1073741825_1001
2020-12-03 07:23:25,939 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54618 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741825_1001]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741825_1001, type=LAST_IN_PIPELINE: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=186, ackEnqueueNanoTime=141197713963599, ackStatus=SUCCESS)
2020-12-03 07:23:25,939 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741825_1001, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741825_1001, type=LAST_IN_PIPELINE, replyAck=seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:25,945 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741825_1001, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:54618, dest: /127.0.0.1:45491, bytes: 186, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-126688406_1, offset: 0, srvID: 7455378e-99a9-49fc-9e03-4efd4d351125, blockid: BP-1458564024-172.17.0.11-1606980200717:blk_1073741825_1001, duration(ns): 25121514
2020-12-03 07:23:25,945 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741825_1001, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741825_1001, type=LAST_IN_PIPELINE, replyAck=seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:25,945 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741825_1001, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741825_1001, type=LAST_IN_PIPELINE terminating
2020-12-03 07:23:25,945 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54618 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741825_1001]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741825_1001, type=LAST_IN_PIPELINE: closing
2020-12-03 07:23:25,947 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54618 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741825_1001]] DEBUG datanode.DataNode (DataXceiver.java:run(328)) - 127.0.0.1:45491:Number of active connections is: 2
2020-12-03 07:23:25,954 [IPC Server handler 6 on default port 37786] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(674)) - DIR* NameSystem.completeFile: /simpleAppend.dat for DFSClient_NONMAPREDUCE_-126688406_1
2020-12-03 07:23:25,957 [IPC Server handler 6 on default port 37786] INFO  namenode.FSNamesystem (FSNamesystem.java:checkBlocksComplete(2995)) - BLOCK* blk_1073741825_1001 is COMMITTED but not COMPLETE(numNodes= 0 <  minimum = 1) in file /simpleAppend.dat
2020-12-03 07:23:25,960 [IPC Server handler 1 on default port 37786] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1627)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45491, datanodeUuid=7455378e-99a9-49fc-9e03-4efd4d351125, infoPort=33275, infoSecurePort=0, ipcPort=33659, storageInfo=lv=-57;cid=testClusterID;nsid=1892489455;c=1606980200717) 1 blocks.
2020-12-03 07:23:25,961 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(4021)) - Reported block blk_1073741825_1001 on 127.0.0.1:45491 size 186 replicaState = FINALIZED
2020-12-03 07:23:25,961 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(4044)) - In memory blockUCState = COMMITTED
2020-12-03 07:23:25,962 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3351)) - BLOCK* addStoredBlock: 127.0.0.1:45491 is added to blk_1073741825_1001 (size=186)
2020-12-03 07:23:25,963 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4154)) - BLOCK* block RECEIVED_BLOCK: blk_1073741825_1001 is received from 127.0.0.1:45491
2020-12-03 07:23:25,963 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4157)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45491 receiving: 0, received: 1, deleted: 0
2020-12-03 07:23:26,361 [IPC Server handler 0 on default port 37786] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(674)) - DIR* NameSystem.completeFile: /simpleAppend.dat for DFSClient_NONMAPREDUCE_-126688406_1
2020-12-03 07:23:26,363 [IPC Server handler 0 on default port 37786] DEBUG hdfs.StateChange (FSNamesystem.java:closeFile(4036)) - closeFile: /simpleAppend.dat with 1 blocks is persisted to the file system
2020-12-03 07:23:26,365 [IPC Server handler 0 on default port 37786] INFO  hdfs.StateChange (FSNamesystem.java:completeFile(2948)) - DIR* completeFile: /simpleAppend.dat is closed by DFSClient_NONMAPREDUCE_-126688406_1
Wrote and Closed first part of file.
Writing 186 bytes to file /simpleAppend.dat
2020-12-03 07:23:26,371 [IPC Server handler 2 on default port 37786] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(809)) - *DIR* NameNode.append: file /simpleAppend.dat for DFSClient_NONMAPREDUCE_-126688406_1 at 127.0.0.1
2020-12-03 07:23:26,372 [IPC Server handler 2 on default port 37786] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2710)) - DIR* NameSystem.appendFile: src=/simpleAppend.dat, holder=DFSClient_NONMAPREDUCE_-126688406_1, clientMachine=127.0.0.1
2020-12-03 07:23:26,376 [IPC Server handler 2 on default port 37786] DEBUG hdfs.StateChange (FSDirAppendOp.java:appendFile(154)) - DIR* NameSystem.appendFile: file /simpleAppend.dat for DFSClient_NONMAPREDUCE_-126688406_1 at 127.0.0.1 block BP-1458564024-172.17.0.11-1606980200717:blk_1073741825_1001 block size 186
2020-12-03 07:23:26,377 [IPC Server handler 2 on default port 37786] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8074)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=append	src=/simpleAppend.dat	dst=null	perm=null	proto=rpc
2020-12-03 07:23:26,382 [Listener at localhost/33659] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/simpleAppend.dat, chunkSize=516, chunksPerPacket=126, packetSize=65016
2020-12-03 07:23:26,382 [Listener at localhost/33659] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=0, src=/simpleAppend.dat, packetSize=65016, chunksPerPacket=126, bytesCurBlock=0, DFSOutputStream:blk_1073741825_1001
2020-12-03 07:23:26,385 [IPC Server handler 3 on default port 37786] DEBUG hdfs.StateChange (FSNamesystem.java:getAdditionalBlock(2767)) - BLOCK* getAdditionalBlock: /simpleAppend.dat  inodeId 16386 for DFSClient_NONMAPREDUCE_-126688406_1
2020-12-03 07:23:26,386 [IPC Server handler 3 on default port 37786] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addBlock(524)) - DIR* FSDirectory.addBlock: /simpleAppend.dat with blk_1073741826_1002 block is added to the in-memory file system
2020-12-03 07:23:26,387 [IPC Server handler 3 on default port 37786] INFO  hdfs.StateChange (FSDirWriteFileOp.java:logAllocatedBlock(798)) - BLOCK* allocate blk_1073741826_1002, replicas=127.0.0.1:45491 for /simpleAppend.dat
2020-12-03 07:23:26,387 [IPC Server handler 3 on default port 37786] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistNewBlock(758)) - persistNewBlock: /simpleAppend.dat with new block blk_1073741826_1002, current total block count is 2
2020-12-03 07:23:26,389 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@3f28bd56] DEBUG datanode.DataNode (DataXceiver.java:<init>(154)) - Number of active connections is: 1
2020-12-03 07:23:26,389 [Thread-131] INFO  sasl.SaslDataTransferClient (SaslDataTransferClient.java:checkTrustAndSend(239)) - SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
2020-12-03 07:23:26,395 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54818 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741826_1002]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(728)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-126688406_1
  block  =BP-1458564024-172.17.0.11-1606980200717:blk_1073741826_1002, newGs=0, bytesRcvd=[0, 0]
  targets=[]; pipelineSize=1, srcDataNode=:0, pinning=false
2020-12-03 07:23:26,396 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54818 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741826_1002]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(734)) - isDatanode=false, isClient=true, isTransfer=false
2020-12-03 07:23:26,396 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54818 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741826_1002]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(736)) - writeBlock receive buf size 531128 tcp no delay true
2020-12-03 07:23:26,396 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54818 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741826_1002]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(747)) - Receiving BP-1458564024-172.17.0.11-1606980200717:blk_1073741826_1002 src: /127.0.0.1:54818 dest: /127.0.0.1:45491
2020-12-03 07:23:26,396 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54818 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741826_1002]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1458564024-172.17.0.11-1606980200717:blk_1073741826_1002
 storageType=DISK, inAddr=/127.0.0.1:54818, myAddr=/127.0.0.1:45491
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-126688406_1, srcDataNode=:0, datanode=127.0.0.1:45491
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-bfd35249-c440-48e2-9558-cf86da199a4b
2020-12-03 07:23:26,397 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54818 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741826_1002]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1458564024-172.17.0.11-1606980200717/current/rbw/blk_1073741826 of size 0
2020-12-03 07:23:26,397 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54818 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741826_1002]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1458564024-172.17.0.11-1606980200717/current/rbw/blk_1073741826_1002.meta of size 0
2020-12-03 07:23:26,418 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741826_1002, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741826_1002, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-12-03 07:23:26,428 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54818 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741826_1002]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1458564024-172.17.0.11-1606980200717:blk_1073741826_1002: PacketHeader with packetLen=429 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 421

2020-12-03 07:23:26,428 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54818 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741826_1002]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741826_1002, type=LAST_IN_PIPELINE: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=421, ackEnqueueNanoTime=141198203447781, ackStatus=SUCCESS)
2020-12-03 07:23:26,432 [RedundancyMonitor] DEBUG BlockStateChange (BlockManager.java:computeReconstructionWorkForBlocks(1998)) - BLOCK* neededReconstruction = 0 pendingReconstruction = 0
2020-12-03 07:23:26,437 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741826_1002, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741826_1002, type=LAST_IN_PIPELINE, replyAck=seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:26,437 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741826_1002, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741826_1002, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-12-03 07:23:26,449 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54818 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741826_1002]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1458564024-172.17.0.11-1606980200717:blk_1073741826_1002: PacketHeader with packetLen=4 header data: offsetInBlock: 421
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-12-03 07:23:26,449 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54818 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741826_1002]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1458564024-172.17.0.11-1606980200717:blk_1073741826_1002
2020-12-03 07:23:26,449 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54818 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741826_1002]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741826_1002, type=LAST_IN_PIPELINE: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=421, ackEnqueueNanoTime=141198224849909, ackStatus=SUCCESS)
2020-12-03 07:23:26,472 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741826_1002, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:54818, dest: /127.0.0.1:45491, bytes: 421, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-126688406_1, offset: 0, srvID: 7455378e-99a9-49fc-9e03-4efd4d351125, blockid: BP-1458564024-172.17.0.11-1606980200717:blk_1073741826_1002, duration(ns): 49126731
2020-12-03 07:23:26,473 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741826_1002, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741826_1002, type=LAST_IN_PIPELINE, replyAck=seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:26,473 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741826_1002, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741826_1002, type=LAST_IN_PIPELINE terminating
2020-12-03 07:23:26,473 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54818 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741826_1002]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741826_1002, type=LAST_IN_PIPELINE: closing
2020-12-03 07:23:26,475 [IPC Server handler 5 on default port 37786] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(674)) - DIR* NameSystem.completeFile: /simpleAppend.dat for DFSClient_NONMAPREDUCE_-126688406_1
2020-12-03 07:23:26,475 [IPC Server handler 4 on default port 37786] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1627)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45491, datanodeUuid=7455378e-99a9-49fc-9e03-4efd4d351125, infoPort=33275, infoSecurePort=0, ipcPort=33659, storageInfo=lv=-57;cid=testClusterID;nsid=1892489455;c=1606980200717) 1 blocks.
2020-12-03 07:23:26,480 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54818 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741826_1002]] DEBUG datanode.DataNode (DataXceiver.java:run(328)) - 127.0.0.1:45491:Number of active connections is: 2
2020-12-03 07:23:26,481 [IPC Server handler 5 on default port 37786] INFO  namenode.FSNamesystem (FSNamesystem.java:checkBlocksComplete(2995)) - BLOCK* blk_1073741826_1002 is COMMITTED but not COMPLETE(numNodes= 0 <  minimum = 1) in file /simpleAppend.dat
2020-12-03 07:23:26,481 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(4021)) - Reported block blk_1073741826_1002 on 127.0.0.1:45491 size 421 replicaState = FINALIZED
2020-12-03 07:23:26,482 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(4044)) - In memory blockUCState = COMMITTED
2020-12-03 07:23:26,482 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3351)) - BLOCK* addStoredBlock: 127.0.0.1:45491 is added to blk_1073741826_1002 (size=421)
2020-12-03 07:23:26,482 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4154)) - BLOCK* block RECEIVED_BLOCK: blk_1073741826_1002 is received from 127.0.0.1:45491
2020-12-03 07:23:26,482 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4157)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45491 receiving: 0, received: 1, deleted: 0
2020-12-03 07:23:26,885 [IPC Server handler 6 on default port 37786] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(674)) - DIR* NameSystem.completeFile: /simpleAppend.dat for DFSClient_NONMAPREDUCE_-126688406_1
2020-12-03 07:23:26,886 [IPC Server handler 6 on default port 37786] DEBUG hdfs.StateChange (FSNamesystem.java:closeFile(4036)) - closeFile: /simpleAppend.dat with 2 blocks is persisted to the file system
2020-12-03 07:23:26,886 [IPC Server handler 6 on default port 37786] INFO  hdfs.StateChange (FSNamesystem.java:completeFile(2948)) - DIR* completeFile: /simpleAppend.dat is closed by DFSClient_NONMAPREDUCE_-126688406_1
Wrote and Closed second part of file.
2020-12-03 07:23:26,888 [IPC Server handler 1 on default port 37786] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(809)) - *DIR* NameNode.append: file /simpleAppend.dat for DFSClient_NONMAPREDUCE_-126688406_1 at 127.0.0.1
2020-12-03 07:23:26,888 [IPC Server handler 1 on default port 37786] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2710)) - DIR* NameSystem.appendFile: src=/simpleAppend.dat, holder=DFSClient_NONMAPREDUCE_-126688406_1, clientMachine=127.0.0.1
2020-12-03 07:23:26,889 [IPC Server handler 1 on default port 37786] DEBUG hdfs.StateChange (FSDirAppendOp.java:appendFile(154)) - DIR* NameSystem.appendFile: file /simpleAppend.dat for DFSClient_NONMAPREDUCE_-126688406_1 at 127.0.0.1 block BP-1458564024-172.17.0.11-1606980200717:blk_1073741826_1002 block size 421
2020-12-03 07:23:26,890 [IPC Server handler 1 on default port 37786] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8074)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=append	src=/simpleAppend.dat	dst=null	perm=null	proto=rpc
2020-12-03 07:23:26,891 [Listener at localhost/33659] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/simpleAppend.dat, chunkSize=516, chunksPerPacket=126, packetSize=65016
Writing 9634 bytes to file /simpleAppend.dat
2020-12-03 07:23:26,892 [Listener at localhost/33659] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=0, src=/simpleAppend.dat, packetSize=65016, chunksPerPacket=126, bytesCurBlock=0, DFSOutputStream:blk_1073741826_1002
2020-12-03 07:23:26,892 [Listener at localhost/33659] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/simpleAppend.dat, chunkSize=516, chunksPerPacket=1, packetSize=516
2020-12-03 07:23:26,893 [Listener at localhost/33659] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=2, src=/simpleAppend.dat, packetSize=516, chunksPerPacket=1, bytesCurBlock=0, DFSOutputStream:blk_1073741826_1002
2020-12-03 07:23:26,893 [Listener at localhost/33659] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/simpleAppend.dat, chunkSize=516, chunksPerPacket=1, packetSize=516
2020-12-03 07:23:26,893 [Listener at localhost/33659] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=3, src=/simpleAppend.dat, packetSize=516, chunksPerPacket=1, bytesCurBlock=512, DFSOutputStream:blk_1073741826_1002
2020-12-03 07:23:26,893 [Listener at localhost/33659] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/simpleAppend.dat, chunkSize=516, chunksPerPacket=1, packetSize=516
2020-12-03 07:23:26,893 [Listener at localhost/33659] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=5, src=/simpleAppend.dat, packetSize=516, chunksPerPacket=1, bytesCurBlock=0, DFSOutputStream:blk_1073741826_1002
2020-12-03 07:23:26,894 [Listener at localhost/33659] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/simpleAppend.dat, chunkSize=516, chunksPerPacket=1, packetSize=516
2020-12-03 07:23:26,894 [Listener at localhost/33659] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=6, src=/simpleAppend.dat, packetSize=516, chunksPerPacket=1, bytesCurBlock=512, DFSOutputStream:blk_1073741826_1002
2020-12-03 07:23:26,894 [Listener at localhost/33659] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/simpleAppend.dat, chunkSize=516, chunksPerPacket=1, packetSize=516
2020-12-03 07:23:26,894 [Listener at localhost/33659] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=8, src=/simpleAppend.dat, packetSize=516, chunksPerPacket=1, bytesCurBlock=0, DFSOutputStream:blk_1073741826_1002
2020-12-03 07:23:26,894 [Listener at localhost/33659] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/simpleAppend.dat, chunkSize=516, chunksPerPacket=1, packetSize=516
2020-12-03 07:23:26,895 [Listener at localhost/33659] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=9, src=/simpleAppend.dat, packetSize=516, chunksPerPacket=1, bytesCurBlock=512, DFSOutputStream:blk_1073741826_1002
2020-12-03 07:23:26,895 [Listener at localhost/33659] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/simpleAppend.dat, chunkSize=516, chunksPerPacket=1, packetSize=516
2020-12-03 07:23:26,895 [Listener at localhost/33659] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=11, src=/simpleAppend.dat, packetSize=516, chunksPerPacket=1, bytesCurBlock=0, DFSOutputStream:blk_1073741826_1002
2020-12-03 07:23:26,895 [Listener at localhost/33659] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/simpleAppend.dat, chunkSize=516, chunksPerPacket=1, packetSize=516
2020-12-03 07:23:26,895 [Listener at localhost/33659] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=12, src=/simpleAppend.dat, packetSize=516, chunksPerPacket=1, bytesCurBlock=512, DFSOutputStream:blk_1073741826_1002
2020-12-03 07:23:26,896 [Listener at localhost/33659] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/simpleAppend.dat, chunkSize=516, chunksPerPacket=1, packetSize=516
2020-12-03 07:23:26,896 [Listener at localhost/33659] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=14, src=/simpleAppend.dat, packetSize=516, chunksPerPacket=1, bytesCurBlock=0, DFSOutputStream:blk_1073741826_1002
2020-12-03 07:23:26,896 [Listener at localhost/33659] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/simpleAppend.dat, chunkSize=516, chunksPerPacket=1, packetSize=516
2020-12-03 07:23:26,896 [Listener at localhost/33659] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=15, src=/simpleAppend.dat, packetSize=516, chunksPerPacket=1, bytesCurBlock=512, DFSOutputStream:blk_1073741826_1002
2020-12-03 07:23:26,896 [Listener at localhost/33659] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/simpleAppend.dat, chunkSize=516, chunksPerPacket=1, packetSize=516
2020-12-03 07:23:26,897 [Listener at localhost/33659] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=17, src=/simpleAppend.dat, packetSize=516, chunksPerPacket=1, bytesCurBlock=0, DFSOutputStream:blk_1073741826_1002
2020-12-03 07:23:26,897 [Listener at localhost/33659] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/simpleAppend.dat, chunkSize=516, chunksPerPacket=1, packetSize=516
2020-12-03 07:23:26,897 [Listener at localhost/33659] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=18, src=/simpleAppend.dat, packetSize=516, chunksPerPacket=1, bytesCurBlock=512, DFSOutputStream:blk_1073741826_1002
2020-12-03 07:23:26,897 [Listener at localhost/33659] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/simpleAppend.dat, chunkSize=516, chunksPerPacket=1, packetSize=516
2020-12-03 07:23:26,898 [Listener at localhost/33659] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=20, src=/simpleAppend.dat, packetSize=516, chunksPerPacket=1, bytesCurBlock=0, DFSOutputStream:blk_1073741826_1002
2020-12-03 07:23:26,898 [Listener at localhost/33659] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/simpleAppend.dat, chunkSize=516, chunksPerPacket=1, packetSize=516
2020-12-03 07:23:26,898 [Listener at localhost/33659] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=21, src=/simpleAppend.dat, packetSize=516, chunksPerPacket=1, bytesCurBlock=512, DFSOutputStream:blk_1073741826_1002
2020-12-03 07:23:26,898 [Listener at localhost/33659] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/simpleAppend.dat, chunkSize=516, chunksPerPacket=1, packetSize=516
2020-12-03 07:23:26,898 [Listener at localhost/33659] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=23, src=/simpleAppend.dat, packetSize=516, chunksPerPacket=1, bytesCurBlock=0, DFSOutputStream:blk_1073741826_1002
2020-12-03 07:23:26,899 [Listener at localhost/33659] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/simpleAppend.dat, chunkSize=516, chunksPerPacket=1, packetSize=516
2020-12-03 07:23:26,899 [Listener at localhost/33659] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=24, src=/simpleAppend.dat, packetSize=516, chunksPerPacket=1, bytesCurBlock=512, DFSOutputStream:blk_1073741826_1002
2020-12-03 07:23:26,899 [Listener at localhost/33659] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/simpleAppend.dat, chunkSize=516, chunksPerPacket=1, packetSize=516
Written second part of file
2020-12-03 07:23:26,899 [Listener at localhost/33659] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=26, src=/simpleAppend.dat, packetSize=516, chunksPerPacket=1, bytesCurBlock=0, DFSOutputStream:blk_1073741826_1002
2020-12-03 07:23:26,899 [Listener at localhost/33659] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/simpleAppend.dat, chunkSize=516, chunksPerPacket=1, packetSize=516
2020-12-03 07:23:26,906 [IPC Server handler 0 on default port 37786] DEBUG hdfs.StateChange (FSNamesystem.java:getAdditionalBlock(2767)) - BLOCK* getAdditionalBlock: /simpleAppend.dat  inodeId 16386 for DFSClient_NONMAPREDUCE_-126688406_1
2020-12-03 07:23:26,907 [IPC Server handler 0 on default port 37786] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addBlock(524)) - DIR* FSDirectory.addBlock: /simpleAppend.dat with blk_1073741827_1003 block is added to the in-memory file system
2020-12-03 07:23:26,908 [IPC Server handler 0 on default port 37786] INFO  hdfs.StateChange (FSDirWriteFileOp.java:logAllocatedBlock(798)) - BLOCK* allocate blk_1073741827_1003, replicas=127.0.0.1:45491 for /simpleAppend.dat
2020-12-03 07:23:26,908 [IPC Server handler 0 on default port 37786] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistNewBlock(758)) - persistNewBlock: /simpleAppend.dat with new block blk_1073741827_1003, current total block count is 3
2020-12-03 07:23:26,911 [Thread-135] INFO  sasl.SaslDataTransferClient (SaslDataTransferClient.java:checkTrustAndSend(239)) - SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
2020-12-03 07:23:26,913 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@3f28bd56] DEBUG datanode.DataNode (DataXceiver.java:<init>(154)) - Number of active connections is: 1
2020-12-03 07:23:26,918 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54978 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741827_1003]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(728)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-126688406_1
  block  =BP-1458564024-172.17.0.11-1606980200717:blk_1073741827_1003, newGs=0, bytesRcvd=[0, 0]
  targets=[]; pipelineSize=1, srcDataNode=:0, pinning=false
2020-12-03 07:23:26,918 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54978 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741827_1003]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(734)) - isDatanode=false, isClient=true, isTransfer=false
2020-12-03 07:23:26,918 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54978 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741827_1003]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(736)) - writeBlock receive buf size 531128 tcp no delay true
2020-12-03 07:23:26,918 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54978 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741827_1003]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(747)) - Receiving BP-1458564024-172.17.0.11-1606980200717:blk_1073741827_1003 src: /127.0.0.1:54978 dest: /127.0.0.1:45491
2020-12-03 07:23:26,919 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54978 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741827_1003]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1458564024-172.17.0.11-1606980200717:blk_1073741827_1003
 storageType=DISK, inAddr=/127.0.0.1:54978, myAddr=/127.0.0.1:45491
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-126688406_1, srcDataNode=:0, datanode=127.0.0.1:45491
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-bfd35249-c440-48e2-9558-cf86da199a4b
2020-12-03 07:23:26,919 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54978 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741827_1003]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-1458564024-172.17.0.11-1606980200717/current/rbw/blk_1073741827 of size 0
2020-12-03 07:23:26,919 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54978 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741827_1003]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-1458564024-172.17.0.11-1606980200717/current/rbw/blk_1073741827_1003.meta of size 0
2020-12-03 07:23:26,921 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741827_1003, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741827_1003, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-12-03 07:23:26,923 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54978 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741827_1003]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1458564024-172.17.0.11-1606980200717:blk_1073741827_1003: PacketHeader with packetLen=1036 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 1024

2020-12-03 07:23:26,924 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54978 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741827_1003]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741827_1003, type=LAST_IN_PIPELINE: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=1024, ackEnqueueNanoTime=141198699009748, ackStatus=SUCCESS)
2020-12-03 07:23:26,925 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741827_1003, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741827_1003, type=LAST_IN_PIPELINE, replyAck=seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:26,925 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741827_1003, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741827_1003, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-12-03 07:23:26,926 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54978 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741827_1003]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1458564024-172.17.0.11-1606980200717:blk_1073741827_1003: PacketHeader with packetLen=4 header data: offsetInBlock: 1024
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-12-03 07:23:26,926 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54978 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741827_1003]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1458564024-172.17.0.11-1606980200717:blk_1073741827_1003
2020-12-03 07:23:26,926 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54978 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741827_1003]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741827_1003, type=LAST_IN_PIPELINE: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=1024, ackEnqueueNanoTime=141198701292928, ackStatus=SUCCESS)
2020-12-03 07:23:26,928 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741827_1003, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:54978, dest: /127.0.0.1:45491, bytes: 1024, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-126688406_1, offset: 0, srvID: 7455378e-99a9-49fc-9e03-4efd4d351125, blockid: BP-1458564024-172.17.0.11-1606980200717:blk_1073741827_1003, duration(ns): 6493107
2020-12-03 07:23:26,930 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741827_1003, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741827_1003, type=LAST_IN_PIPELINE, replyAck=seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:26,930 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741827_1003, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741827_1003, type=LAST_IN_PIPELINE terminating
2020-12-03 07:23:26,931 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54978 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741827_1003]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741827_1003, type=LAST_IN_PIPELINE: closing
2020-12-03 07:23:26,931 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54978 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741827_1003]] DEBUG datanode.DataNode (DataXceiver.java:run(328)) - 127.0.0.1:45491:Number of active connections is: 2
2020-12-03 07:23:26,931 [IPC Server handler 2 on default port 37786] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1627)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45491, datanodeUuid=7455378e-99a9-49fc-9e03-4efd4d351125, infoPort=33275, infoSecurePort=0, ipcPort=33659, storageInfo=lv=-57;cid=testClusterID;nsid=1892489455;c=1606980200717) 1 blocks.
2020-12-03 07:23:26,932 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(4021)) - Reported block blk_1073741827_1003 on 127.0.0.1:45491 size 1024 replicaState = FINALIZED
2020-12-03 07:23:26,932 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(4044)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-12-03 07:23:26,933 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3351)) - BLOCK* addStoredBlock: 127.0.0.1:45491 is added to blk_1073741827_1003 (size=0)
2020-12-03 07:23:26,933 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4154)) - BLOCK* block RECEIVED_BLOCK: blk_1073741827_1003 is received from 127.0.0.1:45491
2020-12-03 07:23:26,933 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4157)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45491 receiving: 0, received: 1, deleted: 0
2020-12-03 07:23:26,935 [IPC Server handler 3 on default port 37786] DEBUG hdfs.StateChange (FSNamesystem.java:getAdditionalBlock(2767)) - BLOCK* getAdditionalBlock: /simpleAppend.dat  inodeId 16386 for DFSClient_NONMAPREDUCE_-126688406_1
2020-12-03 07:23:26,936 [IPC Server handler 3 on default port 37786] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addBlock(524)) - DIR* FSDirectory.addBlock: /simpleAppend.dat with blk_1073741828_1004 block is added to the in-memory file system
2020-12-03 07:23:26,937 [IPC Server handler 3 on default port 37786] INFO  hdfs.StateChange (FSDirWriteFileOp.java:logAllocatedBlock(798)) - BLOCK* allocate blk_1073741828_1004, replicas=127.0.0.1:45491 for /simpleAppend.dat
2020-12-03 07:23:26,937 [IPC Server handler 3 on default port 37786] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistNewBlock(758)) - persistNewBlock: /simpleAppend.dat with new block blk_1073741828_1004, current total block count is 4
2020-12-03 07:23:26,939 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@3f28bd56] DEBUG datanode.DataNode (DataXceiver.java:<init>(154)) - Number of active connections is: 1
2020-12-03 07:23:26,939 [DataStreamer for file /simpleAppend.dat] INFO  sasl.SaslDataTransferClient (SaslDataTransferClient.java:checkTrustAndSend(239)) - SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
2020-12-03 07:23:26,940 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54982 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741828_1004]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(728)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-126688406_1
  block  =BP-1458564024-172.17.0.11-1606980200717:blk_1073741828_1004, newGs=0, bytesRcvd=[0, 0]
  targets=[]; pipelineSize=1, srcDataNode=:0, pinning=false
2020-12-03 07:23:26,941 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54982 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741828_1004]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(734)) - isDatanode=false, isClient=true, isTransfer=false
2020-12-03 07:23:26,941 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54982 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741828_1004]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(736)) - writeBlock receive buf size 531128 tcp no delay true
2020-12-03 07:23:26,941 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54982 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741828_1004]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(747)) - Receiving BP-1458564024-172.17.0.11-1606980200717:blk_1073741828_1004 src: /127.0.0.1:54982 dest: /127.0.0.1:45491
2020-12-03 07:23:26,941 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54982 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741828_1004]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1458564024-172.17.0.11-1606980200717:blk_1073741828_1004
 storageType=DISK, inAddr=/127.0.0.1:54982, myAddr=/127.0.0.1:45491
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-126688406_1, srcDataNode=:0, datanode=127.0.0.1:45491
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-bfd35249-c440-48e2-9558-cf86da199a4b
2020-12-03 07:23:26,942 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54982 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741828_1004]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1458564024-172.17.0.11-1606980200717/current/rbw/blk_1073741828 of size 0
2020-12-03 07:23:26,942 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54982 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741828_1004]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1458564024-172.17.0.11-1606980200717/current/rbw/blk_1073741828_1004.meta of size 0
2020-12-03 07:23:26,942 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741828_1004, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741828_1004, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-12-03 07:23:26,945 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54982 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741828_1004]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1458564024-172.17.0.11-1606980200717:blk_1073741828_1004: PacketHeader with packetLen=520 header data: offsetInBlock: 0
seqno: 2
lastPacketInBlock: false
dataLen: 512

2020-12-03 07:23:26,945 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54982 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741828_1004]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741828_1004, type=LAST_IN_PIPELINE: enqueue Packet(seqno=2, lastPacketInBlock=false, offsetInBlock=512, ackEnqueueNanoTime=141198720381471, ackStatus=SUCCESS)
2020-12-03 07:23:26,946 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54982 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741828_1004]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1458564024-172.17.0.11-1606980200717:blk_1073741828_1004: PacketHeader with packetLen=520 header data: offsetInBlock: 512
seqno: 3
lastPacketInBlock: false
dataLen: 512

2020-12-03 07:23:26,946 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54982 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741828_1004]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741828_1004, type=LAST_IN_PIPELINE: enqueue Packet(seqno=3, lastPacketInBlock=false, offsetInBlock=1024, ackEnqueueNanoTime=141198721270826, ackStatus=SUCCESS)
2020-12-03 07:23:26,946 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741828_1004, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741828_1004, type=LAST_IN_PIPELINE, replyAck=seqno: 2 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:26,946 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741828_1004, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741828_1004, type=LAST_IN_PIPELINE, replyAck=seqno: 3 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:26,947 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741828_1004, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741828_1004, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-12-03 07:23:26,947 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54982 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741828_1004]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1458564024-172.17.0.11-1606980200717:blk_1073741828_1004: PacketHeader with packetLen=4 header data: offsetInBlock: 1024
seqno: 4
lastPacketInBlock: true
dataLen: 0

2020-12-03 07:23:26,947 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54982 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741828_1004]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1458564024-172.17.0.11-1606980200717:blk_1073741828_1004
2020-12-03 07:23:26,947 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54982 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741828_1004]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741828_1004, type=LAST_IN_PIPELINE: enqueue Packet(seqno=4, lastPacketInBlock=true, offsetInBlock=1024, ackEnqueueNanoTime=141198722618091, ackStatus=SUCCESS)
2020-12-03 07:23:26,950 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741828_1004, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:54982, dest: /127.0.0.1:45491, bytes: 1024, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-126688406_1, offset: 0, srvID: 7455378e-99a9-49fc-9e03-4efd4d351125, blockid: BP-1458564024-172.17.0.11-1606980200717:blk_1073741828_1004, duration(ns): 5841984
2020-12-03 07:23:26,951 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741828_1004, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741828_1004, type=LAST_IN_PIPELINE, replyAck=seqno: 4 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:26,951 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741828_1004, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741828_1004, type=LAST_IN_PIPELINE terminating
2020-12-03 07:23:26,951 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54982 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741828_1004]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741828_1004, type=LAST_IN_PIPELINE: closing
2020-12-03 07:23:26,952 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54982 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741828_1004]] DEBUG datanode.DataNode (DataXceiver.java:run(328)) - 127.0.0.1:45491:Number of active connections is: 2
2020-12-03 07:23:26,953 [IPC Server handler 4 on default port 37786] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1627)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45491, datanodeUuid=7455378e-99a9-49fc-9e03-4efd4d351125, infoPort=33275, infoSecurePort=0, ipcPort=33659, storageInfo=lv=-57;cid=testClusterID;nsid=1892489455;c=1606980200717) 1 blocks.
2020-12-03 07:23:26,953 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(4021)) - Reported block blk_1073741828_1004 on 127.0.0.1:45491 size 1024 replicaState = FINALIZED
2020-12-03 07:23:26,954 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(4044)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-12-03 07:23:26,954 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3351)) - BLOCK* addStoredBlock: 127.0.0.1:45491 is added to blk_1073741828_1004 (size=0)
2020-12-03 07:23:26,954 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4154)) - BLOCK* block RECEIVED_BLOCK: blk_1073741828_1004 is received from 127.0.0.1:45491
2020-12-03 07:23:26,954 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4157)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45491 receiving: 0, received: 1, deleted: 0
2020-12-03 07:23:26,955 [IPC Server handler 5 on default port 37786] DEBUG hdfs.StateChange (FSNamesystem.java:getAdditionalBlock(2767)) - BLOCK* getAdditionalBlock: /simpleAppend.dat  inodeId 16386 for DFSClient_NONMAPREDUCE_-126688406_1
2020-12-03 07:23:26,955 [IPC Server handler 5 on default port 37786] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addBlock(524)) - DIR* FSDirectory.addBlock: /simpleAppend.dat with blk_1073741829_1005 block is added to the in-memory file system
2020-12-03 07:23:26,956 [IPC Server handler 5 on default port 37786] INFO  hdfs.StateChange (FSDirWriteFileOp.java:logAllocatedBlock(798)) - BLOCK* allocate blk_1073741829_1005, replicas=127.0.0.1:45491 for /simpleAppend.dat
2020-12-03 07:23:26,956 [IPC Server handler 5 on default port 37786] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistNewBlock(758)) - persistNewBlock: /simpleAppend.dat with new block blk_1073741829_1005, current total block count is 5
2020-12-03 07:23:26,958 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@3f28bd56] DEBUG datanode.DataNode (DataXceiver.java:<init>(154)) - Number of active connections is: 1
2020-12-03 07:23:26,958 [DataStreamer for file /simpleAppend.dat] INFO  sasl.SaslDataTransferClient (SaslDataTransferClient.java:checkTrustAndSend(239)) - SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
2020-12-03 07:23:26,959 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54990 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741829_1005]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(728)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-126688406_1
  block  =BP-1458564024-172.17.0.11-1606980200717:blk_1073741829_1005, newGs=0, bytesRcvd=[0, 0]
  targets=[]; pipelineSize=1, srcDataNode=:0, pinning=false
2020-12-03 07:23:26,960 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54990 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741829_1005]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(734)) - isDatanode=false, isClient=true, isTransfer=false
2020-12-03 07:23:26,960 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54990 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741829_1005]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(736)) - writeBlock receive buf size 531128 tcp no delay true
2020-12-03 07:23:26,960 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54990 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741829_1005]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(747)) - Receiving BP-1458564024-172.17.0.11-1606980200717:blk_1073741829_1005 src: /127.0.0.1:54990 dest: /127.0.0.1:45491
2020-12-03 07:23:26,960 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54990 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741829_1005]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1458564024-172.17.0.11-1606980200717:blk_1073741829_1005
 storageType=DISK, inAddr=/127.0.0.1:54990, myAddr=/127.0.0.1:45491
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-126688406_1, srcDataNode=:0, datanode=127.0.0.1:45491
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-bfd35249-c440-48e2-9558-cf86da199a4b
2020-12-03 07:23:26,960 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54990 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741829_1005]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-1458564024-172.17.0.11-1606980200717/current/rbw/blk_1073741829 of size 0
2020-12-03 07:23:26,960 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54990 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741829_1005]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-1458564024-172.17.0.11-1606980200717/current/rbw/blk_1073741829_1005.meta of size 0
2020-12-03 07:23:26,961 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741829_1005, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741829_1005, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-12-03 07:23:26,962 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54990 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741829_1005]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1458564024-172.17.0.11-1606980200717:blk_1073741829_1005: PacketHeader with packetLen=520 header data: offsetInBlock: 0
seqno: 5
lastPacketInBlock: false
dataLen: 512

2020-12-03 07:23:26,963 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54990 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741829_1005]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741829_1005, type=LAST_IN_PIPELINE: enqueue Packet(seqno=5, lastPacketInBlock=false, offsetInBlock=512, ackEnqueueNanoTime=141198737921825, ackStatus=SUCCESS)
2020-12-03 07:23:26,963 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54990 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741829_1005]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1458564024-172.17.0.11-1606980200717:blk_1073741829_1005: PacketHeader with packetLen=520 header data: offsetInBlock: 512
seqno: 6
lastPacketInBlock: false
dataLen: 512

2020-12-03 07:23:26,963 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741829_1005, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741829_1005, type=LAST_IN_PIPELINE, replyAck=seqno: 5 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:26,963 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54990 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741829_1005]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741829_1005, type=LAST_IN_PIPELINE: enqueue Packet(seqno=6, lastPacketInBlock=false, offsetInBlock=1024, ackEnqueueNanoTime=141198738796800, ackStatus=SUCCESS)
2020-12-03 07:23:26,964 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741829_1005, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741829_1005, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-12-03 07:23:26,964 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741829_1005, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741829_1005, type=LAST_IN_PIPELINE, replyAck=seqno: 6 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:26,964 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741829_1005, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741829_1005, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-12-03 07:23:26,965 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54990 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741829_1005]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1458564024-172.17.0.11-1606980200717:blk_1073741829_1005: PacketHeader with packetLen=4 header data: offsetInBlock: 1024
seqno: 7
lastPacketInBlock: true
dataLen: 0

2020-12-03 07:23:26,965 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54990 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741829_1005]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1458564024-172.17.0.11-1606980200717:blk_1073741829_1005
2020-12-03 07:23:26,965 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54990 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741829_1005]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741829_1005, type=LAST_IN_PIPELINE: enqueue Packet(seqno=7, lastPacketInBlock=true, offsetInBlock=1024, ackEnqueueNanoTime=141198740168226, ackStatus=SUCCESS)
2020-12-03 07:23:26,966 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741829_1005, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:54990, dest: /127.0.0.1:45491, bytes: 1024, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-126688406_1, offset: 0, srvID: 7455378e-99a9-49fc-9e03-4efd4d351125, blockid: BP-1458564024-172.17.0.11-1606980200717:blk_1073741829_1005, duration(ns): 4576754
2020-12-03 07:23:26,967 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741829_1005, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741829_1005, type=LAST_IN_PIPELINE, replyAck=seqno: 7 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:26,967 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741829_1005, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741829_1005, type=LAST_IN_PIPELINE terminating
2020-12-03 07:23:26,969 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54990 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741829_1005]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741829_1005, type=LAST_IN_PIPELINE: closing
2020-12-03 07:23:26,970 [IPC Server handler 7 on default port 37786] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1627)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45491, datanodeUuid=7455378e-99a9-49fc-9e03-4efd4d351125, infoPort=33275, infoSecurePort=0, ipcPort=33659, storageInfo=lv=-57;cid=testClusterID;nsid=1892489455;c=1606980200717) 1 blocks.
2020-12-03 07:23:26,970 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54990 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741829_1005]] DEBUG datanode.DataNode (DataXceiver.java:run(328)) - 127.0.0.1:45491:Number of active connections is: 2
2020-12-03 07:23:26,970 [IPC Server handler 7 on default port 37786] DEBUG hdfs.StateChange (FSNamesystem.java:getAdditionalBlock(2767)) - BLOCK* getAdditionalBlock: /simpleAppend.dat  inodeId 16386 for DFSClient_NONMAPREDUCE_-126688406_1
2020-12-03 07:23:26,971 [IPC Server handler 7 on default port 37786] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addBlock(524)) - DIR* FSDirectory.addBlock: /simpleAppend.dat with blk_1073741830_1006 block is added to the in-memory file system
2020-12-03 07:23:26,971 [IPC Server handler 7 on default port 37786] INFO  hdfs.StateChange (FSDirWriteFileOp.java:logAllocatedBlock(798)) - BLOCK* allocate blk_1073741830_1006, replicas=127.0.0.1:45491 for /simpleAppend.dat
2020-12-03 07:23:26,972 [IPC Server handler 7 on default port 37786] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistNewBlock(758)) - persistNewBlock: /simpleAppend.dat with new block blk_1073741830_1006, current total block count is 6
2020-12-03 07:23:26,973 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(4021)) - Reported block blk_1073741829_1005 on 127.0.0.1:45491 size 1024 replicaState = FINALIZED
2020-12-03 07:23:26,973 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(4044)) - In memory blockUCState = COMMITTED
2020-12-03 07:23:26,973 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3351)) - BLOCK* addStoredBlock: 127.0.0.1:45491 is added to blk_1073741829_1005 (size=1024)
2020-12-03 07:23:26,973 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4154)) - BLOCK* block RECEIVED_BLOCK: blk_1073741829_1005 is received from 127.0.0.1:45491
2020-12-03 07:23:26,973 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4157)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45491 receiving: 0, received: 1, deleted: 0
2020-12-03 07:23:26,976 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@3f28bd56] DEBUG datanode.DataNode (DataXceiver.java:<init>(154)) - Number of active connections is: 1
2020-12-03 07:23:26,976 [DataStreamer for file /simpleAppend.dat] INFO  sasl.SaslDataTransferClient (SaslDataTransferClient.java:checkTrustAndSend(239)) - SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
2020-12-03 07:23:26,978 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54996 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741830_1006]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(728)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-126688406_1
  block  =BP-1458564024-172.17.0.11-1606980200717:blk_1073741830_1006, newGs=0, bytesRcvd=[0, 0]
  targets=[]; pipelineSize=1, srcDataNode=:0, pinning=false
2020-12-03 07:23:26,978 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54996 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741830_1006]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(734)) - isDatanode=false, isClient=true, isTransfer=false
2020-12-03 07:23:26,978 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54996 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741830_1006]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(736)) - writeBlock receive buf size 531128 tcp no delay true
2020-12-03 07:23:26,978 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54996 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741830_1006]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(747)) - Receiving BP-1458564024-172.17.0.11-1606980200717:blk_1073741830_1006 src: /127.0.0.1:54996 dest: /127.0.0.1:45491
2020-12-03 07:23:26,979 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54996 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741830_1006]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1458564024-172.17.0.11-1606980200717:blk_1073741830_1006
 storageType=DISK, inAddr=/127.0.0.1:54996, myAddr=/127.0.0.1:45491
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-126688406_1, srcDataNode=:0, datanode=127.0.0.1:45491
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-bfd35249-c440-48e2-9558-cf86da199a4b
2020-12-03 07:23:26,979 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54996 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741830_1006]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1458564024-172.17.0.11-1606980200717/current/rbw/blk_1073741830 of size 0
2020-12-03 07:23:26,979 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54996 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741830_1006]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1458564024-172.17.0.11-1606980200717/current/rbw/blk_1073741830_1006.meta of size 0
2020-12-03 07:23:26,985 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741830_1006, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741830_1006, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-12-03 07:23:26,989 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54996 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741830_1006]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1458564024-172.17.0.11-1606980200717:blk_1073741830_1006: PacketHeader with packetLen=520 header data: offsetInBlock: 0
seqno: 8
lastPacketInBlock: false
dataLen: 512

2020-12-03 07:23:26,989 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54996 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741830_1006]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741830_1006, type=LAST_IN_PIPELINE: enqueue Packet(seqno=8, lastPacketInBlock=false, offsetInBlock=512, ackEnqueueNanoTime=141198764862784, ackStatus=SUCCESS)
2020-12-03 07:23:26,991 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741830_1006, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741830_1006, type=LAST_IN_PIPELINE, replyAck=seqno: 8 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:26,991 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741830_1006, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741830_1006, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-12-03 07:23:26,993 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54996 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741830_1006]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1458564024-172.17.0.11-1606980200717:blk_1073741830_1006: PacketHeader with packetLen=520 header data: offsetInBlock: 512
seqno: 9
lastPacketInBlock: false
dataLen: 512

2020-12-03 07:23:26,993 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54996 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741830_1006]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741830_1006, type=LAST_IN_PIPELINE: enqueue Packet(seqno=9, lastPacketInBlock=false, offsetInBlock=1024, ackEnqueueNanoTime=141198768332701, ackStatus=SUCCESS)
2020-12-03 07:23:26,993 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741830_1006, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741830_1006, type=LAST_IN_PIPELINE, replyAck=seqno: 9 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:26,994 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741830_1006, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741830_1006, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-12-03 07:23:26,994 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54996 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741830_1006]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1458564024-172.17.0.11-1606980200717:blk_1073741830_1006: PacketHeader with packetLen=4 header data: offsetInBlock: 1024
seqno: 10
lastPacketInBlock: true
dataLen: 0

2020-12-03 07:23:26,994 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54996 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741830_1006]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1458564024-172.17.0.11-1606980200717:blk_1073741830_1006
2020-12-03 07:23:26,994 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54996 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741830_1006]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741830_1006, type=LAST_IN_PIPELINE: enqueue Packet(seqno=10, lastPacketInBlock=true, offsetInBlock=1024, ackEnqueueNanoTime=141198769763715, ackStatus=SUCCESS)
2020-12-03 07:23:26,998 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741830_1006, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:54996, dest: /127.0.0.1:45491, bytes: 1024, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-126688406_1, offset: 0, srvID: 7455378e-99a9-49fc-9e03-4efd4d351125, blockid: BP-1458564024-172.17.0.11-1606980200717:blk_1073741830_1006, duration(ns): 11984836
2020-12-03 07:23:26,998 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741830_1006, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741830_1006, type=LAST_IN_PIPELINE, replyAck=seqno: 10 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:26,999 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741830_1006, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741830_1006, type=LAST_IN_PIPELINE terminating
2020-12-03 07:23:26,999 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54996 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741830_1006]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741830_1006, type=LAST_IN_PIPELINE: closing
2020-12-03 07:23:27,000 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:54996 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741830_1006]] DEBUG datanode.DataNode (DataXceiver.java:run(328)) - 127.0.0.1:45491:Number of active connections is: 2
2020-12-03 07:23:27,001 [IPC Server handler 6 on default port 37786] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1627)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45491, datanodeUuid=7455378e-99a9-49fc-9e03-4efd4d351125, infoPort=33275, infoSecurePort=0, ipcPort=33659, storageInfo=lv=-57;cid=testClusterID;nsid=1892489455;c=1606980200717) 1 blocks.
2020-12-03 07:23:27,002 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(4021)) - Reported block blk_1073741830_1006 on 127.0.0.1:45491 size 1024 replicaState = FINALIZED
2020-12-03 07:23:27,002 [IPC Server handler 9 on default port 37786] DEBUG hdfs.StateChange (FSNamesystem.java:getAdditionalBlock(2767)) - BLOCK* getAdditionalBlock: /simpleAppend.dat  inodeId 16386 for DFSClient_NONMAPREDUCE_-126688406_1
2020-12-03 07:23:27,002 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(4044)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-12-03 07:23:27,003 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3351)) - BLOCK* addStoredBlock: 127.0.0.1:45491 is added to blk_1073741830_1006 (size=0)
2020-12-03 07:23:27,003 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4154)) - BLOCK* block RECEIVED_BLOCK: blk_1073741830_1006 is received from 127.0.0.1:45491
2020-12-03 07:23:27,003 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4157)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45491 receiving: 0, received: 1, deleted: 0
2020-12-03 07:23:27,004 [IPC Server handler 9 on default port 37786] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addBlock(524)) - DIR* FSDirectory.addBlock: /simpleAppend.dat with blk_1073741831_1007 block is added to the in-memory file system
2020-12-03 07:23:27,004 [IPC Server handler 9 on default port 37786] INFO  hdfs.StateChange (FSDirWriteFileOp.java:logAllocatedBlock(798)) - BLOCK* allocate blk_1073741831_1007, replicas=127.0.0.1:45491 for /simpleAppend.dat
2020-12-03 07:23:27,004 [IPC Server handler 9 on default port 37786] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistNewBlock(758)) - persistNewBlock: /simpleAppend.dat with new block blk_1073741831_1007, current total block count is 7
2020-12-03 07:23:27,006 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@3f28bd56] DEBUG datanode.DataNode (DataXceiver.java:<init>(154)) - Number of active connections is: 1
2020-12-03 07:23:27,006 [DataStreamer for file /simpleAppend.dat] INFO  sasl.SaslDataTransferClient (SaslDataTransferClient.java:checkTrustAndSend(239)) - SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
2020-12-03 07:23:27,007 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55006 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741831_1007]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(728)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-126688406_1
  block  =BP-1458564024-172.17.0.11-1606980200717:blk_1073741831_1007, newGs=0, bytesRcvd=[0, 0]
  targets=[]; pipelineSize=1, srcDataNode=:0, pinning=false
2020-12-03 07:23:27,008 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55006 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741831_1007]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(734)) - isDatanode=false, isClient=true, isTransfer=false
2020-12-03 07:23:27,008 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55006 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741831_1007]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(736)) - writeBlock receive buf size 531128 tcp no delay true
2020-12-03 07:23:27,008 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55006 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741831_1007]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(747)) - Receiving BP-1458564024-172.17.0.11-1606980200717:blk_1073741831_1007 src: /127.0.0.1:55006 dest: /127.0.0.1:45491
2020-12-03 07:23:27,008 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55006 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741831_1007]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1458564024-172.17.0.11-1606980200717:blk_1073741831_1007
 storageType=DISK, inAddr=/127.0.0.1:55006, myAddr=/127.0.0.1:45491
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-126688406_1, srcDataNode=:0, datanode=127.0.0.1:45491
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-bfd35249-c440-48e2-9558-cf86da199a4b
2020-12-03 07:23:27,009 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55006 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741831_1007]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-1458564024-172.17.0.11-1606980200717/current/rbw/blk_1073741831 of size 0
2020-12-03 07:23:27,009 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55006 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741831_1007]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-1458564024-172.17.0.11-1606980200717/current/rbw/blk_1073741831_1007.meta of size 0
2020-12-03 07:23:27,009 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741831_1007, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741831_1007, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-12-03 07:23:27,025 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55006 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741831_1007]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1458564024-172.17.0.11-1606980200717:blk_1073741831_1007: PacketHeader with packetLen=520 header data: offsetInBlock: 0
seqno: 11
lastPacketInBlock: false
dataLen: 512

2020-12-03 07:23:27,026 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55006 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741831_1007]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741831_1007, type=LAST_IN_PIPELINE: enqueue Packet(seqno=11, lastPacketInBlock=false, offsetInBlock=512, ackEnqueueNanoTime=141198801215801, ackStatus=SUCCESS)
2020-12-03 07:23:27,027 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55006 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741831_1007]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1458564024-172.17.0.11-1606980200717:blk_1073741831_1007: PacketHeader with packetLen=520 header data: offsetInBlock: 512
seqno: 12
lastPacketInBlock: false
dataLen: 512

2020-12-03 07:23:27,027 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55006 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741831_1007]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741831_1007, type=LAST_IN_PIPELINE: enqueue Packet(seqno=12, lastPacketInBlock=false, offsetInBlock=1024, ackEnqueueNanoTime=141198802806945, ackStatus=SUCCESS)
2020-12-03 07:23:27,030 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741831_1007, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741831_1007, type=LAST_IN_PIPELINE, replyAck=seqno: 11 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:27,032 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741831_1007, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741831_1007, type=LAST_IN_PIPELINE, replyAck=seqno: 12 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:27,032 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741831_1007, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741831_1007, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-12-03 07:23:27,037 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55006 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741831_1007]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1458564024-172.17.0.11-1606980200717:blk_1073741831_1007: PacketHeader with packetLen=4 header data: offsetInBlock: 1024
seqno: 13
lastPacketInBlock: true
dataLen: 0

2020-12-03 07:23:27,037 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55006 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741831_1007]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1458564024-172.17.0.11-1606980200717:blk_1073741831_1007
2020-12-03 07:23:27,038 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55006 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741831_1007]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741831_1007, type=LAST_IN_PIPELINE: enqueue Packet(seqno=13, lastPacketInBlock=true, offsetInBlock=1024, ackEnqueueNanoTime=141198812976824, ackStatus=SUCCESS)
2020-12-03 07:23:27,048 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741831_1007, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:55006, dest: /127.0.0.1:45491, bytes: 1024, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-126688406_1, offset: 0, srvID: 7455378e-99a9-49fc-9e03-4efd4d351125, blockid: BP-1458564024-172.17.0.11-1606980200717:blk_1073741831_1007, duration(ns): 37757158
2020-12-03 07:23:27,049 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741831_1007, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741831_1007, type=LAST_IN_PIPELINE, replyAck=seqno: 13 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:27,049 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741831_1007, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741831_1007, type=LAST_IN_PIPELINE terminating
2020-12-03 07:23:27,049 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55006 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741831_1007]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741831_1007, type=LAST_IN_PIPELINE: closing
2020-12-03 07:23:27,055 [IPC Server handler 1 on default port 37786] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1627)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45491, datanodeUuid=7455378e-99a9-49fc-9e03-4efd4d351125, infoPort=33275, infoSecurePort=0, ipcPort=33659, storageInfo=lv=-57;cid=testClusterID;nsid=1892489455;c=1606980200717) 1 blocks.
2020-12-03 07:23:27,059 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55006 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741831_1007]] DEBUG datanode.DataNode (DataXceiver.java:run(328)) - 127.0.0.1:45491:Number of active connections is: 2
2020-12-03 07:23:27,059 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(4021)) - Reported block blk_1073741831_1007 on 127.0.0.1:45491 size 1024 replicaState = FINALIZED
2020-12-03 07:23:27,060 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(4044)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-12-03 07:23:27,060 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3351)) - BLOCK* addStoredBlock: 127.0.0.1:45491 is added to blk_1073741831_1007 (size=0)
2020-12-03 07:23:27,060 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4154)) - BLOCK* block RECEIVED_BLOCK: blk_1073741831_1007 is received from 127.0.0.1:45491
2020-12-03 07:23:27,060 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4157)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45491 receiving: 0, received: 1, deleted: 0
2020-12-03 07:23:27,063 [IPC Server handler 0 on default port 37786] DEBUG hdfs.StateChange (FSNamesystem.java:getAdditionalBlock(2767)) - BLOCK* getAdditionalBlock: /simpleAppend.dat  inodeId 16386 for DFSClient_NONMAPREDUCE_-126688406_1
2020-12-03 07:23:27,064 [IPC Server handler 0 on default port 37786] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addBlock(524)) - DIR* FSDirectory.addBlock: /simpleAppend.dat with blk_1073741832_1008 block is added to the in-memory file system
2020-12-03 07:23:27,064 [IPC Server handler 0 on default port 37786] INFO  hdfs.StateChange (FSDirWriteFileOp.java:logAllocatedBlock(798)) - BLOCK* allocate blk_1073741832_1008, replicas=127.0.0.1:45491 for /simpleAppend.dat
2020-12-03 07:23:27,064 [IPC Server handler 0 on default port 37786] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistNewBlock(758)) - persistNewBlock: /simpleAppend.dat with new block blk_1073741832_1008, current total block count is 8
2020-12-03 07:23:27,066 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@3f28bd56] DEBUG datanode.DataNode (DataXceiver.java:<init>(154)) - Number of active connections is: 1
2020-12-03 07:23:27,066 [DataStreamer for file /simpleAppend.dat] INFO  sasl.SaslDataTransferClient (SaslDataTransferClient.java:checkTrustAndSend(239)) - SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
2020-12-03 07:23:27,068 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55038 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741832_1008]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(728)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-126688406_1
  block  =BP-1458564024-172.17.0.11-1606980200717:blk_1073741832_1008, newGs=0, bytesRcvd=[0, 0]
  targets=[]; pipelineSize=1, srcDataNode=:0, pinning=false
2020-12-03 07:23:27,068 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55038 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741832_1008]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(734)) - isDatanode=false, isClient=true, isTransfer=false
2020-12-03 07:23:27,068 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55038 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741832_1008]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(736)) - writeBlock receive buf size 531128 tcp no delay true
2020-12-03 07:23:27,069 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55038 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741832_1008]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(747)) - Receiving BP-1458564024-172.17.0.11-1606980200717:blk_1073741832_1008 src: /127.0.0.1:55038 dest: /127.0.0.1:45491
2020-12-03 07:23:27,069 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55038 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741832_1008]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1458564024-172.17.0.11-1606980200717:blk_1073741832_1008
 storageType=DISK, inAddr=/127.0.0.1:55038, myAddr=/127.0.0.1:45491
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-126688406_1, srcDataNode=:0, datanode=127.0.0.1:45491
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-bfd35249-c440-48e2-9558-cf86da199a4b
2020-12-03 07:23:27,069 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55038 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741832_1008]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1458564024-172.17.0.11-1606980200717/current/rbw/blk_1073741832 of size 0
2020-12-03 07:23:27,069 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55038 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741832_1008]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1458564024-172.17.0.11-1606980200717/current/rbw/blk_1073741832_1008.meta of size 0
2020-12-03 07:23:27,073 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741832_1008, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741832_1008, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-12-03 07:23:27,076 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55038 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741832_1008]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1458564024-172.17.0.11-1606980200717:blk_1073741832_1008: PacketHeader with packetLen=520 header data: offsetInBlock: 0
seqno: 14
lastPacketInBlock: false
dataLen: 512

2020-12-03 07:23:27,076 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55038 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741832_1008]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741832_1008, type=LAST_IN_PIPELINE: enqueue Packet(seqno=14, lastPacketInBlock=false, offsetInBlock=512, ackEnqueueNanoTime=141198851821575, ackStatus=SUCCESS)
2020-12-03 07:23:27,077 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55038 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741832_1008]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1458564024-172.17.0.11-1606980200717:blk_1073741832_1008: PacketHeader with packetLen=520 header data: offsetInBlock: 512
seqno: 15
lastPacketInBlock: false
dataLen: 512

2020-12-03 07:23:27,077 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55038 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741832_1008]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741832_1008, type=LAST_IN_PIPELINE: enqueue Packet(seqno=15, lastPacketInBlock=false, offsetInBlock=1024, ackEnqueueNanoTime=141198852425177, ackStatus=SUCCESS)
2020-12-03 07:23:27,079 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741832_1008, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741832_1008, type=LAST_IN_PIPELINE, replyAck=seqno: 14 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:27,079 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741832_1008, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741832_1008, type=LAST_IN_PIPELINE, replyAck=seqno: 15 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:27,079 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741832_1008, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741832_1008, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-12-03 07:23:27,080 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55038 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741832_1008]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1458564024-172.17.0.11-1606980200717:blk_1073741832_1008: PacketHeader with packetLen=4 header data: offsetInBlock: 1024
seqno: 16
lastPacketInBlock: true
dataLen: 0

2020-12-03 07:23:27,081 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55038 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741832_1008]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1458564024-172.17.0.11-1606980200717:blk_1073741832_1008
2020-12-03 07:23:27,081 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55038 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741832_1008]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741832_1008, type=LAST_IN_PIPELINE: enqueue Packet(seqno=16, lastPacketInBlock=true, offsetInBlock=1024, ackEnqueueNanoTime=141198856202710, ackStatus=SUCCESS)
2020-12-03 07:23:27,096 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741832_1008, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:55038, dest: /127.0.0.1:45491, bytes: 1024, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-126688406_1, offset: 0, srvID: 7455378e-99a9-49fc-9e03-4efd4d351125, blockid: BP-1458564024-172.17.0.11-1606980200717:blk_1073741832_1008, duration(ns): 20620037
2020-12-03 07:23:27,096 [IPC Server handler 2 on default port 37786] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1627)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45491, datanodeUuid=7455378e-99a9-49fc-9e03-4efd4d351125, infoPort=33275, infoSecurePort=0, ipcPort=33659, storageInfo=lv=-57;cid=testClusterID;nsid=1892489455;c=1606980200717) 1 blocks.
2020-12-03 07:23:27,096 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741832_1008, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741832_1008, type=LAST_IN_PIPELINE, replyAck=seqno: 16 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:27,097 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741832_1008, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741832_1008, type=LAST_IN_PIPELINE terminating
2020-12-03 07:23:27,097 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55038 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741832_1008]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741832_1008, type=LAST_IN_PIPELINE: closing
2020-12-03 07:23:27,097 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(4021)) - Reported block blk_1073741832_1008 on 127.0.0.1:45491 size 1024 replicaState = FINALIZED
2020-12-03 07:23:27,097 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(4044)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-12-03 07:23:27,097 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3351)) - BLOCK* addStoredBlock: 127.0.0.1:45491 is added to blk_1073741832_1008 (size=0)
2020-12-03 07:23:27,097 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4154)) - BLOCK* block RECEIVED_BLOCK: blk_1073741832_1008 is received from 127.0.0.1:45491
2020-12-03 07:23:27,097 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4157)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45491 receiving: 0, received: 1, deleted: 0
2020-12-03 07:23:27,105 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55038 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741832_1008]] DEBUG datanode.DataNode (DataXceiver.java:run(328)) - 127.0.0.1:45491:Number of active connections is: 2
2020-12-03 07:23:27,113 [IPC Server handler 3 on default port 37786] DEBUG hdfs.StateChange (FSNamesystem.java:getAdditionalBlock(2767)) - BLOCK* getAdditionalBlock: /simpleAppend.dat  inodeId 16386 for DFSClient_NONMAPREDUCE_-126688406_1
2020-12-03 07:23:27,115 [IPC Server handler 3 on default port 37786] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addBlock(524)) - DIR* FSDirectory.addBlock: /simpleAppend.dat with blk_1073741833_1009 block is added to the in-memory file system
2020-12-03 07:23:27,115 [IPC Server handler 3 on default port 37786] INFO  hdfs.StateChange (FSDirWriteFileOp.java:logAllocatedBlock(798)) - BLOCK* allocate blk_1073741833_1009, replicas=127.0.0.1:45491 for /simpleAppend.dat
2020-12-03 07:23:27,117 [IPC Server handler 3 on default port 37786] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistNewBlock(758)) - persistNewBlock: /simpleAppend.dat with new block blk_1073741833_1009, current total block count is 9
2020-12-03 07:23:27,120 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@3f28bd56] DEBUG datanode.DataNode (DataXceiver.java:<init>(154)) - Number of active connections is: 1
2020-12-03 07:23:27,120 [DataStreamer for file /simpleAppend.dat] INFO  sasl.SaslDataTransferClient (SaslDataTransferClient.java:checkTrustAndSend(239)) - SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
2020-12-03 07:23:27,121 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55058 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741833_1009]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(728)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-126688406_1
  block  =BP-1458564024-172.17.0.11-1606980200717:blk_1073741833_1009, newGs=0, bytesRcvd=[0, 0]
  targets=[]; pipelineSize=1, srcDataNode=:0, pinning=false
2020-12-03 07:23:27,121 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55058 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741833_1009]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(734)) - isDatanode=false, isClient=true, isTransfer=false
2020-12-03 07:23:27,121 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55058 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741833_1009]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(736)) - writeBlock receive buf size 531128 tcp no delay true
2020-12-03 07:23:27,121 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55058 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741833_1009]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(747)) - Receiving BP-1458564024-172.17.0.11-1606980200717:blk_1073741833_1009 src: /127.0.0.1:55058 dest: /127.0.0.1:45491
2020-12-03 07:23:27,121 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55058 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741833_1009]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1458564024-172.17.0.11-1606980200717:blk_1073741833_1009
 storageType=DISK, inAddr=/127.0.0.1:55058, myAddr=/127.0.0.1:45491
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-126688406_1, srcDataNode=:0, datanode=127.0.0.1:45491
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-bfd35249-c440-48e2-9558-cf86da199a4b
2020-12-03 07:23:27,122 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55058 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741833_1009]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-1458564024-172.17.0.11-1606980200717/current/rbw/blk_1073741833 of size 0
2020-12-03 07:23:27,122 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55058 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741833_1009]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-1458564024-172.17.0.11-1606980200717/current/rbw/blk_1073741833_1009.meta of size 0
2020-12-03 07:23:27,123 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741833_1009, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741833_1009, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-12-03 07:23:27,124 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55058 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741833_1009]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1458564024-172.17.0.11-1606980200717:blk_1073741833_1009: PacketHeader with packetLen=520 header data: offsetInBlock: 0
seqno: 17
lastPacketInBlock: false
dataLen: 512

2020-12-03 07:23:27,124 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55058 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741833_1009]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741833_1009, type=LAST_IN_PIPELINE: enqueue Packet(seqno=17, lastPacketInBlock=false, offsetInBlock=512, ackEnqueueNanoTime=141198899471541, ackStatus=SUCCESS)
2020-12-03 07:23:27,125 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55058 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741833_1009]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1458564024-172.17.0.11-1606980200717:blk_1073741833_1009: PacketHeader with packetLen=520 header data: offsetInBlock: 512
seqno: 18
lastPacketInBlock: false
dataLen: 512

2020-12-03 07:23:27,125 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55058 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741833_1009]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741833_1009, type=LAST_IN_PIPELINE: enqueue Packet(seqno=18, lastPacketInBlock=false, offsetInBlock=1024, ackEnqueueNanoTime=141198900415697, ackStatus=SUCCESS)
2020-12-03 07:23:27,126 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741833_1009, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741833_1009, type=LAST_IN_PIPELINE, replyAck=seqno: 17 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:27,127 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741833_1009, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741833_1009, type=LAST_IN_PIPELINE, replyAck=seqno: 18 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:27,127 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741833_1009, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741833_1009, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-12-03 07:23:27,128 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55058 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741833_1009]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1458564024-172.17.0.11-1606980200717:blk_1073741833_1009: PacketHeader with packetLen=4 header data: offsetInBlock: 1024
seqno: 19
lastPacketInBlock: true
dataLen: 0

2020-12-03 07:23:27,128 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55058 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741833_1009]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1458564024-172.17.0.11-1606980200717:blk_1073741833_1009
2020-12-03 07:23:27,128 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55058 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741833_1009]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741833_1009, type=LAST_IN_PIPELINE: enqueue Packet(seqno=19, lastPacketInBlock=true, offsetInBlock=1024, ackEnqueueNanoTime=141198903459974, ackStatus=SUCCESS)
2020-12-03 07:23:27,131 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741833_1009, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:55058, dest: /127.0.0.1:45491, bytes: 1024, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-126688406_1, offset: 0, srvID: 7455378e-99a9-49fc-9e03-4efd4d351125, blockid: BP-1458564024-172.17.0.11-1606980200717:blk_1073741833_1009, duration(ns): 7031410
2020-12-03 07:23:27,131 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741833_1009, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741833_1009, type=LAST_IN_PIPELINE, replyAck=seqno: 19 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:27,133 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741833_1009, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741833_1009, type=LAST_IN_PIPELINE terminating
2020-12-03 07:23:27,132 [IPC Server handler 4 on default port 37786] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1627)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45491, datanodeUuid=7455378e-99a9-49fc-9e03-4efd4d351125, infoPort=33275, infoSecurePort=0, ipcPort=33659, storageInfo=lv=-57;cid=testClusterID;nsid=1892489455;c=1606980200717) 1 blocks.
2020-12-03 07:23:27,133 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55058 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741833_1009]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741833_1009, type=LAST_IN_PIPELINE: closing
2020-12-03 07:23:27,137 [IPC Server handler 5 on default port 37786] DEBUG hdfs.StateChange (FSNamesystem.java:getAdditionalBlock(2767)) - BLOCK* getAdditionalBlock: /simpleAppend.dat  inodeId 16386 for DFSClient_NONMAPREDUCE_-126688406_1
2020-12-03 07:23:27,138 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55058 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741833_1009]] DEBUG datanode.DataNode (DataXceiver.java:run(328)) - 127.0.0.1:45491:Number of active connections is: 2
2020-12-03 07:23:27,137 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(4021)) - Reported block blk_1073741833_1009 on 127.0.0.1:45491 size 1024 replicaState = FINALIZED
2020-12-03 07:23:27,138 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(4044)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-12-03 07:23:27,138 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3351)) - BLOCK* addStoredBlock: 127.0.0.1:45491 is added to blk_1073741833_1009 (size=0)
2020-12-03 07:23:27,138 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4154)) - BLOCK* block RECEIVED_BLOCK: blk_1073741833_1009 is received from 127.0.0.1:45491
2020-12-03 07:23:27,138 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4157)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45491 receiving: 0, received: 1, deleted: 0
2020-12-03 07:23:27,139 [IPC Server handler 5 on default port 37786] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addBlock(524)) - DIR* FSDirectory.addBlock: /simpleAppend.dat with blk_1073741834_1010 block is added to the in-memory file system
2020-12-03 07:23:27,139 [IPC Server handler 5 on default port 37786] INFO  hdfs.StateChange (FSDirWriteFileOp.java:logAllocatedBlock(798)) - BLOCK* allocate blk_1073741834_1010, replicas=127.0.0.1:45491 for /simpleAppend.dat
2020-12-03 07:23:27,140 [IPC Server handler 5 on default port 37786] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistNewBlock(758)) - persistNewBlock: /simpleAppend.dat with new block blk_1073741834_1010, current total block count is 10
2020-12-03 07:23:27,141 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@3f28bd56] DEBUG datanode.DataNode (DataXceiver.java:<init>(154)) - Number of active connections is: 1
2020-12-03 07:23:27,149 [DataStreamer for file /simpleAppend.dat] INFO  sasl.SaslDataTransferClient (SaslDataTransferClient.java:checkTrustAndSend(239)) - SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
2020-12-03 07:23:27,150 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55066 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741834_1010]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(728)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-126688406_1
  block  =BP-1458564024-172.17.0.11-1606980200717:blk_1073741834_1010, newGs=0, bytesRcvd=[0, 0]
  targets=[]; pipelineSize=1, srcDataNode=:0, pinning=false
2020-12-03 07:23:27,150 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55066 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741834_1010]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(734)) - isDatanode=false, isClient=true, isTransfer=false
2020-12-03 07:23:27,150 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55066 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741834_1010]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(736)) - writeBlock receive buf size 531128 tcp no delay true
2020-12-03 07:23:27,151 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55066 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741834_1010]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(747)) - Receiving BP-1458564024-172.17.0.11-1606980200717:blk_1073741834_1010 src: /127.0.0.1:55066 dest: /127.0.0.1:45491
2020-12-03 07:23:27,151 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55066 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741834_1010]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1458564024-172.17.0.11-1606980200717:blk_1073741834_1010
 storageType=DISK, inAddr=/127.0.0.1:55066, myAddr=/127.0.0.1:45491
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-126688406_1, srcDataNode=:0, datanode=127.0.0.1:45491
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-bfd35249-c440-48e2-9558-cf86da199a4b
2020-12-03 07:23:27,151 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55066 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741834_1010]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1458564024-172.17.0.11-1606980200717/current/rbw/blk_1073741834 of size 0
2020-12-03 07:23:27,152 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55066 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741834_1010]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1458564024-172.17.0.11-1606980200717/current/rbw/blk_1073741834_1010.meta of size 0
2020-12-03 07:23:27,152 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741834_1010, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741834_1010, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-12-03 07:23:27,155 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55066 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741834_1010]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1458564024-172.17.0.11-1606980200717:blk_1073741834_1010: PacketHeader with packetLen=520 header data: offsetInBlock: 0
seqno: 20
lastPacketInBlock: false
dataLen: 512

2020-12-03 07:23:27,155 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55066 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741834_1010]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741834_1010, type=LAST_IN_PIPELINE: enqueue Packet(seqno=20, lastPacketInBlock=false, offsetInBlock=512, ackEnqueueNanoTime=141198930347825, ackStatus=SUCCESS)
2020-12-03 07:23:27,155 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55066 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741834_1010]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1458564024-172.17.0.11-1606980200717:blk_1073741834_1010: PacketHeader with packetLen=520 header data: offsetInBlock: 512
seqno: 21
lastPacketInBlock: false
dataLen: 512

2020-12-03 07:23:27,156 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55066 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741834_1010]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741834_1010, type=LAST_IN_PIPELINE: enqueue Packet(seqno=21, lastPacketInBlock=false, offsetInBlock=1024, ackEnqueueNanoTime=141198930983854, ackStatus=SUCCESS)
2020-12-03 07:23:27,162 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741834_1010, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741834_1010, type=LAST_IN_PIPELINE, replyAck=seqno: 20 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:27,163 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741834_1010, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741834_1010, type=LAST_IN_PIPELINE, replyAck=seqno: 21 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:27,163 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741834_1010, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741834_1010, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-12-03 07:23:27,165 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55066 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741834_1010]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1458564024-172.17.0.11-1606980200717:blk_1073741834_1010: PacketHeader with packetLen=4 header data: offsetInBlock: 1024
seqno: 22
lastPacketInBlock: true
dataLen: 0

2020-12-03 07:23:27,165 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55066 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741834_1010]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1458564024-172.17.0.11-1606980200717:blk_1073741834_1010
2020-12-03 07:23:27,165 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55066 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741834_1010]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741834_1010, type=LAST_IN_PIPELINE: enqueue Packet(seqno=22, lastPacketInBlock=true, offsetInBlock=1024, ackEnqueueNanoTime=141198940693599, ackStatus=SUCCESS)
2020-12-03 07:23:27,168 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741834_1010, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:55066, dest: /127.0.0.1:45491, bytes: 1024, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-126688406_1, offset: 0, srvID: 7455378e-99a9-49fc-9e03-4efd4d351125, blockid: BP-1458564024-172.17.0.11-1606980200717:blk_1073741834_1010, duration(ns): 14560929
2020-12-03 07:23:27,169 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741834_1010, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741834_1010, type=LAST_IN_PIPELINE, replyAck=seqno: 22 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:27,169 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741834_1010, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741834_1010, type=LAST_IN_PIPELINE terminating
2020-12-03 07:23:27,175 [IPC Server handler 8 on default port 37786] DEBUG hdfs.StateChange (FSNamesystem.java:getAdditionalBlock(2767)) - BLOCK* getAdditionalBlock: /simpleAppend.dat  inodeId 16386 for DFSClient_NONMAPREDUCE_-126688406_1
2020-12-03 07:23:27,182 [IPC Server handler 7 on default port 37786] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1627)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45491, datanodeUuid=7455378e-99a9-49fc-9e03-4efd4d351125, infoPort=33275, infoSecurePort=0, ipcPort=33659, storageInfo=lv=-57;cid=testClusterID;nsid=1892489455;c=1606980200717) 1 blocks.
2020-12-03 07:23:27,203 [IPC Server handler 8 on default port 37786] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addBlock(524)) - DIR* FSDirectory.addBlock: /simpleAppend.dat with blk_1073741835_1011 block is added to the in-memory file system
2020-12-03 07:23:27,203 [IPC Server handler 8 on default port 37786] INFO  hdfs.StateChange (FSDirWriteFileOp.java:logAllocatedBlock(798)) - BLOCK* allocate blk_1073741835_1011, replicas=127.0.0.1:45491 for /simpleAppend.dat
2020-12-03 07:23:27,204 [IPC Server handler 8 on default port 37786] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistNewBlock(758)) - persistNewBlock: /simpleAppend.dat with new block blk_1073741835_1011, current total block count is 11
2020-12-03 07:23:27,204 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(4021)) - Reported block blk_1073741834_1010 on 127.0.0.1:45491 size 1024 replicaState = FINALIZED
2020-12-03 07:23:27,204 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(4044)) - In memory blockUCState = COMMITTED
2020-12-03 07:23:27,204 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3351)) - BLOCK* addStoredBlock: 127.0.0.1:45491 is added to blk_1073741834_1010 (size=1024)
2020-12-03 07:23:27,177 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55066 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741834_1010]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741834_1010, type=LAST_IN_PIPELINE: closing
2020-12-03 07:23:27,205 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4154)) - BLOCK* block RECEIVED_BLOCK: blk_1073741834_1010 is received from 127.0.0.1:45491
2020-12-03 07:23:27,205 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4157)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45491 receiving: 0, received: 1, deleted: 0
2020-12-03 07:23:27,205 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55066 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741834_1010]] DEBUG datanode.DataNode (DataXceiver.java:run(328)) - 127.0.0.1:45491:Number of active connections is: 2
2020-12-03 07:23:27,206 [DataStreamer for file /simpleAppend.dat] INFO  sasl.SaslDataTransferClient (SaslDataTransferClient.java:checkTrustAndSend(239)) - SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
2020-12-03 07:23:27,207 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@3f28bd56] DEBUG datanode.DataNode (DataXceiver.java:<init>(154)) - Number of active connections is: 1
2020-12-03 07:23:27,208 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55090 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741835_1011]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(728)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-126688406_1
  block  =BP-1458564024-172.17.0.11-1606980200717:blk_1073741835_1011, newGs=0, bytesRcvd=[0, 0]
  targets=[]; pipelineSize=1, srcDataNode=:0, pinning=false
2020-12-03 07:23:27,208 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55090 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741835_1011]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(734)) - isDatanode=false, isClient=true, isTransfer=false
2020-12-03 07:23:27,208 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55090 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741835_1011]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(736)) - writeBlock receive buf size 531128 tcp no delay true
2020-12-03 07:23:27,209 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55090 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741835_1011]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(747)) - Receiving BP-1458564024-172.17.0.11-1606980200717:blk_1073741835_1011 src: /127.0.0.1:55090 dest: /127.0.0.1:45491
2020-12-03 07:23:27,209 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55090 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741835_1011]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1458564024-172.17.0.11-1606980200717:blk_1073741835_1011
 storageType=DISK, inAddr=/127.0.0.1:55090, myAddr=/127.0.0.1:45491
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-126688406_1, srcDataNode=:0, datanode=127.0.0.1:45491
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-bfd35249-c440-48e2-9558-cf86da199a4b
2020-12-03 07:23:27,209 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55090 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741835_1011]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-1458564024-172.17.0.11-1606980200717/current/rbw/blk_1073741835 of size 0
2020-12-03 07:23:27,210 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55090 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741835_1011]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-1458564024-172.17.0.11-1606980200717/current/rbw/blk_1073741835_1011.meta of size 0
2020-12-03 07:23:27,210 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741835_1011, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741835_1011, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-12-03 07:23:27,216 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55090 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741835_1011]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1458564024-172.17.0.11-1606980200717:blk_1073741835_1011: PacketHeader with packetLen=520 header data: offsetInBlock: 0
seqno: 23
lastPacketInBlock: false
dataLen: 512

2020-12-03 07:23:27,216 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55090 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741835_1011]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741835_1011, type=LAST_IN_PIPELINE: enqueue Packet(seqno=23, lastPacketInBlock=false, offsetInBlock=512, ackEnqueueNanoTime=141198991319349, ackStatus=SUCCESS)
2020-12-03 07:23:27,217 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55090 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741835_1011]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1458564024-172.17.0.11-1606980200717:blk_1073741835_1011: PacketHeader with packetLen=520 header data: offsetInBlock: 512
seqno: 24
lastPacketInBlock: false
dataLen: 512

2020-12-03 07:23:27,217 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55090 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741835_1011]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741835_1011, type=LAST_IN_PIPELINE: enqueue Packet(seqno=24, lastPacketInBlock=false, offsetInBlock=1024, ackEnqueueNanoTime=141198992606057, ackStatus=SUCCESS)
2020-12-03 07:23:27,218 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741835_1011, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741835_1011, type=LAST_IN_PIPELINE, replyAck=seqno: 23 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:27,219 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741835_1011, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741835_1011, type=LAST_IN_PIPELINE, replyAck=seqno: 24 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:27,219 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741835_1011, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741835_1011, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-12-03 07:23:27,226 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55090 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741835_1011]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1458564024-172.17.0.11-1606980200717:blk_1073741835_1011: PacketHeader with packetLen=4 header data: offsetInBlock: 1024
seqno: 25
lastPacketInBlock: true
dataLen: 0

2020-12-03 07:23:27,226 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55090 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741835_1011]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1458564024-172.17.0.11-1606980200717:blk_1073741835_1011
2020-12-03 07:23:27,226 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55090 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741835_1011]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741835_1011, type=LAST_IN_PIPELINE: enqueue Packet(seqno=25, lastPacketInBlock=true, offsetInBlock=1024, ackEnqueueNanoTime=141199001398142, ackStatus=SUCCESS)
2020-12-03 07:23:27,236 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741835_1011, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:55090, dest: /127.0.0.1:45491, bytes: 1024, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-126688406_1, offset: 0, srvID: 7455378e-99a9-49fc-9e03-4efd4d351125, blockid: BP-1458564024-172.17.0.11-1606980200717:blk_1073741835_1011, duration(ns): 20734789
2020-12-03 07:23:27,236 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741835_1011, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741835_1011, type=LAST_IN_PIPELINE, replyAck=seqno: 25 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:27,237 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741835_1011, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741835_1011, type=LAST_IN_PIPELINE terminating
2020-12-03 07:23:27,237 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55090 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741835_1011]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741835_1011, type=LAST_IN_PIPELINE: closing
2020-12-03 07:23:27,245 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55090 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741835_1011]] DEBUG datanode.DataNode (DataXceiver.java:run(328)) - 127.0.0.1:45491:Number of active connections is: 2
2020-12-03 07:23:27,245 [IPC Server handler 6 on default port 37786] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1627)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45491, datanodeUuid=7455378e-99a9-49fc-9e03-4efd4d351125, infoPort=33275, infoSecurePort=0, ipcPort=33659, storageInfo=lv=-57;cid=testClusterID;nsid=1892489455;c=1606980200717) 1 blocks.
2020-12-03 07:23:27,246 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(4021)) - Reported block blk_1073741835_1011 on 127.0.0.1:45491 size 1024 replicaState = FINALIZED
2020-12-03 07:23:27,246 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(4044)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-12-03 07:23:27,246 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3351)) - BLOCK* addStoredBlock: 127.0.0.1:45491 is added to blk_1073741835_1011 (size=0)
2020-12-03 07:23:27,246 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4154)) - BLOCK* block RECEIVED_BLOCK: blk_1073741835_1011 is received from 127.0.0.1:45491
2020-12-03 07:23:27,246 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4157)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45491 receiving: 0, received: 1, deleted: 0
2020-12-03 07:23:27,248 [IPC Server handler 9 on default port 37786] DEBUG hdfs.StateChange (FSNamesystem.java:getAdditionalBlock(2767)) - BLOCK* getAdditionalBlock: /simpleAppend.dat  inodeId 16386 for DFSClient_NONMAPREDUCE_-126688406_1
2020-12-03 07:23:27,250 [IPC Server handler 9 on default port 37786] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addBlock(524)) - DIR* FSDirectory.addBlock: /simpleAppend.dat with blk_1073741836_1012 block is added to the in-memory file system
2020-12-03 07:23:27,250 [IPC Server handler 9 on default port 37786] INFO  hdfs.StateChange (FSDirWriteFileOp.java:logAllocatedBlock(798)) - BLOCK* allocate blk_1073741836_1012, replicas=127.0.0.1:45491 for /simpleAppend.dat
2020-12-03 07:23:27,250 [IPC Server handler 9 on default port 37786] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistNewBlock(758)) - persistNewBlock: /simpleAppend.dat with new block blk_1073741836_1012, current total block count is 12
2020-12-03 07:23:27,255 [DataStreamer for file /simpleAppend.dat] INFO  sasl.SaslDataTransferClient (SaslDataTransferClient.java:checkTrustAndSend(239)) - SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
2020-12-03 07:23:27,257 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@3f28bd56] DEBUG datanode.DataNode (DataXceiver.java:<init>(154)) - Number of active connections is: 1
2020-12-03 07:23:27,259 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55108 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741836_1012]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(728)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-126688406_1
  block  =BP-1458564024-172.17.0.11-1606980200717:blk_1073741836_1012, newGs=0, bytesRcvd=[0, 0]
  targets=[]; pipelineSize=1, srcDataNode=:0, pinning=false
2020-12-03 07:23:27,259 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55108 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741836_1012]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(734)) - isDatanode=false, isClient=true, isTransfer=false
2020-12-03 07:23:27,259 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55108 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741836_1012]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(736)) - writeBlock receive buf size 531128 tcp no delay true
2020-12-03 07:23:27,259 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55108 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741836_1012]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(747)) - Receiving BP-1458564024-172.17.0.11-1606980200717:blk_1073741836_1012 src: /127.0.0.1:55108 dest: /127.0.0.1:45491
2020-12-03 07:23:27,259 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55108 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741836_1012]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1458564024-172.17.0.11-1606980200717:blk_1073741836_1012
 storageType=DISK, inAddr=/127.0.0.1:55108, myAddr=/127.0.0.1:45491
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-126688406_1, srcDataNode=:0, datanode=127.0.0.1:45491
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-bfd35249-c440-48e2-9558-cf86da199a4b
2020-12-03 07:23:27,260 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55108 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741836_1012]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1458564024-172.17.0.11-1606980200717/current/rbw/blk_1073741836 of size 0
2020-12-03 07:23:27,260 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55108 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741836_1012]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1458564024-172.17.0.11-1606980200717/current/rbw/blk_1073741836_1012.meta of size 0
2020-12-03 07:23:27,260 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741836_1012, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741836_1012, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-12-03 07:23:27,262 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55108 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741836_1012]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1458564024-172.17.0.11-1606980200717:blk_1073741836_1012: PacketHeader with packetLen=426 header data: offsetInBlock: 0
seqno: 26
lastPacketInBlock: false
dataLen: 418

2020-12-03 07:23:27,262 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55108 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741836_1012]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741836_1012, type=LAST_IN_PIPELINE: enqueue Packet(seqno=26, lastPacketInBlock=false, offsetInBlock=418, ackEnqueueNanoTime=141199037555631, ackStatus=SUCCESS)
2020-12-03 07:23:27,264 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741836_1012, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741836_1012, type=LAST_IN_PIPELINE, replyAck=seqno: 26 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:27,264 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741836_1012, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741836_1012, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-12-03 07:23:27,268 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55108 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741836_1012]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1458564024-172.17.0.11-1606980200717:blk_1073741836_1012: PacketHeader with packetLen=4 header data: offsetInBlock: 418
seqno: 27
lastPacketInBlock: true
dataLen: 0

2020-12-03 07:23:27,268 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55108 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741836_1012]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1458564024-172.17.0.11-1606980200717:blk_1073741836_1012
2020-12-03 07:23:27,268 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55108 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741836_1012]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741836_1012, type=LAST_IN_PIPELINE: enqueue Packet(seqno=27, lastPacketInBlock=true, offsetInBlock=418, ackEnqueueNanoTime=141199043766140, ackStatus=SUCCESS)
2020-12-03 07:23:27,271 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741836_1012, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:55108, dest: /127.0.0.1:45491, bytes: 418, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-126688406_1, offset: 0, srvID: 7455378e-99a9-49fc-9e03-4efd4d351125, blockid: BP-1458564024-172.17.0.11-1606980200717:blk_1073741836_1012, duration(ns): 9190767
2020-12-03 07:23:27,274 [IPC Server handler 1 on default port 37786] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1627)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45491, datanodeUuid=7455378e-99a9-49fc-9e03-4efd4d351125, infoPort=33275, infoSecurePort=0, ipcPort=33659, storageInfo=lv=-57;cid=testClusterID;nsid=1892489455;c=1606980200717) 1 blocks.
2020-12-03 07:23:27,274 [IPC Server handler 1 on default port 37786] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(674)) - DIR* NameSystem.completeFile: /simpleAppend.dat for DFSClient_NONMAPREDUCE_-126688406_1
2020-12-03 07:23:27,275 [IPC Server handler 1 on default port 37786] INFO  namenode.FSNamesystem (FSNamesystem.java:checkBlocksComplete(2995)) - BLOCK* blk_1073741836_1012 is COMMITTED but not COMPLETE(numNodes= 0 <  minimum = 1) in file /simpleAppend.dat
2020-12-03 07:23:27,275 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(4021)) - Reported block blk_1073741836_1012 on 127.0.0.1:45491 size 418 replicaState = FINALIZED
2020-12-03 07:23:27,275 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(4044)) - In memory blockUCState = COMMITTED
2020-12-03 07:23:27,276 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3351)) - BLOCK* addStoredBlock: 127.0.0.1:45491 is added to blk_1073741836_1012 (size=418)
2020-12-03 07:23:27,276 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4154)) - BLOCK* block RECEIVED_BLOCK: blk_1073741836_1012 is received from 127.0.0.1:45491
2020-12-03 07:23:27,276 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4157)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45491 receiving: 0, received: 1, deleted: 0
2020-12-03 07:23:27,277 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741836_1012, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741836_1012, type=LAST_IN_PIPELINE, replyAck=seqno: 27 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:27,277 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741836_1012, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741836_1012, type=LAST_IN_PIPELINE terminating
2020-12-03 07:23:27,277 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55108 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741836_1012]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741836_1012, type=LAST_IN_PIPELINE: closing
2020-12-03 07:23:27,281 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55108 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741836_1012]] DEBUG datanode.DataNode (DataXceiver.java:run(328)) - 127.0.0.1:45491:Number of active connections is: 2
2020-12-03 07:23:27,678 [IPC Server handler 2 on default port 37786] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(674)) - DIR* NameSystem.completeFile: /simpleAppend.dat for DFSClient_NONMAPREDUCE_-126688406_1
2020-12-03 07:23:27,679 [IPC Server handler 2 on default port 37786] DEBUG hdfs.StateChange (FSNamesystem.java:closeFile(4036)) - closeFile: /simpleAppend.dat with 12 blocks is persisted to the file system
2020-12-03 07:23:27,679 [IPC Server handler 2 on default port 37786] INFO  hdfs.StateChange (FSNamesystem.java:completeFile(2948)) - DIR* completeFile: /simpleAppend.dat is closed by DFSClient_NONMAPREDUCE_-126688406_1
Wrote and Closed second part of file.
2020-12-03 07:23:27,688 [IPC Server handler 3 on default port 37786] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8074)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=getfileinfo	src=/simpleAppend.dat	dst=null	perm=null	proto=rpc
2020-12-03 07:23:27,697 [IPC Server handler 4 on default port 37786] DEBUG blockmanagement.BlockManager (BlockManager.java:createLocatedBlocks(1433)) - blocks = [blk_1073741825_1001, blk_1073741826_1002, blk_1073741827_1003, blk_1073741828_1004, blk_1073741829_1005, blk_1073741830_1006, blk_1073741831_1007, blk_1073741832_1008, blk_1073741833_1009, blk_1073741834_1010, blk_1073741835_1011, blk_1073741836_1012]
2020-12-03 07:23:27,699 [IPC Server handler 4 on default port 37786] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8074)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=open	src=/simpleAppend.dat	dst=null	perm=null	proto=rpc
2020-12-03 07:23:27,720 [Listener at localhost/33659] DEBUG hdfs.DFSClient (DFSInputStream.java:fetchLocatedBlocksAndGetLastBlockLength(243)) - newInfo = LocatedBlocks{;  fileLength=10241;  underConstruction=false;  blocks=[LocatedBlock{BP-1458564024-172.17.0.11-1606980200717:blk_1073741825_1001; getBlockSize()=186; corrupt=false; offset=0; locs=[DatanodeInfoWithStorage[127.0.0.1:45491,DS-634fcf0b-cfbf-4df0-b7a1-9f98805233fb,DISK]]}, LocatedBlock{BP-1458564024-172.17.0.11-1606980200717:blk_1073741826_1002; getBlockSize()=421; corrupt=false; offset=186; locs=[DatanodeInfoWithStorage[127.0.0.1:45491,DS-bfd35249-c440-48e2-9558-cf86da199a4b,DISK]]}, LocatedBlock{BP-1458564024-172.17.0.11-1606980200717:blk_1073741827_1003; getBlockSize()=1024; corrupt=false; offset=607; locs=[DatanodeInfoWithStorage[127.0.0.1:45491,DS-634fcf0b-cfbf-4df0-b7a1-9f98805233fb,DISK]]}, LocatedBlock{BP-1458564024-172.17.0.11-1606980200717:blk_1073741828_1004; getBlockSize()=1024; corrupt=false; offset=1631; locs=[DatanodeInfoWithStorage[127.0.0.1:45491,DS-bfd35249-c440-48e2-9558-cf86da199a4b,DISK]]}, LocatedBlock{BP-1458564024-172.17.0.11-1606980200717:blk_1073741829_1005; getBlockSize()=1024; corrupt=false; offset=2655; locs=[DatanodeInfoWithStorage[127.0.0.1:45491,DS-634fcf0b-cfbf-4df0-b7a1-9f98805233fb,DISK]]}, LocatedBlock{BP-1458564024-172.17.0.11-1606980200717:blk_1073741830_1006; getBlockSize()=1024; corrupt=false; offset=3679; locs=[DatanodeInfoWithStorage[127.0.0.1:45491,DS-bfd35249-c440-48e2-9558-cf86da199a4b,DISK]]}, LocatedBlock{BP-1458564024-172.17.0.11-1606980200717:blk_1073741831_1007; getBlockSize()=1024; corrupt=false; offset=4703; locs=[DatanodeInfoWithStorage[127.0.0.1:45491,DS-634fcf0b-cfbf-4df0-b7a1-9f98805233fb,DISK]]}, LocatedBlock{BP-1458564024-172.17.0.11-1606980200717:blk_1073741832_1008; getBlockSize()=1024; corrupt=false; offset=5727; locs=[DatanodeInfoWithStorage[127.0.0.1:45491,DS-bfd35249-c440-48e2-9558-cf86da199a4b,DISK]]}, LocatedBlock{BP-1458564024-172.17.0.11-1606980200717:blk_1073741833_1009; getBlockSize()=1024; corrupt=false; offset=6751; locs=[DatanodeInfoWithStorage[127.0.0.1:45491,DS-634fcf0b-cfbf-4df0-b7a1-9f98805233fb,DISK]]}, LocatedBlock{BP-1458564024-172.17.0.11-1606980200717:blk_1073741834_1010; getBlockSize()=1024; corrupt=false; offset=7775; locs=[DatanodeInfoWithStorage[127.0.0.1:45491,DS-bfd35249-c440-48e2-9558-cf86da199a4b,DISK]]}, LocatedBlock{BP-1458564024-172.17.0.11-1606980200717:blk_1073741835_1011; getBlockSize()=1024; corrupt=false; offset=8799; locs=[DatanodeInfoWithStorage[127.0.0.1:45491,DS-634fcf0b-cfbf-4df0-b7a1-9f98805233fb,DISK]]}, LocatedBlock{BP-1458564024-172.17.0.11-1606980200717:blk_1073741836_1012; getBlockSize()=418; corrupt=false; offset=9823; locs=[DatanodeInfoWithStorage[127.0.0.1:45491,DS-bfd35249-c440-48e2-9558-cf86da199a4b,DISK]]}];  lastLocatedBlock=LocatedBlock{BP-1458564024-172.17.0.11-1606980200717:blk_1073741836_1012; getBlockSize()=418; corrupt=false; offset=9823; locs=[DatanodeInfoWithStorage[127.0.0.1:45491,DS-bfd35249-c440-48e2-9558-cf86da199a4b,DISK]]};  isLastBlockComplete=true;  ecPolicy=null}
2020-12-03 07:23:27,724 [Listener at localhost/33659] DEBUG hdfs.DFSClient (DFSInputStream.java:getBestNodeDNAddrPair(952)) - Connecting to datanode 127.0.0.1:45491
2020-12-03 07:23:27,731 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@3f28bd56] DEBUG datanode.DataNode (DataXceiver.java:<init>(154)) - Number of active connections is: 1
2020-12-03 07:23:27,742 [Listener at localhost/33659] INFO  sasl.SaslDataTransferClient (SaslDataTransferClient.java:checkTrustAndSend(239)) - SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
2020-12-03 07:23:27,774 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55242 [Sending block BP-1458564024-172.17.0.11-1606980200717:blk_1073741825_1001]] DEBUG datanode.DataNode (BlockSender.java:<init>(287)) - block=BP-1458564024-172.17.0.11-1606980200717:blk_1073741825_1001, replica=FinalizedReplica, blk_1073741825_1001, FINALIZED
  getNumBytes()     = 186
  getBytesOnDisk()  = 186
  getVisibleLength()= 186
  getVolume()       = /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1
  getBlockURI()     = file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-1458564024-172.17.0.11-1606980200717/current/finalized/subdir0/subdir0/blk_1073741825
2020-12-03 07:23:27,776 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55242 [Sending block BP-1458564024-172.17.0.11-1606980200717:blk_1073741825_1001]] DEBUG datanode.DataNode (BlockSender.java:<init>(427)) - replica=FinalizedReplica, blk_1073741825_1001, FINALIZED
  getNumBytes()     = 186
  getBytesOnDisk()  = 186
  getVisibleLength()= 186
  getVolume()       = /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1
  getBlockURI()     = file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-1458564024-172.17.0.11-1606980200717/current/finalized/subdir0/subdir0/blk_1073741825
2020-12-03 07:23:27,783 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55242 [Sending block BP-1458564024-172.17.0.11-1606980200717:blk_1073741825_1001]] DEBUG DataNode.clienttrace (BlockSender.java:doSendBlock(851)) - src: /127.0.0.1:45491, dest: /127.0.0.1:55242, bytes: 190, op: HDFS_READ, cliID: DFSClient_NONMAPREDUCE_-126688406_1, offset: 0, srvID: 7455378e-99a9-49fc-9e03-4efd4d351125, blockid: BP-1458564024-172.17.0.11-1606980200717:blk_1073741825_1001, duration(ns): 3731882
2020-12-03 07:23:27,789 [Listener at localhost/33659] DEBUG hdfs.DFSClient (DFSInputStream.java:getBestNodeDNAddrPair(952)) - Connecting to datanode 127.0.0.1:45491
2020-12-03 07:23:27,792 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55242 [Sending block BP-1458564024-172.17.0.11-1606980200717:blk_1073741826_1002]] DEBUG datanode.DataNode (BlockSender.java:<init>(287)) - block=BP-1458564024-172.17.0.11-1606980200717:blk_1073741826_1002, replica=FinalizedReplica, blk_1073741826_1002, FINALIZED
  getNumBytes()     = 421
  getBytesOnDisk()  = 421
  getVisibleLength()= 421
  getVolume()       = /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2
  getBlockURI()     = file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1458564024-172.17.0.11-1606980200717/current/finalized/subdir0/subdir0/blk_1073741826
2020-12-03 07:23:27,793 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55242 [Sending block BP-1458564024-172.17.0.11-1606980200717:blk_1073741826_1002]] DEBUG datanode.DataNode (BlockSender.java:<init>(427)) - replica=FinalizedReplica, blk_1073741826_1002, FINALIZED
  getNumBytes()     = 421
  getBytesOnDisk()  = 421
  getVisibleLength()= 421
  getVolume()       = /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2
  getBlockURI()     = file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1458564024-172.17.0.11-1606980200717/current/finalized/subdir0/subdir0/blk_1073741826
2020-12-03 07:23:27,794 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55242 [Sending block BP-1458564024-172.17.0.11-1606980200717:blk_1073741826_1002]] DEBUG DataNode.clienttrace (BlockSender.java:doSendBlock(851)) - src: /127.0.0.1:45491, dest: /127.0.0.1:55242, bytes: 425, op: HDFS_READ, cliID: DFSClient_NONMAPREDUCE_-126688406_1, offset: 0, srvID: 7455378e-99a9-49fc-9e03-4efd4d351125, blockid: BP-1458564024-172.17.0.11-1606980200717:blk_1073741826_1002, duration(ns): 467822
2020-12-03 07:23:27,794 [Listener at localhost/33659] DEBUG hdfs.DFSClient (DFSInputStream.java:getBestNodeDNAddrPair(952)) - Connecting to datanode 127.0.0.1:45491
2020-12-03 07:23:27,797 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55242 [Sending block BP-1458564024-172.17.0.11-1606980200717:blk_1073741827_1003]] DEBUG datanode.DataNode (BlockSender.java:<init>(287)) - block=BP-1458564024-172.17.0.11-1606980200717:blk_1073741827_1003, replica=FinalizedReplica, blk_1073741827_1003, FINALIZED
  getNumBytes()     = 1024
  getBytesOnDisk()  = 1024
  getVisibleLength()= 1024
  getVolume()       = /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1
  getBlockURI()     = file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-1458564024-172.17.0.11-1606980200717/current/finalized/subdir0/subdir0/blk_1073741827
2020-12-03 07:23:27,798 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55242 [Sending block BP-1458564024-172.17.0.11-1606980200717:blk_1073741827_1003]] DEBUG datanode.DataNode (BlockSender.java:<init>(427)) - replica=FinalizedReplica, blk_1073741827_1003, FINALIZED
  getNumBytes()     = 1024
  getBytesOnDisk()  = 1024
  getVisibleLength()= 1024
  getVolume()       = /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1
  getBlockURI()     = file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-1458564024-172.17.0.11-1606980200717/current/finalized/subdir0/subdir0/blk_1073741827
2020-12-03 07:23:27,799 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55242 [Sending block BP-1458564024-172.17.0.11-1606980200717:blk_1073741827_1003]] DEBUG DataNode.clienttrace (BlockSender.java:doSendBlock(851)) - src: /127.0.0.1:45491, dest: /127.0.0.1:55242, bytes: 1032, op: HDFS_READ, cliID: DFSClient_NONMAPREDUCE_-126688406_1, offset: 0, srvID: 7455378e-99a9-49fc-9e03-4efd4d351125, blockid: BP-1458564024-172.17.0.11-1606980200717:blk_1073741827_1003, duration(ns): 458678
2020-12-03 07:23:27,799 [Listener at localhost/33659] DEBUG hdfs.DFSClient (DFSInputStream.java:getBestNodeDNAddrPair(952)) - Connecting to datanode 127.0.0.1:45491
2020-12-03 07:23:27,811 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55242 [Sending block BP-1458564024-172.17.0.11-1606980200717:blk_1073741828_1004]] DEBUG datanode.DataNode (BlockSender.java:<init>(287)) - block=BP-1458564024-172.17.0.11-1606980200717:blk_1073741828_1004, replica=FinalizedReplica, blk_1073741828_1004, FINALIZED
  getNumBytes()     = 1024
  getBytesOnDisk()  = 1024
  getVisibleLength()= 1024
  getVolume()       = /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2
  getBlockURI()     = file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1458564024-172.17.0.11-1606980200717/current/finalized/subdir0/subdir0/blk_1073741828
2020-12-03 07:23:27,811 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55242 [Sending block BP-1458564024-172.17.0.11-1606980200717:blk_1073741828_1004]] DEBUG datanode.DataNode (BlockSender.java:<init>(427)) - replica=FinalizedReplica, blk_1073741828_1004, FINALIZED
  getNumBytes()     = 1024
  getBytesOnDisk()  = 1024
  getVisibleLength()= 1024
  getVolume()       = /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2
  getBlockURI()     = file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1458564024-172.17.0.11-1606980200717/current/finalized/subdir0/subdir0/blk_1073741828
2020-12-03 07:23:27,813 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55242 [Sending block BP-1458564024-172.17.0.11-1606980200717:blk_1073741828_1004]] DEBUG DataNode.clienttrace (BlockSender.java:doSendBlock(851)) - src: /127.0.0.1:45491, dest: /127.0.0.1:55242, bytes: 1032, op: HDFS_READ, cliID: DFSClient_NONMAPREDUCE_-126688406_1, offset: 0, srvID: 7455378e-99a9-49fc-9e03-4efd4d351125, blockid: BP-1458564024-172.17.0.11-1606980200717:blk_1073741828_1004, duration(ns): 517582
2020-12-03 07:23:27,813 [Listener at localhost/33659] DEBUG hdfs.DFSClient (DFSInputStream.java:getBestNodeDNAddrPair(952)) - Connecting to datanode 127.0.0.1:45491
2020-12-03 07:23:27,818 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55242 [Sending block BP-1458564024-172.17.0.11-1606980200717:blk_1073741829_1005]] DEBUG datanode.DataNode (BlockSender.java:<init>(287)) - block=BP-1458564024-172.17.0.11-1606980200717:blk_1073741829_1005, replica=FinalizedReplica, blk_1073741829_1005, FINALIZED
  getNumBytes()     = 1024
  getBytesOnDisk()  = 1024
  getVisibleLength()= 1024
  getVolume()       = /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1
  getBlockURI()     = file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-1458564024-172.17.0.11-1606980200717/current/finalized/subdir0/subdir0/blk_1073741829
2020-12-03 07:23:27,818 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55242 [Sending block BP-1458564024-172.17.0.11-1606980200717:blk_1073741829_1005]] DEBUG datanode.DataNode (BlockSender.java:<init>(427)) - replica=FinalizedReplica, blk_1073741829_1005, FINALIZED
  getNumBytes()     = 1024
  getBytesOnDisk()  = 1024
  getVisibleLength()= 1024
  getVolume()       = /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1
  getBlockURI()     = file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-1458564024-172.17.0.11-1606980200717/current/finalized/subdir0/subdir0/blk_1073741829
2020-12-03 07:23:27,819 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55242 [Sending block BP-1458564024-172.17.0.11-1606980200717:blk_1073741829_1005]] DEBUG DataNode.clienttrace (BlockSender.java:doSendBlock(851)) - src: /127.0.0.1:45491, dest: /127.0.0.1:55242, bytes: 1032, op: HDFS_READ, cliID: DFSClient_NONMAPREDUCE_-126688406_1, offset: 0, srvID: 7455378e-99a9-49fc-9e03-4efd4d351125, blockid: BP-1458564024-172.17.0.11-1606980200717:blk_1073741829_1005, duration(ns): 452327
2020-12-03 07:23:27,820 [Listener at localhost/33659] DEBUG hdfs.DFSClient (DFSInputStream.java:getBestNodeDNAddrPair(952)) - Connecting to datanode 127.0.0.1:45491
2020-12-03 07:23:27,831 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55242 [Sending block BP-1458564024-172.17.0.11-1606980200717:blk_1073741830_1006]] DEBUG datanode.DataNode (BlockSender.java:<init>(287)) - block=BP-1458564024-172.17.0.11-1606980200717:blk_1073741830_1006, replica=FinalizedReplica, blk_1073741830_1006, FINALIZED
  getNumBytes()     = 1024
  getBytesOnDisk()  = 1024
  getVisibleLength()= 1024
  getVolume()       = /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2
  getBlockURI()     = file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1458564024-172.17.0.11-1606980200717/current/finalized/subdir0/subdir0/blk_1073741830
2020-12-03 07:23:27,831 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55242 [Sending block BP-1458564024-172.17.0.11-1606980200717:blk_1073741830_1006]] DEBUG datanode.DataNode (BlockSender.java:<init>(427)) - replica=FinalizedReplica, blk_1073741830_1006, FINALIZED
  getNumBytes()     = 1024
  getBytesOnDisk()  = 1024
  getVisibleLength()= 1024
  getVolume()       = /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2
  getBlockURI()     = file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1458564024-172.17.0.11-1606980200717/current/finalized/subdir0/subdir0/blk_1073741830
2020-12-03 07:23:27,832 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55242 [Sending block BP-1458564024-172.17.0.11-1606980200717:blk_1073741830_1006]] DEBUG DataNode.clienttrace (BlockSender.java:doSendBlock(851)) - src: /127.0.0.1:45491, dest: /127.0.0.1:55242, bytes: 1032, op: HDFS_READ, cliID: DFSClient_NONMAPREDUCE_-126688406_1, offset: 0, srvID: 7455378e-99a9-49fc-9e03-4efd4d351125, blockid: BP-1458564024-172.17.0.11-1606980200717:blk_1073741830_1006, duration(ns): 401879
2020-12-03 07:23:27,832 [Listener at localhost/33659] DEBUG hdfs.DFSClient (DFSInputStream.java:getBestNodeDNAddrPair(952)) - Connecting to datanode 127.0.0.1:45491
2020-12-03 07:23:27,841 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55242 [Sending block BP-1458564024-172.17.0.11-1606980200717:blk_1073741831_1007]] DEBUG datanode.DataNode (BlockSender.java:<init>(287)) - block=BP-1458564024-172.17.0.11-1606980200717:blk_1073741831_1007, replica=FinalizedReplica, blk_1073741831_1007, FINALIZED
  getNumBytes()     = 1024
  getBytesOnDisk()  = 1024
  getVisibleLength()= 1024
  getVolume()       = /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1
  getBlockURI()     = file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-1458564024-172.17.0.11-1606980200717/current/finalized/subdir0/subdir0/blk_1073741831
2020-12-03 07:23:27,841 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55242 [Sending block BP-1458564024-172.17.0.11-1606980200717:blk_1073741831_1007]] DEBUG datanode.DataNode (BlockSender.java:<init>(427)) - replica=FinalizedReplica, blk_1073741831_1007, FINALIZED
  getNumBytes()     = 1024
  getBytesOnDisk()  = 1024
  getVisibleLength()= 1024
  getVolume()       = /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1
  getBlockURI()     = file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-1458564024-172.17.0.11-1606980200717/current/finalized/subdir0/subdir0/blk_1073741831
2020-12-03 07:23:27,842 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55242 [Sending block BP-1458564024-172.17.0.11-1606980200717:blk_1073741831_1007]] DEBUG DataNode.clienttrace (BlockSender.java:doSendBlock(851)) - src: /127.0.0.1:45491, dest: /127.0.0.1:55242, bytes: 1032, op: HDFS_READ, cliID: DFSClient_NONMAPREDUCE_-126688406_1, offset: 0, srvID: 7455378e-99a9-49fc-9e03-4efd4d351125, blockid: BP-1458564024-172.17.0.11-1606980200717:blk_1073741831_1007, duration(ns): 427574
2020-12-03 07:23:27,845 [Listener at localhost/33659] DEBUG hdfs.DFSClient (DFSInputStream.java:getBestNodeDNAddrPair(952)) - Connecting to datanode 127.0.0.1:45491
2020-12-03 07:23:27,866 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55242 [Sending block BP-1458564024-172.17.0.11-1606980200717:blk_1073741832_1008]] DEBUG datanode.DataNode (BlockSender.java:<init>(287)) - block=BP-1458564024-172.17.0.11-1606980200717:blk_1073741832_1008, replica=FinalizedReplica, blk_1073741832_1008, FINALIZED
  getNumBytes()     = 1024
  getBytesOnDisk()  = 1024
  getVisibleLength()= 1024
  getVolume()       = /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2
  getBlockURI()     = file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1458564024-172.17.0.11-1606980200717/current/finalized/subdir0/subdir0/blk_1073741832
2020-12-03 07:23:27,869 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55242 [Sending block BP-1458564024-172.17.0.11-1606980200717:blk_1073741832_1008]] DEBUG datanode.DataNode (BlockSender.java:<init>(427)) - replica=FinalizedReplica, blk_1073741832_1008, FINALIZED
  getNumBytes()     = 1024
  getBytesOnDisk()  = 1024
  getVisibleLength()= 1024
  getVolume()       = /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2
  getBlockURI()     = file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1458564024-172.17.0.11-1606980200717/current/finalized/subdir0/subdir0/blk_1073741832
2020-12-03 07:23:27,870 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55242 [Sending block BP-1458564024-172.17.0.11-1606980200717:blk_1073741832_1008]] DEBUG DataNode.clienttrace (BlockSender.java:doSendBlock(851)) - src: /127.0.0.1:45491, dest: /127.0.0.1:55242, bytes: 1032, op: HDFS_READ, cliID: DFSClient_NONMAPREDUCE_-126688406_1, offset: 0, srvID: 7455378e-99a9-49fc-9e03-4efd4d351125, blockid: BP-1458564024-172.17.0.11-1606980200717:blk_1073741832_1008, duration(ns): 447466
2020-12-03 07:23:27,871 [Listener at localhost/33659] DEBUG hdfs.DFSClient (DFSInputStream.java:getBestNodeDNAddrPair(952)) - Connecting to datanode 127.0.0.1:45491
2020-12-03 07:23:27,873 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55242 [Sending block BP-1458564024-172.17.0.11-1606980200717:blk_1073741833_1009]] DEBUG datanode.DataNode (BlockSender.java:<init>(287)) - block=BP-1458564024-172.17.0.11-1606980200717:blk_1073741833_1009, replica=FinalizedReplica, blk_1073741833_1009, FINALIZED
  getNumBytes()     = 1024
  getBytesOnDisk()  = 1024
  getVisibleLength()= 1024
  getVolume()       = /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1
  getBlockURI()     = file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-1458564024-172.17.0.11-1606980200717/current/finalized/subdir0/subdir0/blk_1073741833
2020-12-03 07:23:27,874 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55242 [Sending block BP-1458564024-172.17.0.11-1606980200717:blk_1073741833_1009]] DEBUG datanode.DataNode (BlockSender.java:<init>(427)) - replica=FinalizedReplica, blk_1073741833_1009, FINALIZED
  getNumBytes()     = 1024
  getBytesOnDisk()  = 1024
  getVisibleLength()= 1024
  getVolume()       = /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1
  getBlockURI()     = file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-1458564024-172.17.0.11-1606980200717/current/finalized/subdir0/subdir0/blk_1073741833
2020-12-03 07:23:27,875 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55242 [Sending block BP-1458564024-172.17.0.11-1606980200717:blk_1073741833_1009]] DEBUG DataNode.clienttrace (BlockSender.java:doSendBlock(851)) - src: /127.0.0.1:45491, dest: /127.0.0.1:55242, bytes: 1032, op: HDFS_READ, cliID: DFSClient_NONMAPREDUCE_-126688406_1, offset: 0, srvID: 7455378e-99a9-49fc-9e03-4efd4d351125, blockid: BP-1458564024-172.17.0.11-1606980200717:blk_1073741833_1009, duration(ns): 461947
2020-12-03 07:23:27,877 [Listener at localhost/33659] DEBUG hdfs.DFSClient (DFSInputStream.java:getBestNodeDNAddrPair(952)) - Connecting to datanode 127.0.0.1:45491
2020-12-03 07:23:27,886 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55242 [Sending block BP-1458564024-172.17.0.11-1606980200717:blk_1073741834_1010]] DEBUG datanode.DataNode (BlockSender.java:<init>(287)) - block=BP-1458564024-172.17.0.11-1606980200717:blk_1073741834_1010, replica=FinalizedReplica, blk_1073741834_1010, FINALIZED
  getNumBytes()     = 1024
  getBytesOnDisk()  = 1024
  getVisibleLength()= 1024
  getVolume()       = /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2
  getBlockURI()     = file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1458564024-172.17.0.11-1606980200717/current/finalized/subdir0/subdir0/blk_1073741834
2020-12-03 07:23:27,886 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55242 [Sending block BP-1458564024-172.17.0.11-1606980200717:blk_1073741834_1010]] DEBUG datanode.DataNode (BlockSender.java:<init>(427)) - replica=FinalizedReplica, blk_1073741834_1010, FINALIZED
  getNumBytes()     = 1024
  getBytesOnDisk()  = 1024
  getVisibleLength()= 1024
  getVolume()       = /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2
  getBlockURI()     = file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1458564024-172.17.0.11-1606980200717/current/finalized/subdir0/subdir0/blk_1073741834
2020-12-03 07:23:27,887 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55242 [Sending block BP-1458564024-172.17.0.11-1606980200717:blk_1073741834_1010]] DEBUG DataNode.clienttrace (BlockSender.java:doSendBlock(851)) - src: /127.0.0.1:45491, dest: /127.0.0.1:55242, bytes: 1032, op: HDFS_READ, cliID: DFSClient_NONMAPREDUCE_-126688406_1, offset: 0, srvID: 7455378e-99a9-49fc-9e03-4efd4d351125, blockid: BP-1458564024-172.17.0.11-1606980200717:blk_1073741834_1010, duration(ns): 457359
2020-12-03 07:23:27,887 [Listener at localhost/33659] DEBUG hdfs.DFSClient (DFSInputStream.java:getBestNodeDNAddrPair(952)) - Connecting to datanode 127.0.0.1:45491
2020-12-03 07:23:27,890 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55242 [Sending block BP-1458564024-172.17.0.11-1606980200717:blk_1073741835_1011]] DEBUG datanode.DataNode (BlockSender.java:<init>(287)) - block=BP-1458564024-172.17.0.11-1606980200717:blk_1073741835_1011, replica=FinalizedReplica, blk_1073741835_1011, FINALIZED
  getNumBytes()     = 1024
  getBytesOnDisk()  = 1024
  getVisibleLength()= 1024
  getVolume()       = /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1
  getBlockURI()     = file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-1458564024-172.17.0.11-1606980200717/current/finalized/subdir0/subdir0/blk_1073741835
2020-12-03 07:23:27,893 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55242 [Sending block BP-1458564024-172.17.0.11-1606980200717:blk_1073741835_1011]] DEBUG datanode.DataNode (BlockSender.java:<init>(427)) - replica=FinalizedReplica, blk_1073741835_1011, FINALIZED
  getNumBytes()     = 1024
  getBytesOnDisk()  = 1024
  getVisibleLength()= 1024
  getVolume()       = /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1
  getBlockURI()     = file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-1458564024-172.17.0.11-1606980200717/current/finalized/subdir0/subdir0/blk_1073741835
2020-12-03 07:23:27,894 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55242 [Sending block BP-1458564024-172.17.0.11-1606980200717:blk_1073741835_1011]] DEBUG DataNode.clienttrace (BlockSender.java:doSendBlock(851)) - src: /127.0.0.1:45491, dest: /127.0.0.1:55242, bytes: 1032, op: HDFS_READ, cliID: DFSClient_NONMAPREDUCE_-126688406_1, offset: 0, srvID: 7455378e-99a9-49fc-9e03-4efd4d351125, blockid: BP-1458564024-172.17.0.11-1606980200717:blk_1073741835_1011, duration(ns): 473782
2020-12-03 07:23:27,895 [Listener at localhost/33659] DEBUG hdfs.DFSClient (DFSInputStream.java:getBestNodeDNAddrPair(952)) - Connecting to datanode 127.0.0.1:45491
2020-12-03 07:23:27,896 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55242 [Sending block BP-1458564024-172.17.0.11-1606980200717:blk_1073741836_1012]] DEBUG datanode.DataNode (BlockSender.java:<init>(287)) - block=BP-1458564024-172.17.0.11-1606980200717:blk_1073741836_1012, replica=FinalizedReplica, blk_1073741836_1012, FINALIZED
  getNumBytes()     = 418
  getBytesOnDisk()  = 418
  getVisibleLength()= 418
  getVolume()       = /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2
  getBlockURI()     = file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1458564024-172.17.0.11-1606980200717/current/finalized/subdir0/subdir0/blk_1073741836
2020-12-03 07:23:27,897 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55242 [Sending block BP-1458564024-172.17.0.11-1606980200717:blk_1073741836_1012]] DEBUG datanode.DataNode (BlockSender.java:<init>(427)) - replica=FinalizedReplica, blk_1073741836_1012, FINALIZED
  getNumBytes()     = 418
  getBytesOnDisk()  = 418
  getVisibleLength()= 418
  getVolume()       = /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2
  getBlockURI()     = file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1458564024-172.17.0.11-1606980200717/current/finalized/subdir0/subdir0/blk_1073741836
2020-12-03 07:23:27,897 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55242 [Sending block BP-1458564024-172.17.0.11-1606980200717:blk_1073741836_1012]] DEBUG DataNode.clienttrace (BlockSender.java:doSendBlock(851)) - src: /127.0.0.1:45491, dest: /127.0.0.1:55242, bytes: 422, op: HDFS_READ, cliID: DFSClient_NONMAPREDUCE_-126688406_1, offset: 0, srvID: 7455378e-99a9-49fc-9e03-4efd4d351125, blockid: BP-1458564024-172.17.0.11-1606980200717:blk_1073741836_1012, duration(ns): 283799
2020-12-03 07:23:27,924 [IPC Server handler 5 on default port 37786] DEBUG blockmanagement.BlockManager (BlockManager.java:createLocatedBlocks(1433)) - blocks = [blk_1073741825_1001, blk_1073741826_1002, blk_1073741827_1003, blk_1073741828_1004, blk_1073741829_1005, blk_1073741830_1006, blk_1073741831_1007, blk_1073741832_1008, blk_1073741833_1009, blk_1073741834_1010, blk_1073741835_1011, blk_1073741836_1012]
2020-12-03 07:23:27,926 [IPC Server handler 5 on default port 37786] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8074)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=open	src=/simpleAppend.dat	dst=null	perm=null	proto=rpc
2020-12-03 07:23:27,937 [IPC Server handler 7 on default port 37786] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(809)) - *DIR* NameNode.append: file /non-existing.dat for DFSClient_NONMAPREDUCE_-126688406_1 at 127.0.0.1
2020-12-03 07:23:27,937 [IPC Server handler 7 on default port 37786] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2710)) - DIR* NameSystem.appendFile: src=/non-existing.dat, holder=DFSClient_NONMAPREDUCE_-126688406_1, clientMachine=127.0.0.1
2020-12-03 07:23:27,938 [IPC Server handler 7 on default port 37786] WARN  hdfs.StateChange (FSDirAppendOp.java:appendFile(145)) - DIR* NameSystem.append: Failed to append to non-existent file /non-existing.dat for client 127.0.0.1
2020-12-03 07:23:27,938 [IPC Server handler 7 on default port 37786] INFO  ipc.Server (Server.java:logException(2969)) - IPC Server handler 7 on default port 37786, call Call#46 Retry#0 org.apache.hadoop.hdfs.protocol.ClientProtocol.append from 127.0.0.1:46350: java.io.FileNotFoundException: Failed to append to non-existent file /non-existing.dat for client 127.0.0.1
Good: got java.io.FileNotFoundException: Failed to append to non-existent file /non-existing.dat for client 127.0.0.1
	at org.apache.hadoop.hdfs.server.namenode.FSDirAppendOp.appendFile(FSDirAppendOp.java:104)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.appendFile(FSNamesystem.java:2722)
	at org.apache.hadoop.hdfs.server.namenode.NameNodeRpcServer.append(NameNodeRpcServer.java:822)
	at org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolServerSideTranslatorPB.append(ClientNamenodeProtocolServerSideTranslatorPB.java:500)
	at org.apache.hadoop.hdfs.protocol.proto.ClientNamenodeProtocolProtos$ClientNamenodeProtocol$2.callBlockingMethod(ClientNamenodeProtocolProtos.java)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine.java:528)
	at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:1070)
	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:999)
	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:927)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1730)
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2915)

java.io.FileNotFoundException: Failed to append to non-existent file /non-existing.dat for client 127.0.0.1
	at org.apache.hadoop.hdfs.server.namenode.FSDirAppendOp.appendFile(FSDirAppendOp.java:104)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.appendFile(FSNamesystem.java:2722)
	at org.apache.hadoop.hdfs.server.namenode.NameNodeRpcServer.append(NameNodeRpcServer.java:822)
	at org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolServerSideTranslatorPB.append(ClientNamenodeProtocolServerSideTranslatorPB.java:500)
	at org.apache.hadoop.hdfs.protocol.proto.ClientNamenodeProtocolProtos$ClientNamenodeProtocol$2.callBlockingMethod(ClientNamenodeProtocolProtos.java)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine.java:528)
	at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:1070)
	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:999)
	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:927)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1730)
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2915)

	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.hadoop.ipc.RemoteException.instantiateException(RemoteException.java:121)
	at org.apache.hadoop.ipc.RemoteException.unwrapRemoteException(RemoteException.java:88)
	at org.apache.hadoop.hdfs.DFSClient.callAppend(DFSClient.java:1362)
	at org.apache.hadoop.hdfs.DFSClient.append(DFSClient.java:1419)
	at org.apache.hadoop.hdfs.DFSClient.append(DFSClient.java:1389)
	at org.apache.hadoop.hdfs.DistributedFileSystem$5.doCall(DistributedFileSystem.java:420)
	at org.apache.hadoop.hdfs.DistributedFileSystem$5.doCall(DistributedFileSystem.java:416)
	at org.apache.hadoop.fs.FileSystemLinkResolver.resolve(FileSystemLinkResolver.java:81)
	at org.apache.hadoop.hdfs.DistributedFileSystem.append(DistributedFileSystem.java:428)
	at org.apache.hadoop.hdfs.TestFileAppend2.testSimpleAppend2(TestFileAppend2.java:289)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
Caused by: org.apache.hadoop.ipc.RemoteException(java.io.FileNotFoundException): Failed to append to non-existent file /non-existing.dat for client 127.0.0.1
	at org.apache.hadoop.hdfs.server.namenode.FSDirAppendOp.appendFile(FSDirAppendOp.java:104)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.appendFile(FSNamesystem.java:2722)
	at org.apache.hadoop.hdfs.server.namenode.NameNodeRpcServer.append(NameNodeRpcServer.java:822)
	at org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolServerSideTranslatorPB.append(ClientNamenodeProtocolServerSideTranslatorPB.java:500)
	at org.apache.hadoop.hdfs.protocol.proto.ClientNamenodeProtocolProtos$ClientNamenodeProtocol$2.callBlockingMethod(ClientNamenodeProtocolProtos.java)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine.java:528)
	at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:1070)
	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:999)
	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:927)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1730)
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2915)

	at org.apache.hadoop.ipc.Client.getRpcResponse(Client.java:1545)
	at org.apache.hadoop.ipc.Client.call(Client.java:1491)
	at org.apache.hadoop.ipc.Client.call(Client.java:1388)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:233)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:118)
	at com.sun.proxy.$Proxy23.append(Unknown Source)
	at org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolTranslatorPB.append(ClientNamenodeProtocolTranslatorPB.java:400)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.io.retry.RetryInvocationHandler.invokeMethod(RetryInvocationHandler.java:422)
	at org.apache.hadoop.io.retry.RetryInvocationHandler$Call.invokeMethod(RetryInvocationHandler.java:165)
	at org.apache.hadoop.io.retry.RetryInvocationHandler$Call.invoke(RetryInvocationHandler.java:157)
	at org.apache.hadoop.io.retry.RetryInvocationHandler$Call.invokeOnce(RetryInvocationHandler.java:95)
	at org.apache.hadoop.io.retry.RetryInvocationHandler.invoke(RetryInvocationHandler.java:359)
	at com.sun.proxy.$Proxy24.append(Unknown Source)
	at org.apache.hadoop.hdfs.DFSClient.callAppend(DFSClient.java:1328)
	at org.apache.hadoop.hdfs.DFSClient.callAppend(DFSClient.java:1350)
	... 32 more
2020-12-03 07:23:27,964 [IPC Server handler 8 on default port 37786] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8074)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=setPermission	src=/	dst=null	perm=root:supergroup:rwxrwxrwx	proto=rpc
2020-12-03 07:23:27,979 [Listener at localhost/33659] DEBUG hdfs.DFSClient (DFSClient.java:<init>(318)) - Sets dfs.client.block.write.replace-datanode-on-failure.min-replication to 0
2020-12-03 07:23:27,980 [Listener at localhost/33659] DEBUG hdfs.DFSClient (DFSClient.java:create(1216)) - /TestFileAppend2/foo.dat: masked={ masked: rw-r--r--, unmasked: rw-rw-rw- }
2020-12-03 07:23:28,002 [IPC Server handler 6 on default port 37786] DEBUG hdfs.StateChange (NameNodeRpcServer.java:create(774)) - *DIR* NameNode.create: file /TestFileAppend2/foo.dat for DFSClient_NONMAPREDUCE_-1260317844_1 at 127.0.0.1
2020-12-03 07:23:28,002 [IPC Server handler 6 on default port 37786] DEBUG hdfs.StateChange (FSNamesystem.java:startFileInt(2460)) - DIR* NameSystem.startFile: src=/TestFileAppend2/foo.dat, holder=DFSClient_NONMAPREDUCE_-1260317844_1, clientMachine=127.0.0.1, createParent=true, replication=1, createFlag=[CREATE, OVERWRITE], blockSize=134217728, supportedVersions=[CryptoProtocolVersion{description='Encryption zones', version=2, unknownValue=null}]
2020-12-03 07:23:28,004 [IPC Server handler 6 on default port 37786] DEBUG hdfs.StateChange (FSDirMkdirOp.java:createSingleDirectory(182)) - mkdirs: created directory /TestFileAppend2
2020-12-03 07:23:28,005 [IPC Server handler 6 on default port 37786] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addFile(579)) - DIR* addFile: foo.dat is added
2020-12-03 07:23:28,005 [IPC Server handler 6 on default port 37786] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:startFile(415)) - DIR* NameSystem.startFile: added /TestFileAppend2/foo.dat inode 16388 DFSClient_NONMAPREDUCE_-1260317844_1
2020-12-03 07:23:28,006 [IPC Server handler 6 on default port 37786] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8074)) - allowed=true	ugi=testappenduser (auth:SIMPLE)	ip=/127.0.0.1	cmd=create	src=/TestFileAppend2/foo.dat	dst=null	perm=testappenduser:supergroup:rw-r--r--	proto=rpc
2020-12-03 07:23:28,008 [Listener at localhost/33659] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/TestFileAppend2/foo.dat, chunkSize=516, chunksPerPacket=126, packetSize=65016
2020-12-03 07:23:28,009 [Listener at localhost/33659] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=0, src=/TestFileAppend2/foo.dat, packetSize=65016, chunksPerPacket=126, bytesCurBlock=0, DFSOutputStream:block==null
2020-12-03 07:23:28,017 [IPC Server handler 9 on default port 37786] DEBUG hdfs.StateChange (FSNamesystem.java:getAdditionalBlock(2767)) - BLOCK* getAdditionalBlock: /TestFileAppend2/foo.dat  inodeId 16388 for DFSClient_NONMAPREDUCE_-1260317844_1
2020-12-03 07:23:28,018 [IPC Server handler 9 on default port 37786] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addBlock(524)) - DIR* FSDirectory.addBlock: /TestFileAppend2/foo.dat with blk_1073741837_1013 block is added to the in-memory file system
2020-12-03 07:23:28,019 [IPC Server handler 9 on default port 37786] INFO  hdfs.StateChange (FSDirWriteFileOp.java:logAllocatedBlock(798)) - BLOCK* allocate blk_1073741837_1013, replicas=127.0.0.1:45491 for /TestFileAppend2/foo.dat
2020-12-03 07:23:28,019 [IPC Server handler 9 on default port 37786] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistNewBlock(758)) - persistNewBlock: /TestFileAppend2/foo.dat with new block blk_1073741837_1013, current total block count is 1
2020-12-03 07:23:28,024 [Thread-169] INFO  sasl.SaslDataTransferClient (SaslDataTransferClient.java:checkTrustAndSend(239)) - SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
2020-12-03 07:23:28,024 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@3f28bd56] DEBUG datanode.DataNode (DataXceiver.java:<init>(154)) - Number of active connections is: 2
2020-12-03 07:23:28,034 [DataXceiver for client DFSClient_NONMAPREDUCE_-1260317844_1 at /127.0.0.1:55302 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741837_1013]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(728)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-1260317844_1
  block  =BP-1458564024-172.17.0.11-1606980200717:blk_1073741837_1013, newGs=0, bytesRcvd=[0, 0]
  targets=[]; pipelineSize=1, srcDataNode=:0, pinning=false
2020-12-03 07:23:28,034 [DataXceiver for client DFSClient_NONMAPREDUCE_-1260317844_1 at /127.0.0.1:55302 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741837_1013]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(734)) - isDatanode=false, isClient=true, isTransfer=false
2020-12-03 07:23:28,034 [DataXceiver for client DFSClient_NONMAPREDUCE_-1260317844_1 at /127.0.0.1:55302 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741837_1013]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(736)) - writeBlock receive buf size 531128 tcp no delay true
2020-12-03 07:23:28,034 [DataXceiver for client DFSClient_NONMAPREDUCE_-1260317844_1 at /127.0.0.1:55302 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741837_1013]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(747)) - Receiving BP-1458564024-172.17.0.11-1606980200717:blk_1073741837_1013 src: /127.0.0.1:55302 dest: /127.0.0.1:45491
2020-12-03 07:23:28,034 [DataXceiver for client DFSClient_NONMAPREDUCE_-1260317844_1 at /127.0.0.1:55302 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741837_1013]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1458564024-172.17.0.11-1606980200717:blk_1073741837_1013
 storageType=DISK, inAddr=/127.0.0.1:55302, myAddr=/127.0.0.1:45491
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-1260317844_1, srcDataNode=:0, datanode=127.0.0.1:45491
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-bfd35249-c440-48e2-9558-cf86da199a4b
2020-12-03 07:23:28,035 [DataXceiver for client DFSClient_NONMAPREDUCE_-1260317844_1 at /127.0.0.1:55302 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741837_1013]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-1458564024-172.17.0.11-1606980200717/current/rbw/blk_1073741837 of size 0
2020-12-03 07:23:28,035 [DataXceiver for client DFSClient_NONMAPREDUCE_-1260317844_1 at /127.0.0.1:55302 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741837_1013]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-1458564024-172.17.0.11-1606980200717/current/rbw/blk_1073741837_1013.meta of size 0
2020-12-03 07:23:28,036 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741837_1013, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741837_1013, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-12-03 07:23:28,051 [DataXceiver for client DFSClient_NONMAPREDUCE_-1260317844_1 at /127.0.0.1:55302 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741837_1013]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1458564024-172.17.0.11-1606980200717:blk_1073741837_1013: PacketHeader with packetLen=31 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 23

2020-12-03 07:23:28,052 [DataXceiver for client DFSClient_NONMAPREDUCE_-1260317844_1 at /127.0.0.1:55302 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741837_1013]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741837_1013, type=LAST_IN_PIPELINE: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=23, ackEnqueueNanoTime=141199826964112, ackStatus=SUCCESS)
2020-12-03 07:23:28,054 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741837_1013, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741837_1013, type=LAST_IN_PIPELINE, replyAck=seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:28,054 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741837_1013, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741837_1013, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-12-03 07:23:28,054 [DataXceiver for client DFSClient_NONMAPREDUCE_-1260317844_1 at /127.0.0.1:55302 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741837_1013]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1458564024-172.17.0.11-1606980200717:blk_1073741837_1013: PacketHeader with packetLen=4 header data: offsetInBlock: 23
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-12-03 07:23:28,054 [DataXceiver for client DFSClient_NONMAPREDUCE_-1260317844_1 at /127.0.0.1:55302 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741837_1013]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1458564024-172.17.0.11-1606980200717:blk_1073741837_1013
2020-12-03 07:23:28,055 [DataXceiver for client DFSClient_NONMAPREDUCE_-1260317844_1 at /127.0.0.1:55302 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741837_1013]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741837_1013, type=LAST_IN_PIPELINE: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=23, ackEnqueueNanoTime=141199830007871, ackStatus=SUCCESS)
2020-12-03 07:23:28,056 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741837_1013, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:55302, dest: /127.0.0.1:45491, bytes: 23, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-1260317844_1, offset: 0, srvID: 7455378e-99a9-49fc-9e03-4efd4d351125, blockid: BP-1458564024-172.17.0.11-1606980200717:blk_1073741837_1013, duration(ns): 18993145
2020-12-03 07:23:28,057 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741837_1013, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741837_1013, type=LAST_IN_PIPELINE, replyAck=seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:28,057 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741837_1013, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741837_1013, type=LAST_IN_PIPELINE terminating
2020-12-03 07:23:28,058 [DataXceiver for client DFSClient_NONMAPREDUCE_-1260317844_1 at /127.0.0.1:55302 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741837_1013]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741837_1013, type=LAST_IN_PIPELINE: closing
2020-12-03 07:23:28,058 [IPC Server handler 0 on default port 37786] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(674)) - DIR* NameSystem.completeFile: /TestFileAppend2/foo.dat for DFSClient_NONMAPREDUCE_-1260317844_1
2020-12-03 07:23:28,059 [IPC Server handler 0 on default port 37786] INFO  namenode.FSNamesystem (FSNamesystem.java:checkBlocksComplete(2995)) - BLOCK* blk_1073741837_1013 is COMMITTED but not COMPLETE(numNodes= 0 <  minimum = 1) in file /TestFileAppend2/foo.dat
2020-12-03 07:23:28,061 [DataXceiver for client DFSClient_NONMAPREDUCE_-1260317844_1 at /127.0.0.1:55302 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741837_1013]] DEBUG datanode.DataNode (DataXceiver.java:run(328)) - 127.0.0.1:45491:Number of active connections is: 3
2020-12-03 07:23:28,062 [IPC Server handler 2 on default port 37786] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1627)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45491, datanodeUuid=7455378e-99a9-49fc-9e03-4efd4d351125, infoPort=33275, infoSecurePort=0, ipcPort=33659, storageInfo=lv=-57;cid=testClusterID;nsid=1892489455;c=1606980200717) 1 blocks.
2020-12-03 07:23:28,063 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(4021)) - Reported block blk_1073741837_1013 on 127.0.0.1:45491 size 23 replicaState = FINALIZED
2020-12-03 07:23:28,063 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(4044)) - In memory blockUCState = COMMITTED
2020-12-03 07:23:28,063 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3351)) - BLOCK* addStoredBlock: 127.0.0.1:45491 is added to blk_1073741837_1013 (size=23)
2020-12-03 07:23:28,065 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4154)) - BLOCK* block RECEIVED_BLOCK: blk_1073741837_1013 is received from 127.0.0.1:45491
2020-12-03 07:23:28,065 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4157)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45491 receiving: 0, received: 1, deleted: 0
2020-12-03 07:23:28,465 [IPC Server handler 3 on default port 37786] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(674)) - DIR* NameSystem.completeFile: /TestFileAppend2/foo.dat for DFSClient_NONMAPREDUCE_-1260317844_1
2020-12-03 07:23:28,465 [IPC Server handler 3 on default port 37786] DEBUG hdfs.StateChange (FSNamesystem.java:closeFile(4036)) - closeFile: /TestFileAppend2/foo.dat with 1 blocks is persisted to the file system
2020-12-03 07:23:28,466 [IPC Server handler 3 on default port 37786] INFO  hdfs.StateChange (FSNamesystem.java:completeFile(2948)) - DIR* completeFile: /TestFileAppend2/foo.dat is closed by DFSClient_NONMAPREDUCE_-1260317844_1
2020-12-03 07:23:28,468 [IPC Server handler 4 on default port 37786] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8074)) - allowed=true	ugi=testappenduser (auth:SIMPLE)	ip=/127.0.0.1	cmd=setPermission	src=/TestFileAppend2	dst=null	perm=testappenduser:supergroup:--x------	proto=rpc
2020-12-03 07:23:28,470 [IPC Server handler 5 on default port 37786] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8074)) - allowed=true	ugi=testappenduser (auth:SIMPLE)	ip=/127.0.0.1	cmd=setPermission	src=/TestFileAppend2/foo.dat	dst=null	perm=testappenduser:supergroup:-w-------	proto=rpc
2020-12-03 07:23:28,471 [IPC Server handler 7 on default port 37786] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(809)) - *DIR* NameNode.append: file /TestFileAppend2/foo.dat for DFSClient_NONMAPREDUCE_-1260317844_1 at 127.0.0.1
2020-12-03 07:23:28,472 [IPC Server handler 7 on default port 37786] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2710)) - DIR* NameSystem.appendFile: src=/TestFileAppend2/foo.dat, holder=DFSClient_NONMAPREDUCE_-1260317844_1, clientMachine=127.0.0.1
2020-12-03 07:23:28,472 [IPC Server handler 7 on default port 37786] DEBUG hdfs.StateChange (FSDirAppendOp.java:appendFile(154)) - DIR* NameSystem.appendFile: file /TestFileAppend2/foo.dat for DFSClient_NONMAPREDUCE_-1260317844_1 at 127.0.0.1 block BP-1458564024-172.17.0.11-1606980200717:blk_1073741837_1013 block size 23
2020-12-03 07:23:28,473 [IPC Server handler 7 on default port 37786] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8074)) - allowed=true	ugi=testappenduser (auth:SIMPLE)	ip=/127.0.0.1	cmd=append	src=/TestFileAppend2/foo.dat	dst=null	perm=null	proto=rpc
2020-12-03 07:23:28,474 [Listener at localhost/33659] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/TestFileAppend2/foo.dat, chunkSize=516, chunksPerPacket=126, packetSize=65016
2020-12-03 07:23:28,475 [Listener at localhost/33659] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=0, src=/TestFileAppend2/foo.dat, packetSize=65016, chunksPerPacket=126, bytesCurBlock=0, DFSOutputStream:blk_1073741837_1013
2020-12-03 07:23:28,477 [IPC Server handler 8 on default port 37786] DEBUG hdfs.StateChange (FSNamesystem.java:getAdditionalBlock(2767)) - BLOCK* getAdditionalBlock: /TestFileAppend2/foo.dat  inodeId 16388 for DFSClient_NONMAPREDUCE_-1260317844_1
2020-12-03 07:23:28,478 [IPC Server handler 8 on default port 37786] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addBlock(524)) - DIR* FSDirectory.addBlock: /TestFileAppend2/foo.dat with blk_1073741838_1014 block is added to the in-memory file system
2020-12-03 07:23:28,478 [IPC Server handler 8 on default port 37786] INFO  hdfs.StateChange (FSDirWriteFileOp.java:logAllocatedBlock(798)) - BLOCK* allocate blk_1073741838_1014, replicas=127.0.0.1:45491 for /TestFileAppend2/foo.dat
2020-12-03 07:23:28,478 [IPC Server handler 8 on default port 37786] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistNewBlock(758)) - persistNewBlock: /TestFileAppend2/foo.dat with new block blk_1073741838_1014, current total block count is 2
2020-12-03 07:23:28,480 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@3f28bd56] DEBUG datanode.DataNode (DataXceiver.java:<init>(154)) - Number of active connections is: 2
2020-12-03 07:23:28,480 [Thread-174] INFO  sasl.SaslDataTransferClient (SaslDataTransferClient.java:checkTrustAndSend(239)) - SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
2020-12-03 07:23:28,492 [DataXceiver for client DFSClient_NONMAPREDUCE_-1260317844_1 at /127.0.0.1:55478 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741838_1014]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(728)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-1260317844_1
  block  =BP-1458564024-172.17.0.11-1606980200717:blk_1073741838_1014, newGs=0, bytesRcvd=[0, 0]
  targets=[]; pipelineSize=1, srcDataNode=:0, pinning=false
2020-12-03 07:23:28,492 [DataXceiver for client DFSClient_NONMAPREDUCE_-1260317844_1 at /127.0.0.1:55478 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741838_1014]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(734)) - isDatanode=false, isClient=true, isTransfer=false
2020-12-03 07:23:28,492 [DataXceiver for client DFSClient_NONMAPREDUCE_-1260317844_1 at /127.0.0.1:55478 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741838_1014]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(736)) - writeBlock receive buf size 531128 tcp no delay true
2020-12-03 07:23:28,492 [DataXceiver for client DFSClient_NONMAPREDUCE_-1260317844_1 at /127.0.0.1:55478 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741838_1014]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(747)) - Receiving BP-1458564024-172.17.0.11-1606980200717:blk_1073741838_1014 src: /127.0.0.1:55478 dest: /127.0.0.1:45491
2020-12-03 07:23:28,492 [DataXceiver for client DFSClient_NONMAPREDUCE_-1260317844_1 at /127.0.0.1:55478 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741838_1014]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1458564024-172.17.0.11-1606980200717:blk_1073741838_1014
 storageType=DISK, inAddr=/127.0.0.1:55478, myAddr=/127.0.0.1:45491
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-1260317844_1, srcDataNode=:0, datanode=127.0.0.1:45491
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-bfd35249-c440-48e2-9558-cf86da199a4b
2020-12-03 07:23:28,493 [DataXceiver for client DFSClient_NONMAPREDUCE_-1260317844_1 at /127.0.0.1:55478 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741838_1014]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1458564024-172.17.0.11-1606980200717/current/rbw/blk_1073741838 of size 0
2020-12-03 07:23:28,493 [DataXceiver for client DFSClient_NONMAPREDUCE_-1260317844_1 at /127.0.0.1:55478 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741838_1014]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1458564024-172.17.0.11-1606980200717/current/rbw/blk_1073741838_1014.meta of size 0
2020-12-03 07:23:28,497 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741838_1014, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741838_1014, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-12-03 07:23:28,499 [DataXceiver for client DFSClient_NONMAPREDUCE_-1260317844_1 at /127.0.0.1:55478 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741838_1014]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1458564024-172.17.0.11-1606980200717:blk_1073741838_1014: PacketHeader with packetLen=37 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 29

2020-12-03 07:23:28,499 [DataXceiver for client DFSClient_NONMAPREDUCE_-1260317844_1 at /127.0.0.1:55478 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741838_1014]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741838_1014, type=LAST_IN_PIPELINE: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=29, ackEnqueueNanoTime=141200274174484, ackStatus=SUCCESS)
2020-12-03 07:23:28,502 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741838_1014, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741838_1014, type=LAST_IN_PIPELINE, replyAck=seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:28,502 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741838_1014, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741838_1014, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-12-03 07:23:28,529 [DataXceiver for client DFSClient_NONMAPREDUCE_-1260317844_1 at /127.0.0.1:55478 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741838_1014]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1458564024-172.17.0.11-1606980200717:blk_1073741838_1014: PacketHeader with packetLen=4 header data: offsetInBlock: 29
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-12-03 07:23:28,530 [DataXceiver for client DFSClient_NONMAPREDUCE_-1260317844_1 at /127.0.0.1:55478 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741838_1014]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1458564024-172.17.0.11-1606980200717:blk_1073741838_1014
2020-12-03 07:23:28,530 [DataXceiver for client DFSClient_NONMAPREDUCE_-1260317844_1 at /127.0.0.1:55478 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741838_1014]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741838_1014, type=LAST_IN_PIPELINE: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=29, ackEnqueueNanoTime=141200305170639, ackStatus=SUCCESS)
2020-12-03 07:23:28,532 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741838_1014, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:55478, dest: /127.0.0.1:45491, bytes: 29, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-1260317844_1, offset: 0, srvID: 7455378e-99a9-49fc-9e03-4efd4d351125, blockid: BP-1458564024-172.17.0.11-1606980200717:blk_1073741838_1014, duration(ns): 33716479
2020-12-03 07:23:28,532 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741838_1014, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741838_1014, type=LAST_IN_PIPELINE, replyAck=seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:28,532 [PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741838_1014, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741838_1014, type=LAST_IN_PIPELINE terminating
2020-12-03 07:23:28,532 [DataXceiver for client DFSClient_NONMAPREDUCE_-1260317844_1 at /127.0.0.1:55478 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741838_1014]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1458564024-172.17.0.11-1606980200717:blk_1073741838_1014, type=LAST_IN_PIPELINE: closing
2020-12-03 07:23:28,536 [DataXceiver for client DFSClient_NONMAPREDUCE_-1260317844_1 at /127.0.0.1:55478 [Receiving block BP-1458564024-172.17.0.11-1606980200717:blk_1073741838_1014]] DEBUG datanode.DataNode (DataXceiver.java:run(328)) - 127.0.0.1:45491:Number of active connections is: 3
2020-12-03 07:23:28,541 [IPC Server handler 6 on default port 37786] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1627)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45491, datanodeUuid=7455378e-99a9-49fc-9e03-4efd4d351125, infoPort=33275, infoSecurePort=0, ipcPort=33659, storageInfo=lv=-57;cid=testClusterID;nsid=1892489455;c=1606980200717) 1 blocks.
2020-12-03 07:23:28,542 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(4021)) - Reported block blk_1073741838_1014 on 127.0.0.1:45491 size 29 replicaState = FINALIZED
2020-12-03 07:23:28,542 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(4044)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-12-03 07:23:28,542 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3351)) - BLOCK* addStoredBlock: 127.0.0.1:45491 is added to blk_1073741838_1014 (size=0)
2020-12-03 07:23:28,542 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4154)) - BLOCK* block RECEIVED_BLOCK: blk_1073741838_1014 is received from 127.0.0.1:45491
2020-12-03 07:23:28,542 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4157)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45491 receiving: 0, received: 1, deleted: 0
2020-12-03 07:23:28,542 [IPC Server handler 6 on default port 37786] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(674)) - DIR* NameSystem.completeFile: /TestFileAppend2/foo.dat for DFSClient_NONMAPREDUCE_-1260317844_1
2020-12-03 07:23:28,543 [IPC Server handler 6 on default port 37786] DEBUG hdfs.StateChange (FSNamesystem.java:closeFile(4036)) - closeFile: /TestFileAppend2/foo.dat with 2 blocks is persisted to the file system
2020-12-03 07:23:28,543 [IPC Server handler 6 on default port 37786] INFO  hdfs.StateChange (FSNamesystem.java:completeFile(2948)) - DIR* completeFile: /TestFileAppend2/foo.dat is closed by DFSClient_NONMAPREDUCE_-1260317844_1
2020-12-03 07:23:28,549 [IPC Server handler 1 on default port 37786] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8074)) - allowed=true	ugi=testappenduser (auth:SIMPLE)	ip=/127.0.0.1	cmd=setPermission	src=/TestFileAppend2/foo.dat	dst=null	perm=testappenduser:supergroup:r-xrwxrwx	proto=rpc
2020-12-03 07:23:28,552 [IPC Server handler 0 on default port 37786] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8074)) - allowed=true	ugi=testappenduser (auth:SIMPLE)	ip=/127.0.0.1	cmd=setPermission	src=/TestFileAppend2	dst=null	perm=testappenduser:supergroup:rwxrwxrwx	proto=rpc
2020-12-03 07:23:28,554 [IPC Server handler 2 on default port 37786] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(809)) - *DIR* NameNode.append: file /TestFileAppend2/foo.dat for DFSClient_NONMAPREDUCE_-1260317844_1 at 127.0.0.1
2020-12-03 07:23:28,554 [IPC Server handler 2 on default port 37786] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2710)) - DIR* NameSystem.appendFile: src=/TestFileAppend2/foo.dat, holder=DFSClient_NONMAPREDUCE_-1260317844_1, clientMachine=127.0.0.1
2020-12-03 07:23:28,555 [IPC Server handler 2 on default port 37786] WARN  hdfs.StateChange (FSDirAppendOp.java:appendFile(145)) - DIR* NameSystem.append: Permission denied: user=testappenduser, access=WRITE, inode="/TestFileAppend2/foo.dat":testappenduser:supergroup:-r-xrwxrwx
2020-12-03 07:23:28,555 [IPC Server handler 2 on default port 37786] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8074)) - allowed=false	ugi=testappenduser (auth:SIMPLE)	ip=/127.0.0.1	cmd=append	src=/TestFileAppend2/foo.dat	dst=null	perm=null	proto=rpc
2020-12-03 07:23:28,555 [IPC Server handler 2 on default port 37786] INFO  ipc.Server (Server.java:logException(2969)) - IPC Server handler 2 on default port 37786, call Call#62 Retry#0 org.apache.hadoop.hdfs.protocol.ClientProtocol.append from 127.0.0.1:47176: org.apache.hadoop.security.AccessControlException: Permission denied: user=testappenduser, access=WRITE, inode="/TestFileAppend2/foo.dat":testappenduser:supergroup:-r-xrwxrwx
Good: got org.apache.hadoop.security.AccessControlException: Permission denied: user=testappenduser, access=WRITE, inode="/TestFileAppend2/foo.dat":testappenduser:supergroup:-r-xrwxrwx
	at org.apache.hadoop.hdfs.server.namenode.FSPermissionChecker.check(FSPermissionChecker.java:399)
	at org.apache.hadoop.hdfs.server.namenode.FSPermissionChecker.checkPermission(FSPermissionChecker.java:261)
	at org.apache.hadoop.hdfs.server.namenode.FSPermissionChecker.checkPermission(FSPermissionChecker.java:193)
	at org.apache.hadoop.hdfs.server.namenode.FSDirectory.checkPermission(FSDirectory.java:1879)
	at org.apache.hadoop.hdfs.server.namenode.FSDirectory.checkPermission(FSDirectory.java:1863)
	at org.apache.hadoop.hdfs.server.namenode.FSDirectory.checkPathAccess(FSDirectory.java:1813)
	at org.apache.hadoop.hdfs.server.namenode.FSDirAppendOp.appendFile(FSDirAppendOp.java:100)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.appendFile(FSNamesystem.java:2722)
	at org.apache.hadoop.hdfs.server.namenode.NameNodeRpcServer.append(NameNodeRpcServer.java:822)
	at org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolServerSideTranslatorPB.append(ClientNamenodeProtocolServerSideTranslatorPB.java:500)
	at org.apache.hadoop.hdfs.protocol.proto.ClientNamenodeProtocolProtos$ClientNamenodeProtocol$2.callBlockingMethod(ClientNamenodeProtocolProtos.java)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine.java:528)
	at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:1070)
	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:999)
	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:927)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1730)
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2915)

org.apache.hadoop.security.AccessControlException: Permission denied: user=testappenduser, access=WRITE, inode="/TestFileAppend2/foo.dat":testappenduser:supergroup:-r-xrwxrwx
	at org.apache.hadoop.hdfs.server.namenode.FSPermissionChecker.check(FSPermissionChecker.java:399)
	at org.apache.hadoop.hdfs.server.namenode.FSPermissionChecker.checkPermission(FSPermissionChecker.java:261)
	at org.apache.hadoop.hdfs.server.namenode.FSPermissionChecker.checkPermission(FSPermissionChecker.java:193)
	at org.apache.hadoop.hdfs.server.namenode.FSDirectory.checkPermission(FSDirectory.java:1879)
	at org.apache.hadoop.hdfs.server.namenode.FSDirectory.checkPermission(FSDirectory.java:1863)
	at org.apache.hadoop.hdfs.server.namenode.FSDirectory.checkPathAccess(FSDirectory.java:1813)
	at org.apache.hadoop.hdfs.server.namenode.FSDirAppendOp.appendFile(FSDirAppendOp.java:100)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.appendFile(FSNamesystem.java:2722)
	at org.apache.hadoop.hdfs.server.namenode.NameNodeRpcServer.append(NameNodeRpcServer.java:822)
	at org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolServerSideTranslatorPB.append(ClientNamenodeProtocolServerSideTranslatorPB.java:500)
	at org.apache.hadoop.hdfs.protocol.proto.ClientNamenodeProtocolProtos$ClientNamenodeProtocol$2.callBlockingMethod(ClientNamenodeProtocolProtos.java)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine.java:528)
	at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:1070)
	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:999)
	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:927)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1730)
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2915)

	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.hadoop.ipc.RemoteException.instantiateException(RemoteException.java:121)
	at org.apache.hadoop.ipc.RemoteException.unwrapRemoteException(RemoteException.java:88)
	at org.apache.hadoop.hdfs.DFSClient.callAppend(DFSClient.java:1362)
	at org.apache.hadoop.hdfs.DFSClient.append(DFSClient.java:1419)
	at org.apache.hadoop.hdfs.DFSClient.append(DFSClient.java:1389)
	at org.apache.hadoop.hdfs.DistributedFileSystem$5.doCall(DistributedFileSystem.java:420)
	at org.apache.hadoop.hdfs.DistributedFileSystem$5.doCall(DistributedFileSystem.java:416)
	at org.apache.hadoop.fs.FileSystemLinkResolver.resolve(FileSystemLinkResolver.java:81)
	at org.apache.hadoop.hdfs.DistributedFileSystem.append(DistributedFileSystem.java:428)
	at org.apache.hadoop.hdfs.TestFileAppend2.testSimpleAppend2(TestFileAppend2.java:356)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
Caused by: org.apache.hadoop.ipc.RemoteException(org.apache.hadoop.security.AccessControlException): Permission denied: user=testappenduser, access=WRITE, inode="/TestFileAppend2/foo.dat":testappenduser:supergroup:-r-xrwxrwx
	at org.apache.hadoop.hdfs.server.namenode.FSPermissionChecker.check(FSPermissionChecker.java:399)
	at org.apache.hadoop.hdfs.server.namenode.FSPermissionChecker.checkPermission(FSPermissionChecker.java:261)
	at org.apache.hadoop.hdfs.server.namenode.FSPermissionChecker.checkPermission(FSPermissionChecker.java:193)
	at org.apache.hadoop.hdfs.server.namenode.FSDirectory.checkPermission(FSDirectory.java:1879)
	at org.apache.hadoop.hdfs.server.namenode.FSDirectory.checkPermission(FSDirectory.java:1863)
	at org.apache.hadoop.hdfs.server.namenode.FSDirectory.checkPathAccess(FSDirectory.java:1813)
	at org.apache.hadoop.hdfs.server.namenode.FSDirAppendOp.appendFile(FSDirAppendOp.java:100)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.appendFile(FSNamesystem.java:2722)
	at org.apache.hadoop.hdfs.server.namenode.NameNodeRpcServer.append(NameNodeRpcServer.java:822)
	at org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolServerSideTranslatorPB.append(ClientNamenodeProtocolServerSideTranslatorPB.java:500)
	at org.apache.hadoop.hdfs.protocol.proto.ClientNamenodeProtocolProtos$ClientNamenodeProtocol$2.callBlockingMethod(ClientNamenodeProtocolProtos.java)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine.java:528)
	at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:1070)
	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:999)
	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:927)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1730)
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2915)

	at org.apache.hadoop.ipc.Client.getRpcResponse(Client.java:1545)
	at org.apache.hadoop.ipc.Client.call(Client.java:1491)
	at org.apache.hadoop.ipc.Client.call(Client.java:1388)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:233)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:118)
	at com.sun.proxy.$Proxy23.append(Unknown Source)
	at org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolTranslatorPB.append(ClientNamenodeProtocolTranslatorPB.java:400)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.io.retry.RetryInvocationHandler.invokeMethod(RetryInvocationHandler.java:422)
	at org.apache.hadoop.io.retry.RetryInvocationHandler$Call.invokeMethod(RetryInvocationHandler.java:165)
	at org.apache.hadoop.io.retry.RetryInvocationHandler$Call.invoke(RetryInvocationHandler.java:157)
	at org.apache.hadoop.io.retry.RetryInvocationHandler$Call.invokeOnce(RetryInvocationHandler.java:95)
	at org.apache.hadoop.io.retry.RetryInvocationHandler.invoke(RetryInvocationHandler.java:359)
	at com.sun.proxy.$Proxy24.append(Unknown Source)
	at org.apache.hadoop.hdfs.DFSClient.callAppend(DFSClient.java:1328)
	at org.apache.hadoop.hdfs.DFSClient.callAppend(DFSClient.java:1350)
	... 32 more
2020-12-03 07:23:28,562 [Listener at localhost/33659] INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:shutdown(2049)) - Shutting down the Mini HDFS Cluster
2020-12-03 07:23:28,562 [Listener at localhost/33659] INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:shutdownDataNode(2097)) - Shutting down DataNode 0
2020-12-03 07:23:28,564 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@3f28bd56] INFO  datanode.DataNode (DataXceiverServer.java:closeAllPeers(281)) - Closing all peers.
2020-12-03 07:23:28,563 [Listener at localhost/33659] WARN  datanode.DirectoryScanner (DirectoryScanner.java:shutdown(343)) - DirectoryScanner: shutdown has been called
2020-12-03 07:23:28,568 [VolumeScannerThread(/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2)] INFO  datanode.VolumeScanner (VolumeScanner.java:run(637)) - VolumeScanner(/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2, DS-bfd35249-c440-48e2-9558-cf86da199a4b) exiting.
2020-12-03 07:23:28,568 [VolumeScannerThread(/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1)] INFO  datanode.VolumeScanner (VolumeScanner.java:run(637)) - VolumeScanner(/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1, DS-634fcf0b-cfbf-4df0-b7a1-9f98805233fb) exiting.
2020-12-03 07:23:28,582 [BP-1458564024-172.17.0.11-1606980200717 heartbeating to localhost/127.0.0.1:37786] WARN  datanode.DataNode (BPServiceActor.java:run(860)) - Ending block pool service for: Block pool BP-1458564024-172.17.0.11-1606980200717 (Datanode Uuid 7455378e-99a9-49fc-9e03-4efd4d351125) service to localhost/127.0.0.1:37786
2020-12-03 07:23:28,635 [Listener at localhost/33659] INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@68759011{/,null,UNAVAILABLE}{/datanode}
2020-12-03 07:23:28,643 [Listener at localhost/33659] INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@7e242b4d{HTTP/1.1,[http/1.1]}{localhost:0}
2020-12-03 07:23:28,643 [Listener at localhost/33659] INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@24faea88{/static,file:///root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/src/main/webapps/static/,UNAVAILABLE}
2020-12-03 07:23:28,645 [Listener at localhost/33659] INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@6d366c9b{/logs,file:///root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/log/,UNAVAILABLE}
2020-12-03 07:23:28,655 [Listener at localhost/33659] INFO  ipc.Server (Server.java:stop(3359)) - Stopping server on 33659
2020-12-03 07:23:28,656 [DataXceiver for client DFSClient_NONMAPREDUCE_-126688406_1 at /127.0.0.1:55242 [Waiting for operation #13]] DEBUG datanode.DataNode (DataXceiver.java:run(328)) - 127.0.0.1:45491:Number of active connections is: 0
2020-12-03 07:23:28,683 [IPC Server listener on 0] INFO  ipc.Server (Server.java:run(1330)) - Stopping IPC Server listener on 0
2020-12-03 07:23:28,685 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1465)) - Stopping IPC Server Responder
2020-12-03 07:23:28,685 [BP-1458564024-172.17.0.11-1606980200717 heartbeating to localhost/127.0.0.1:37786] INFO  datanode.DataNode (BlockPoolManager.java:remove(102)) - Removed Block pool BP-1458564024-172.17.0.11-1606980200717 (Datanode Uuid 7455378e-99a9-49fc-9e03-4efd4d351125)
2020-12-03 07:23:28,686 [BP-1458564024-172.17.0.11-1606980200717 heartbeating to localhost/127.0.0.1:37786] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:shutdownBlockPool(2814)) - Removing block pool BP-1458564024-172.17.0.11-1606980200717
2020-12-03 07:23:28,687 [refreshUsed-/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-1458564024-172.17.0.11-1606980200717] WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2020-12-03 07:23:28,688 [refreshUsed-/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1458564024-172.17.0.11-1606980200717] WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2020-12-03 07:23:28,691 [Listener at localhost/33659] INFO  impl.FsDatasetAsyncDiskService (FsDatasetAsyncDiskService.java:shutdown(193)) - Shutting down all async disk service threads
2020-12-03 07:23:28,692 [Listener at localhost/33659] INFO  impl.FsDatasetAsyncDiskService (FsDatasetAsyncDiskService.java:shutdown(201)) - All async disk service threads have been shut down
2020-12-03 07:23:28,692 [Listener at localhost/33659] INFO  impl.RamDiskAsyncLazyPersistService (RamDiskAsyncLazyPersistService.java:shutdown(177)) - Shutting down all async lazy persist service threads
2020-12-03 07:23:28,692 [Listener at localhost/33659] INFO  impl.RamDiskAsyncLazyPersistService (RamDiskAsyncLazyPersistService.java:shutdown(184)) - All async lazy persist service threads have been shut down
2020-12-03 07:23:28,704 [Listener at localhost/33659] INFO  datanode.DataNode (DataNode.java:shutdown(2164)) - Shutdown complete.
2020-12-03 07:23:28,704 [Listener at localhost/33659] INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:stopAndJoinNameNode(2130)) - Shutting down the namenode
2020-12-03 07:23:28,704 [Listener at localhost/33659] INFO  namenode.FSNamesystem (FSNamesystem.java:stopActiveServices(1334)) - Stopping services started for active state
2020-12-03 07:23:28,705 [org.apache.hadoop.hdfs.server.namenode.LeaseManager$Monitor@650eab8] DEBUG namenode.LeaseManager (LeaseManager.java:run(536)) - Monitor is interrupted
java.lang.InterruptedException: sleep interrupted
	at java.lang.Thread.sleep(Native Method)
	at org.apache.hadoop.hdfs.server.namenode.LeaseManager$Monitor.run(LeaseManager.java:534)
	at java.lang.Thread.run(Thread.java:748)
2020-12-03 07:23:28,707 [Listener at localhost/33659] INFO  namenode.FSEditLog (FSEditLog.java:endCurrentLogSegment(1410)) - Ending log segment 1, 59
2020-12-03 07:23:28,707 [org.apache.hadoop.hdfs.server.namenode.FSNamesystem$LazyPersistFileScrubber@4f2c9ba6] INFO  namenode.FSNamesystem (FSNamesystem.java:run(4198)) - LazyPersistFileScrubber was interrupted, exiting
2020-12-03 07:23:28,707 [org.apache.hadoop.hdfs.server.namenode.FSNamesystem$NameNodeEditLogRoller@1e1d3956] INFO  namenode.FSNamesystem (FSNamesystem.java:run(4107)) - NameNodeEditLogRoller was interrupted, exiting
2020-12-03 07:23:28,708 [Listener at localhost/33659] INFO  namenode.FSEditLog (FSEditLog.java:printStatistics(778)) - Number of transactions: 60 Total time for transactions(ms): 33 Number of transactions batched in Syncs: 17 Number of syncs: 44 SyncTimes(ms): 7 2 
2020-12-03 07:23:28,709 [Listener at localhost/33659] INFO  namenode.FileJournalManager (FileJournalManager.java:finalizeLogSegment(145)) - Finalizing edits file /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/name-0-1/current/edits_inprogress_0000000000000000001 -> /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/name-0-1/current/edits_0000000000000000001-0000000000000000060
2020-12-03 07:23:28,710 [Listener at localhost/33659] INFO  namenode.FileJournalManager (FileJournalManager.java:finalizeLogSegment(145)) - Finalizing edits file /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/name-0-2/current/edits_inprogress_0000000000000000001 -> /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/name-0-2/current/edits_0000000000000000001-0000000000000000060
2020-12-03 07:23:28,712 [FSEditLogAsync] INFO  namenode.FSEditLog (FSEditLogAsync.java:run(253)) - FSEditLogAsync was interrupted, exiting
2020-12-03 07:23:28,712 [CacheReplicationMonitor(271906504)] INFO  blockmanagement.CacheReplicationMonitor (CacheReplicationMonitor.java:run(169)) - Shutting down CacheReplicationMonitor
2020-12-03 07:23:28,716 [Listener at localhost/33659] INFO  ipc.Server (Server.java:stop(3359)) - Stopping server on 37786
2020-12-03 07:23:28,717 [IPC Server listener on 0] INFO  ipc.Server (Server.java:run(1330)) - Stopping IPC Server listener on 0
2020-12-03 07:23:28,723 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1465)) - Stopping IPC Server Responder
2020-12-03 07:23:28,723 [RedundancyMonitor] INFO  blockmanagement.BlockManager (BlockManager.java:run(4687)) - Stopping RedundancyMonitor.
2020-12-03 07:23:28,725 [StorageInfoMonitor] INFO  blockmanagement.BlockManager (BlockManager.java:run(4722)) - Stopping thread.
2020-12-03 07:23:28,727 [org.apache.hadoop.hdfs.server.blockmanagement.PendingReconstructionBlocks$PendingReconstructionMonitor@609640d5] DEBUG blockmanagement.BlockManager (PendingReconstructionBlocks.java:run(248)) - PendingReconstructionMonitor thread is interrupted.
java.lang.InterruptedException: sleep interrupted
	at java.lang.Thread.sleep(Native Method)
	at org.apache.hadoop.hdfs.server.blockmanagement.PendingReconstructionBlocks$PendingReconstructionMonitor.run(PendingReconstructionBlocks.java:246)
	at java.lang.Thread.run(Thread.java:748)
2020-12-03 07:23:28,773 [Listener at localhost/33659] INFO  namenode.FSNamesystem (FSNamesystem.java:stopActiveServices(1334)) - Stopping services started for active state
2020-12-03 07:23:28,774 [Listener at localhost/33659] INFO  namenode.FSNamesystem (FSNamesystem.java:stopStandbyServices(1434)) - Stopping services started for standby state
2020-12-03 07:23:28,776 [Listener at localhost/33659] INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@12299890{/,null,UNAVAILABLE}{/hdfs}
2020-12-03 07:23:28,778 [Listener at localhost/33659] INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@51c693d{HTTP/1.1,[http/1.1]}{localhost:0}
2020-12-03 07:23:28,778 [Listener at localhost/33659] INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@5a7fe64f{/static,file:///root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/src/main/webapps/static/,UNAVAILABLE}
2020-12-03 07:23:28,779 [Listener at localhost/33659] INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@14bdbc74{/logs,file:///root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/log/,UNAVAILABLE}
2020-12-03 07:23:28,787 [Listener at localhost/33659] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:stop(210)) - Stopping DataNode metrics system...
2020-12-03 07:23:28,790 [Listener at localhost/33659] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:stop(216)) - DataNode metrics system stopped.
2020-12-03 07:23:28,790 [Listener at localhost/33659] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:shutdown(607)) - DataNode metrics system shutdown complete.
msx-rc 0
