2020-12-03 07:23:18,124 [main] INFO  hdfs.AppendTestUtil (AppendTestUtil.java:<clinit>(53)) - seed=-4053572135881570861
2020-12-03 07:23:18,132 [main] INFO  hdfs.AppendTestUtil (AppendTestUtil.java:initialValue(64)) - main: seed=1111047541159296907
2020-12-03 07:23:18,133 [main] INFO  hdfs.AppendTestUtil (AppendTestUtil.java:randomBytes(79)) - seed=-1871684575, size=10241
2020-12-03 07:23:18,208 [main] INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:<init>(493)) - starting cluster: numNameNodes=1, numDataNodes=1
2020-12-03 07:23:19,091 [main] DEBUG namenode.NameNode (NameNode.java:initializeGenericKeys(1737)) - Setting fs.defaultFS to hdfs://127.0.0.1:0
Formatting using clusterid: testClusterID
2020-12-03 07:23:19,120 [main] INFO  namenode.FSEditLog (FSEditLog.java:newInstance(229)) - Edit logging is async:true
2020-12-03 07:23:19,134 [main] INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(755)) - KeyProvider: null
2020-12-03 07:23:19,135 [main] INFO  namenode.FSNamesystem (FSNamesystemLock.java:<init>(123)) - fsLock is fair: true
2020-12-03 07:23:19,136 [main] INFO  namenode.FSNamesystem (FSNamesystemLock.java:<init>(141)) - Detailed lock hold time metrics enabled: false
2020-12-03 07:23:19,145 [main] INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(780)) - fsOwner             = root (auth:SIMPLE)
2020-12-03 07:23:19,145 [main] INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(781)) - supergroup          = supergroup
2020-12-03 07:23:19,145 [main] INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(782)) - isPermissionEnabled = true
2020-12-03 07:23:19,146 [main] INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(793)) - HA Enabled: false
2020-12-03 07:23:19,188 [main] INFO  common.Util (Util.java:isDiskStatsEnabled(395)) - dfs.datanode.fileio.profiling.sampling.percentage set to 0. Disabling file IO profiling
2020-12-03 07:23:19,196 [main] INFO  Configuration.deprecation (Configuration.java:logDeprecation(1395)) - hadoop.configured.node.mapping is deprecated. Instead, use net.topology.configured.node.mapping
2020-12-03 07:23:19,203 [main] INFO  blockmanagement.DatanodeManager (DatanodeManager.java:<init>(303)) - dfs.block.invalidate.limit: configured=1000, counted=60, effected=1000
2020-12-03 07:23:19,209 [main] INFO  blockmanagement.DatanodeManager (DatanodeManager.java:<init>(311)) - dfs.namenode.datanode.registration.ip-hostname-check=true
2020-12-03 07:23:19,222 [main] INFO  blockmanagement.BlockManager (InvalidateBlocks.java:printBlockDeletionTime(79)) - dfs.namenode.startup.delay.block.deletion.sec is set to 000:00:00:00.000
2020-12-03 07:23:19,224 [main] INFO  blockmanagement.BlockManager (InvalidateBlocks.java:printBlockDeletionTime(85)) - The block deletion will start around 2020 Dec 03 07:23:19
2020-12-03 07:23:19,229 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(395)) - Computing capacity for map BlocksMap
2020-12-03 07:23:19,229 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(396)) - VM type       = 64-bit
2020-12-03 07:23:19,233 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(397)) - 2.0% max memory 1.9 GB = 39.3 MB
2020-12-03 07:23:19,233 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(402)) - capacity      = 2^22 = 4194304 entries
2020-12-03 07:23:19,269 [main] INFO  blockmanagement.BlockManager (BlockManager.java:createSPSManager(5183)) - Storage policy satisfier is disabled
2020-12-03 07:23:19,270 [main] INFO  blockmanagement.BlockManager (BlockManager.java:createBlockTokenSecretManager(595)) - dfs.block.access.token.enable = false
2020-12-03 07:23:19,281 [main] INFO  Configuration.deprecation (Configuration.java:logDeprecation(1395)) - No unit for dfs.namenode.safemode.extension(0) assuming MILLISECONDS
2020-12-03 07:23:19,281 [main] INFO  blockmanagement.BlockManagerSafeMode (BlockManagerSafeMode.java:<init>(161)) - dfs.namenode.safemode.threshold-pct = 0.9990000128746033
2020-12-03 07:23:19,282 [main] INFO  blockmanagement.BlockManagerSafeMode (BlockManagerSafeMode.java:<init>(162)) - dfs.namenode.safemode.min.datanodes = 0
2020-12-03 07:23:19,282 [main] INFO  blockmanagement.BlockManagerSafeMode (BlockManagerSafeMode.java:<init>(164)) - dfs.namenode.safemode.extension = 0
2020-12-03 07:23:19,283 [main] INFO  blockmanagement.BlockManager (BlockManager.java:<init>(581)) - defaultReplication         = 1
2020-12-03 07:23:19,283 [main] INFO  blockmanagement.BlockManager (BlockManager.java:<init>(582)) - maxReplication             = 512
2020-12-03 07:23:19,284 [main] INFO  blockmanagement.BlockManager (BlockManager.java:<init>(583)) - minReplication             = 1
2020-12-03 07:23:19,284 [main] INFO  blockmanagement.BlockManager (BlockManager.java:<init>(584)) - maxReplicationStreams      = 2
2020-12-03 07:23:19,284 [main] INFO  blockmanagement.BlockManager (BlockManager.java:<init>(585)) - redundancyRecheckInterval  = 3000ms
2020-12-03 07:23:19,285 [main] INFO  blockmanagement.BlockManager (BlockManager.java:<init>(586)) - encryptDataTransfer        = false
2020-12-03 07:23:19,285 [main] INFO  blockmanagement.BlockManager (BlockManager.java:<init>(587)) - maxNumBlocksToLog          = 1000
2020-12-03 07:23:19,378 [main] INFO  namenode.FSDirectory (SerialNumberManager.java:<clinit>(51)) - GLOBAL serial map: bits=29 maxEntries=536870911
2020-12-03 07:23:19,378 [main] INFO  namenode.FSDirectory (SerialNumberManager.java:<clinit>(51)) - USER serial map: bits=24 maxEntries=16777215
2020-12-03 07:23:19,379 [main] INFO  namenode.FSDirectory (SerialNumberManager.java:<clinit>(51)) - GROUP serial map: bits=24 maxEntries=16777215
2020-12-03 07:23:19,379 [main] INFO  namenode.FSDirectory (SerialNumberManager.java:<clinit>(51)) - XATTR serial map: bits=24 maxEntries=16777215
2020-12-03 07:23:19,403 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(395)) - Computing capacity for map INodeMap
2020-12-03 07:23:19,403 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(396)) - VM type       = 64-bit
2020-12-03 07:23:19,404 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(397)) - 1.0% max memory 1.9 GB = 19.6 MB
2020-12-03 07:23:19,404 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(402)) - capacity      = 2^21 = 2097152 entries
2020-12-03 07:23:19,413 [main] INFO  namenode.FSDirectory (FSDirectory.java:<init>(290)) - ACLs enabled? false
2020-12-03 07:23:19,413 [main] INFO  namenode.FSDirectory (FSDirectory.java:<init>(294)) - POSIX ACL inheritance enabled? true
2020-12-03 07:23:19,414 [main] INFO  namenode.FSDirectory (FSDirectory.java:<init>(298)) - XAttrs enabled? true
2020-12-03 07:23:19,414 [main] INFO  namenode.NameNode (FSDirectory.java:<init>(362)) - Caching file names occurring more than 10 times
2020-12-03 07:23:19,424 [main] INFO  snapshot.SnapshotManager (SnapshotManager.java:<init>(124)) - Loaded config captureOpenFiles: false, skipCaptureAccessTimeOnlyChange: false, snapshotDiffAllowSnapRootDescendant: true, maxSnapshotLimit: 65536
2020-12-03 07:23:19,429 [main] INFO  snapshot.SnapshotManager (DirectoryDiffListFactory.java:init(43)) - SkipList is disabled
2020-12-03 07:23:19,437 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(395)) - Computing capacity for map cachedBlocks
2020-12-03 07:23:19,437 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(396)) - VM type       = 64-bit
2020-12-03 07:23:19,438 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(397)) - 0.25% max memory 1.9 GB = 4.9 MB
2020-12-03 07:23:19,438 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(402)) - capacity      = 2^19 = 524288 entries
2020-12-03 07:23:19,453 [main] INFO  metrics.TopMetrics (TopMetrics.java:logConf(76)) - NNTop conf: dfs.namenode.top.window.num.buckets = 10
2020-12-03 07:23:19,454 [main] INFO  metrics.TopMetrics (TopMetrics.java:logConf(78)) - NNTop conf: dfs.namenode.top.num.users = 10
2020-12-03 07:23:19,454 [main] INFO  metrics.TopMetrics (TopMetrics.java:logConf(80)) - NNTop conf: dfs.namenode.top.windows.minutes = 1,5,25
2020-12-03 07:23:19,462 [main] INFO  namenode.FSNamesystem (FSNamesystem.java:initRetryCache(996)) - Retry cache on namenode is enabled
2020-12-03 07:23:19,463 [main] INFO  namenode.FSNamesystem (FSNamesystem.java:initRetryCache(1004)) - Retry cache will use 0.03 of total heap and retry cache entry expiry time is 600000 millis
2020-12-03 07:23:19,467 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(395)) - Computing capacity for map NameNodeRetryCache
2020-12-03 07:23:19,467 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(396)) - VM type       = 64-bit
2020-12-03 07:23:19,468 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(397)) - 0.029999999329447746% max memory 1.9 GB = 603.0 KB
2020-12-03 07:23:19,468 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(402)) - capacity      = 2^16 = 65536 entries
2020-12-03 07:23:19,533 [main] INFO  namenode.FSImage (FSImage.java:format(185)) - Allocated new BlockPoolId: BP-2057880481-172.17.0.10-1606980199510
2020-12-03 07:23:19,623 [main] INFO  common.Storage (NNStorage.java:format(595)) - Storage directory /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/name-0-1 has been successfully formatted.
2020-12-03 07:23:19,674 [main] INFO  common.Storage (NNStorage.java:format(595)) - Storage directory /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/name-0-2 has been successfully formatted.
2020-12-03 07:23:19,717 [FSImageSaver for /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/name-0-1 of type IMAGE_AND_EDITS] INFO  namenode.FSImageFormatProtobuf (FSImageFormatProtobuf.java:save(512)) - Saving image file /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/name-0-1/current/fsimage.ckpt_0000000000000000000 using no compression
2020-12-03 07:23:19,717 [FSImageSaver for /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/name-0-2 of type IMAGE_AND_EDITS] INFO  namenode.FSImageFormatProtobuf (FSImageFormatProtobuf.java:save(512)) - Saving image file /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/name-0-2/current/fsimage.ckpt_0000000000000000000 using no compression
2020-12-03 07:23:19,870 [FSImageSaver for /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/name-0-2 of type IMAGE_AND_EDITS] INFO  namenode.FSImageFormatProtobuf (FSImageFormatProtobuf.java:save(516)) - Image file /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/name-0-2/current/fsimage.ckpt_0000000000000000000 of size 396 bytes saved in 0 seconds .
2020-12-03 07:23:19,870 [FSImageSaver for /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/name-0-1 of type IMAGE_AND_EDITS] INFO  namenode.FSImageFormatProtobuf (FSImageFormatProtobuf.java:save(516)) - Image file /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/name-0-1/current/fsimage.ckpt_0000000000000000000 of size 396 bytes saved in 0 seconds .
2020-12-03 07:23:19,952 [main] INFO  namenode.NNStorageRetentionManager (NNStorageRetentionManager.java:getImageTxIdToRetain(203)) - Going to retain 1 images with txid >= 0
2020-12-03 07:23:19,955 [main] INFO  namenode.NameNode (NameNode.java:createNameNode(1632)) - createNameNode []
2020-12-03 07:23:20,394 [main] INFO  impl.MetricsConfig (MetricsConfig.java:loadFirst(118)) - Loaded properties from hadoop-metrics2.properties
2020-12-03 07:23:20,494 [main] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:startTimer(374)) - Scheduled Metric snapshot period at 0 second(s).
2020-12-03 07:23:20,495 [main] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:start(191)) - NameNode metrics system started
2020-12-03 07:23:20,529 [main] INFO  namenode.NameNodeUtils (NameNodeUtils.java:getClientNamenodeAddress(79)) - fs.defaultFS is hdfs://127.0.0.1:0
2020-12-03 07:23:20,530 [main] DEBUG namenode.NameNode (NameNode.java:initializeGenericKeys(1737)) - Setting fs.defaultFS to hdfs://127.0.0.1:0
2020-12-03 07:23:20,580 [org.apache.hadoop.util.JvmPauseMonitor$Monitor@66f57048] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2020-12-03 07:23:20,601 [main] INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hdfs at: http://localhost:0
2020-12-03 07:23:20,608 [main] INFO  http.HttpServer2 (HttpServer2.java:getWebAppsPath(1072)) - Web server is in development mode. Resources will be read from the source tree.
2020-12-03 07:23:20,629 [main] INFO  util.log (Log.java:initialized(192)) - Logging initialized @4023ms
2020-12-03 07:23:20,769 [main] INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2020-12-03 07:23:20,774 [main] INFO  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(81)) - Http request log for http.requests.namenode is not defined
2020-12-03 07:23:20,775 [main] INFO  http.HttpServer2 (HttpServer2.java:getWebAppsPath(1072)) - Web server is in development mode. Resources will be read from the source tree.
2020-12-03 07:23:20,790 [main] INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(990)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2020-12-03 07:23:20,793 [main] INFO  http.HttpServer2 (HttpServer2.java:addFilter(963)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hdfs
2020-12-03 07:23:20,794 [main] INFO  http.HttpServer2 (HttpServer2.java:addFilter(973)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2020-12-03 07:23:20,794 [main] INFO  http.HttpServer2 (HttpServer2.java:addFilter(973)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2020-12-03 07:23:20,837 [main] INFO  http.HttpServer2 (NameNodeHttpServer.java:initWebHdfs(102)) - Added filter 'org.apache.hadoop.hdfs.web.AuthFilter' (class=org.apache.hadoop.hdfs.web.AuthFilter)
2020-12-03 07:23:20,838 [main] INFO  http.HttpServer2 (HttpServer2.java:addJerseyResourcePackage(806)) - addJerseyResourcePackage: packageName=org.apache.hadoop.hdfs.server.namenode.web.resources;org.apache.hadoop.hdfs.web.resources, pathSpec=/webhdfs/v1/*
2020-12-03 07:23:20,852 [main] INFO  http.HttpServer2 (HttpServer2.java:bindListener(1206)) - Jetty bound to port 32812
2020-12-03 07:23:20,855 [main] INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2020-12-03 07:23:20,917 [main] INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@12591ac8{/logs,file:///root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/log/,AVAILABLE}
2020-12-03 07:23:20,920 [main] INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@38145825{/static,file:///root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/src/main/webapps/static/,AVAILABLE}
2020-12-03 07:23:20,969 [main] INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@2fba3fc4{/,file:///root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/src/main/webapps/hdfs/,AVAILABLE}{/hdfs}
2020-12-03 07:23:20,984 [main] INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@6a57ae10{HTTP/1.1,[http/1.1]}{localhost:32812}
2020-12-03 07:23:20,985 [main] INFO  server.Server (Server.java:doStart(419)) - Started @4378ms
2020-12-03 07:23:21,005 [main] INFO  namenode.FSEditLog (FSEditLog.java:newInstance(229)) - Edit logging is async:true
2020-12-03 07:23:21,006 [main] INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(755)) - KeyProvider: null
2020-12-03 07:23:21,006 [main] INFO  namenode.FSNamesystem (FSNamesystemLock.java:<init>(123)) - fsLock is fair: true
2020-12-03 07:23:21,007 [main] INFO  namenode.FSNamesystem (FSNamesystemLock.java:<init>(141)) - Detailed lock hold time metrics enabled: false
2020-12-03 07:23:21,007 [main] INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(780)) - fsOwner             = root (auth:SIMPLE)
2020-12-03 07:23:21,007 [main] INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(781)) - supergroup          = supergroup
2020-12-03 07:23:21,007 [main] INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(782)) - isPermissionEnabled = true
2020-12-03 07:23:21,008 [main] INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(793)) - HA Enabled: false
2020-12-03 07:23:21,009 [main] INFO  common.Util (Util.java:isDiskStatsEnabled(395)) - dfs.datanode.fileio.profiling.sampling.percentage set to 0. Disabling file IO profiling
2020-12-03 07:23:21,009 [main] INFO  blockmanagement.DatanodeManager (DatanodeManager.java:<init>(303)) - dfs.block.invalidate.limit: configured=1000, counted=60, effected=1000
2020-12-03 07:23:21,010 [main] INFO  blockmanagement.DatanodeManager (DatanodeManager.java:<init>(311)) - dfs.namenode.datanode.registration.ip-hostname-check=true
2020-12-03 07:23:21,010 [main] INFO  blockmanagement.BlockManager (InvalidateBlocks.java:printBlockDeletionTime(79)) - dfs.namenode.startup.delay.block.deletion.sec is set to 000:00:00:00.000
2020-12-03 07:23:21,011 [main] INFO  blockmanagement.BlockManager (InvalidateBlocks.java:printBlockDeletionTime(85)) - The block deletion will start around 2020 Dec 03 07:23:21
2020-12-03 07:23:21,011 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(395)) - Computing capacity for map BlocksMap
2020-12-03 07:23:21,011 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(396)) - VM type       = 64-bit
2020-12-03 07:23:21,012 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(397)) - 2.0% max memory 1.8 GB = 36.4 MB
2020-12-03 07:23:21,012 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(402)) - capacity      = 2^22 = 4194304 entries
2020-12-03 07:23:21,017 [main] INFO  blockmanagement.BlockManager (BlockManager.java:createSPSManager(5183)) - Storage policy satisfier is disabled
2020-12-03 07:23:21,017 [main] INFO  blockmanagement.BlockManager (BlockManager.java:createBlockTokenSecretManager(595)) - dfs.block.access.token.enable = false
2020-12-03 07:23:21,018 [main] INFO  Configuration.deprecation (Configuration.java:logDeprecation(1395)) - No unit for dfs.namenode.safemode.extension(0) assuming MILLISECONDS
2020-12-03 07:23:21,018 [main] INFO  blockmanagement.BlockManagerSafeMode (BlockManagerSafeMode.java:<init>(161)) - dfs.namenode.safemode.threshold-pct = 0.9990000128746033
2020-12-03 07:23:21,018 [main] INFO  blockmanagement.BlockManagerSafeMode (BlockManagerSafeMode.java:<init>(162)) - dfs.namenode.safemode.min.datanodes = 0
2020-12-03 07:23:21,018 [main] INFO  blockmanagement.BlockManagerSafeMode (BlockManagerSafeMode.java:<init>(164)) - dfs.namenode.safemode.extension = 0
2020-12-03 07:23:21,019 [main] INFO  blockmanagement.BlockManager (BlockManager.java:<init>(581)) - defaultReplication         = 1
2020-12-03 07:23:21,019 [main] INFO  blockmanagement.BlockManager (BlockManager.java:<init>(582)) - maxReplication             = 512
2020-12-03 07:23:21,019 [main] INFO  blockmanagement.BlockManager (BlockManager.java:<init>(583)) - minReplication             = 1
2020-12-03 07:23:21,019 [main] INFO  blockmanagement.BlockManager (BlockManager.java:<init>(584)) - maxReplicationStreams      = 2
2020-12-03 07:23:21,020 [main] INFO  blockmanagement.BlockManager (BlockManager.java:<init>(585)) - redundancyRecheckInterval  = 3000ms
2020-12-03 07:23:21,020 [main] INFO  blockmanagement.BlockManager (BlockManager.java:<init>(586)) - encryptDataTransfer        = false
2020-12-03 07:23:21,021 [main] INFO  blockmanagement.BlockManager (BlockManager.java:<init>(587)) - maxNumBlocksToLog          = 1000
2020-12-03 07:23:21,021 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(395)) - Computing capacity for map INodeMap
2020-12-03 07:23:21,022 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(396)) - VM type       = 64-bit
2020-12-03 07:23:21,022 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(397)) - 1.0% max memory 1.8 GB = 18.2 MB
2020-12-03 07:23:21,022 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(402)) - capacity      = 2^21 = 2097152 entries
2020-12-03 07:23:21,025 [main] INFO  namenode.FSDirectory (FSDirectory.java:<init>(290)) - ACLs enabled? false
2020-12-03 07:23:21,025 [main] INFO  namenode.FSDirectory (FSDirectory.java:<init>(294)) - POSIX ACL inheritance enabled? true
2020-12-03 07:23:21,025 [main] INFO  namenode.FSDirectory (FSDirectory.java:<init>(298)) - XAttrs enabled? true
2020-12-03 07:23:21,026 [main] INFO  namenode.NameNode (FSDirectory.java:<init>(362)) - Caching file names occurring more than 10 times
2020-12-03 07:23:21,026 [main] INFO  snapshot.SnapshotManager (SnapshotManager.java:<init>(124)) - Loaded config captureOpenFiles: false, skipCaptureAccessTimeOnlyChange: false, snapshotDiffAllowSnapRootDescendant: true, maxSnapshotLimit: 65536
2020-12-03 07:23:21,026 [main] INFO  snapshot.SnapshotManager (DirectoryDiffListFactory.java:init(43)) - SkipList is disabled
2020-12-03 07:23:21,026 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(395)) - Computing capacity for map cachedBlocks
2020-12-03 07:23:21,026 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(396)) - VM type       = 64-bit
2020-12-03 07:23:21,027 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(397)) - 0.25% max memory 1.8 GB = 4.6 MB
2020-12-03 07:23:21,027 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(402)) - capacity      = 2^19 = 524288 entries
2020-12-03 07:23:21,028 [main] INFO  metrics.TopMetrics (TopMetrics.java:logConf(76)) - NNTop conf: dfs.namenode.top.window.num.buckets = 10
2020-12-03 07:23:21,028 [main] INFO  metrics.TopMetrics (TopMetrics.java:logConf(78)) - NNTop conf: dfs.namenode.top.num.users = 10
2020-12-03 07:23:21,028 [main] INFO  metrics.TopMetrics (TopMetrics.java:logConf(80)) - NNTop conf: dfs.namenode.top.windows.minutes = 1,5,25
2020-12-03 07:23:21,029 [main] INFO  namenode.FSNamesystem (FSNamesystem.java:initRetryCache(996)) - Retry cache on namenode is enabled
2020-12-03 07:23:21,029 [main] INFO  namenode.FSNamesystem (FSNamesystem.java:initRetryCache(1004)) - Retry cache will use 0.03 of total heap and retry cache entry expiry time is 600000 millis
2020-12-03 07:23:21,029 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(395)) - Computing capacity for map NameNodeRetryCache
2020-12-03 07:23:21,029 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(396)) - VM type       = 64-bit
2020-12-03 07:23:21,030 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(397)) - 0.029999999329447746% max memory 1.8 GB = 559.3 KB
2020-12-03 07:23:21,030 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(402)) - capacity      = 2^16 = 65536 entries
2020-12-03 07:23:21,133 [main] INFO  common.Storage (Storage.java:tryLock(923)) - Lock on /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/name-0-1/in_use.lock acquired by nodename 9607@38432bcddbf1
2020-12-03 07:23:21,214 [main] INFO  common.Storage (Storage.java:tryLock(923)) - Lock on /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/name-0-2/in_use.lock acquired by nodename 9607@38432bcddbf1
2020-12-03 07:23:21,218 [main] INFO  namenode.FileJournalManager (FileJournalManager.java:recoverUnfinalizedSegments(428)) - Recovering unfinalized segments in /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/name-0-1/current
2020-12-03 07:23:21,219 [main] INFO  namenode.FileJournalManager (FileJournalManager.java:recoverUnfinalizedSegments(428)) - Recovering unfinalized segments in /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/name-0-2/current
2020-12-03 07:23:21,220 [main] INFO  namenode.FSImage (FSImage.java:loadFSImage(733)) - No edit log streams selected.
2020-12-03 07:23:21,220 [main] INFO  namenode.FSImage (FSImage.java:loadFSImageFile(797)) - Planning to load image: FSImageFile(file=/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/name-0-1/current/fsimage_0000000000000000000, cpktTxId=0000000000000000000)
2020-12-03 07:23:21,260 [main] INFO  namenode.FSImageFormatPBINode (FSImageFormatPBINode.java:loadINodeSection(234)) - Loading 1 INodes.
2020-12-03 07:23:21,269 [main] INFO  namenode.FSImageFormatProtobuf (FSImageFormatProtobuf.java:load(246)) - Loaded FSImage in 0 seconds.
2020-12-03 07:23:21,270 [main] INFO  namenode.FSImage (FSImage.java:loadFSImage(978)) - Loaded image for txid 0 from /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/name-0-1/current/fsimage_0000000000000000000
2020-12-03 07:23:21,277 [main] INFO  namenode.FSNamesystem (FSNamesystem.java:loadFSImage(1110)) - Need to save fs image? false (staleImage=false, haEnabled=false, isRollingUpgrade=false)
2020-12-03 07:23:21,278 [main] INFO  namenode.FSEditLog (FSEditLog.java:startLogSegment(1365)) - Starting log segment at 1
2020-12-03 07:23:21,509 [main] INFO  namenode.NameCache (NameCache.java:initialized(143)) - initialized with 0 entries 0 lookups
2020-12-03 07:23:21,510 [main] INFO  namenode.FSNamesystem (FSNamesystem.java:loadFromDisk(727)) - Finished loading FSImage in 478 msecs
2020-12-03 07:23:21,747 [main] INFO  namenode.NameNode (NameNodeRpcServer.java:<init>(448)) - RPC server is binding to localhost:0
2020-12-03 07:23:21,802 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 1000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2020-12-03 07:23:21,819 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1219)) - Starting Socket Reader #1 for port 0
2020-12-03 07:23:22,117 [Listener at localhost/35089] INFO  namenode.NameNode (NameNode.java:initialize(722)) - Clients are to use localhost:35089 to access this namenode/service.
2020-12-03 07:23:22,122 [Listener at localhost/35089] INFO  namenode.FSNamesystem (FSNamesystem.java:registerMBean(5090)) - Registered FSNamesystemState, ReplicatedBlocksState and ECBlockGroupsState MBeans.
2020-12-03 07:23:22,150 [Listener at localhost/35089] INFO  namenode.LeaseManager (LeaseManager.java:getNumUnderConstructionBlocks(171)) - Number of blocks under construction: 0
2020-12-03 07:23:22,152 [org.apache.hadoop.hdfs.server.blockmanagement.PendingReconstructionBlocks$PendingReconstructionMonitor@79da1ec0] DEBUG blockmanagement.BlockManager (PendingReconstructionBlocks.java:pendingReconstructionCheck(261)) - PendingReconstructionMonitor checking Q
2020-12-03 07:23:22,163 [Listener at localhost/35089] INFO  blockmanagement.BlockManager (BlockManager.java:initializeReplQueues(4922)) - initializing replication queues
2020-12-03 07:23:22,164 [Listener at localhost/35089] INFO  hdfs.StateChange (BlockManagerSafeMode.java:leaveSafeMode(400)) - STATE* Leaving safe mode after 0 secs
2020-12-03 07:23:22,164 [Listener at localhost/35089] INFO  hdfs.StateChange (BlockManagerSafeMode.java:leaveSafeMode(406)) - STATE* Network topology has 0 racks and 0 datanodes
2020-12-03 07:23:22,165 [Listener at localhost/35089] INFO  hdfs.StateChange (BlockManagerSafeMode.java:leaveSafeMode(408)) - STATE* UnderReplicatedBlocks has 0 blocks
2020-12-03 07:23:22,169 [Reconstruction Queue Initializer] INFO  blockmanagement.BlockManager (BlockManager.java:processMisReplicatesAsync(3585)) - Total number of blocks            = 0
2020-12-03 07:23:22,169 [Reconstruction Queue Initializer] INFO  blockmanagement.BlockManager (BlockManager.java:processMisReplicatesAsync(3586)) - Number of invalid blocks          = 0
2020-12-03 07:23:22,169 [Reconstruction Queue Initializer] INFO  blockmanagement.BlockManager (BlockManager.java:processMisReplicatesAsync(3587)) - Number of under-replicated blocks = 0
2020-12-03 07:23:22,169 [Reconstruction Queue Initializer] INFO  blockmanagement.BlockManager (BlockManager.java:processMisReplicatesAsync(3588)) - Number of  over-replicated blocks = 0
2020-12-03 07:23:22,169 [Reconstruction Queue Initializer] INFO  blockmanagement.BlockManager (BlockManager.java:processMisReplicatesAsync(3590)) - Number of blocks being written    = 0
2020-12-03 07:23:22,170 [Reconstruction Queue Initializer] INFO  hdfs.StateChange (BlockManager.java:processMisReplicatesAsync(3593)) - STATE* Replication Queue initialization scan for invalid, over- and under-replicated blocks completed in 5 msec
2020-12-03 07:23:22,202 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1460)) - IPC Server Responder: starting
2020-12-03 07:23:22,202 [IPC Server listener on 0] INFO  ipc.Server (Server.java:run(1298)) - IPC Server listener on 0: starting
2020-12-03 07:23:22,209 [Listener at localhost/35089] INFO  namenode.NameNode (NameNode.java:startCommonServices(828)) - NameNode RPC up at: localhost/127.0.0.1:35089
2020-12-03 07:23:22,214 [Listener at localhost/35089] INFO  namenode.FSNamesystem (FSNamesystem.java:startActiveServices(1222)) - Starting services required for active state
2020-12-03 07:23:22,214 [Listener at localhost/35089] INFO  namenode.FSDirectory (FSDirectory.java:updateCountForQuota(777)) - Initializing quota with 4 thread(s)
2020-12-03 07:23:22,225 [Listener at localhost/35089] INFO  namenode.FSDirectory (FSDirectory.java:updateCountForQuota(786)) - Quota initialization completed in 10 milliseconds
name space=1
storage space=0
storage types=RAM_DISK=0, SSD=0, DISK=0, ARCHIVE=0, PROVIDED=0
2020-12-03 07:23:22,231 [CacheReplicationMonitor(810751973)] INFO  blockmanagement.CacheReplicationMonitor (CacheReplicationMonitor.java:run(160)) - Starting CacheReplicationMonitor with interval 30000 milliseconds
2020-12-03 07:23:22,237 [Listener at localhost/35089] INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:startDataNodes(1659)) - Starting DataNode 0 with dfs.datanode.data.dir: [DISK]file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1,[DISK]file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2
2020-12-03 07:23:22,297 [Listener at localhost/35089] INFO  checker.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(137)) - Scheduling a check for [DISK]file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1
2020-12-03 07:23:22,335 [Listener at localhost/35089] INFO  checker.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(137)) - Scheduling a check for [DISK]file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2
2020-12-03 07:23:22,385 [Listener at localhost/35089] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - DataNode metrics system started (again)
2020-12-03 07:23:22,393 [Listener at localhost/35089] INFO  common.Util (Util.java:isDiskStatsEnabled(395)) - dfs.datanode.fileio.profiling.sampling.percentage set to 0. Disabling file IO profiling
2020-12-03 07:23:22,404 [Listener at localhost/35089] INFO  datanode.BlockScanner (BlockScanner.java:<init>(184)) - Initialized block scanner with targetBytesPerSec 1048576
2020-12-03 07:23:22,410 [Listener at localhost/35089] DEBUG datanode.DataNode (DataNode.java:<init>(493)) - File descriptor passing was not configured.
2020-12-03 07:23:22,411 [Listener at localhost/35089] INFO  datanode.DataNode (DataNode.java:<init>(500)) - Configured hostname is 127.0.0.1
2020-12-03 07:23:22,413 [Listener at localhost/35089] INFO  common.Util (Util.java:isDiskStatsEnabled(395)) - dfs.datanode.fileio.profiling.sampling.percentage set to 0. Disabling file IO profiling
2020-12-03 07:23:22,419 [Listener at localhost/35089] INFO  datanode.DataNode (DataNode.java:startDataNode(1400)) - Starting DataNode with maxLockedMemory = 0
2020-12-03 07:23:22,431 [Listener at localhost/35089] INFO  datanode.DataNode (DataNode.java:initDataXceiver(1148)) - Opened streaming server at /127.0.0.1:46659
2020-12-03 07:23:22,433 [Listener at localhost/35089] INFO  datanode.DataNode (DataXceiverServer.java:<init>(78)) - Balancing bandwidth is 10485760 bytes/s
2020-12-03 07:23:22,433 [Listener at localhost/35089] INFO  datanode.DataNode (DataXceiverServer.java:<init>(79)) - Number threads for balancing is 50
2020-12-03 07:23:22,457 [Listener at localhost/35089] INFO  http.HttpServer2 (HttpServer2.java:getWebAppsPath(1072)) - Web server is in development mode. Resources will be read from the source tree.
2020-12-03 07:23:22,461 [Listener at localhost/35089] INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2020-12-03 07:23:22,462 [Listener at localhost/35089] INFO  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(81)) - Http request log for http.requests.datanode is not defined
2020-12-03 07:23:22,463 [Listener at localhost/35089] INFO  http.HttpServer2 (HttpServer2.java:getWebAppsPath(1072)) - Web server is in development mode. Resources will be read from the source tree.
2020-12-03 07:23:22,467 [Listener at localhost/35089] INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(990)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2020-12-03 07:23:22,468 [Listener at localhost/35089] INFO  http.HttpServer2 (HttpServer2.java:addFilter(963)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context datanode
2020-12-03 07:23:22,468 [Listener at localhost/35089] INFO  http.HttpServer2 (HttpServer2.java:addFilter(973)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2020-12-03 07:23:22,469 [Listener at localhost/35089] INFO  http.HttpServer2 (HttpServer2.java:addFilter(973)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2020-12-03 07:23:22,474 [Listener at localhost/35089] INFO  http.HttpServer2 (HttpServer2.java:bindListener(1206)) - Jetty bound to port 46521
2020-12-03 07:23:22,474 [Listener at localhost/35089] INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2020-12-03 07:23:22,477 [Listener at localhost/35089] INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@3185fa6b{/logs,file:///root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/log/,AVAILABLE}
2020-12-03 07:23:22,478 [Listener at localhost/35089] INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@5b58ed3c{/static,file:///root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/src/main/webapps/static/,AVAILABLE}
2020-12-03 07:23:22,489 [Listener at localhost/35089] INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@d5ae57e{/,file:///root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/src/main/webapps/datanode/,AVAILABLE}{/datanode}
2020-12-03 07:23:22,490 [Listener at localhost/35089] INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@68759011{HTTP/1.1,[http/1.1]}{localhost:46521}
2020-12-03 07:23:22,491 [Listener at localhost/35089] INFO  server.Server (Server.java:doStart(419)) - Started @5884ms
2020-12-03 07:23:23,186 [Listener at localhost/35089] INFO  web.DatanodeHttpServer (DatanodeHttpServer.java:start(255)) - Listening HTTP traffic on /127.0.0.1:42682
2020-12-03 07:23:23,189 [org.apache.hadoop.util.JvmPauseMonitor$Monitor@4628b1d3] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2020-12-03 07:23:23,191 [Listener at localhost/35089] INFO  datanode.DataNode (DataNode.java:startDataNode(1428)) - dnUserName = root
2020-12-03 07:23:23,191 [Listener at localhost/35089] INFO  datanode.DataNode (DataNode.java:startDataNode(1429)) - supergroup = supergroup
2020-12-03 07:23:23,223 [Listener at localhost/35089] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 5000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2020-12-03 07:23:23,225 [Socket Reader #1 for port 0] INFO  ipc.Server (Server.java:run(1219)) - Starting Socket Reader #1 for port 0
2020-12-03 07:23:23,233 [Listener at localhost/38521] INFO  datanode.DataNode (DataNode.java:initIpcServer(1034)) - Opened IPC server at /127.0.0.1:38521
2020-12-03 07:23:23,257 [Listener at localhost/38521] DEBUG datanode.DataNode (ErasureCodingWorker.java:initializeStripedReadThreadPool(76)) - Using striped reads
2020-12-03 07:23:23,260 [Listener at localhost/38521] DEBUG datanode.DataNode (ErasureCodingWorker.java:initializeStripedBlkReconstructionThreadPool(107)) - Using striped block reconstruction; pool threads=8
2020-12-03 07:23:23,263 [Listener at localhost/38521] INFO  datanode.DataNode (BlockPoolManager.java:refreshNamenodes(149)) - Refresh request received for nameservices: null
2020-12-03 07:23:23,266 [Listener at localhost/38521] INFO  datanode.DataNode (BlockPoolManager.java:doRefreshNamenodes(210)) - Starting BPOfferServices for nameservices: <default>
2020-12-03 07:23:23,280 [Thread-59] INFO  datanode.DataNode (BPServiceActor.java:run(817)) - Block pool <registering> (Datanode Uuid unassigned) service to localhost/127.0.0.1:35089 starting to offer service
2020-12-03 07:23:23,296 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1460)) - IPC Server Responder: starting
2020-12-03 07:23:23,296 [IPC Server listener on 0] INFO  ipc.Server (Server.java:run(1298)) - IPC Server listener on 0: starting
2020-12-03 07:23:23,320 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSClient.java:<init>(318)) - Sets dfs.client.block.write.replace-datanode-on-failure.min-replication to 0
2020-12-03 07:23:23,624 [Thread-59] DEBUG datanode.DataNode (BPServiceActor.java:retrieveNamespaceInfo(232)) - Block pool <registering> (Datanode Uuid unassigned) service to localhost/127.0.0.1:35089 received versionRequest response: lv=-65;cid=testClusterID;nsid=200687926;c=1606980199510;bpid=BP-2057880481-172.17.0.10-1606980199510
2020-12-03 07:23:23,632 [Thread-59] INFO  datanode.DataNode (BPOfferService.java:verifyAndSetNamespaceInfo(378)) - Acknowledging ACTIVE Namenode during handshakeBlock pool <registering> (Datanode Uuid unassigned) service to localhost/127.0.0.1:35089
2020-12-03 07:23:23,635 [Thread-59] INFO  common.Storage (DataStorage.java:getParallelVolumeLoadThreadsNum(354)) - Using 2 threads to upgrade data directories (dfs.datanode.parallel.volumes.load.threads.num=2, dataDirs=2)
2020-12-03 07:23:23,688 [Thread-59] INFO  common.Storage (Storage.java:tryLock(923)) - Lock on /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/in_use.lock acquired by nodename 9607@38432bcddbf1
2020-12-03 07:23:23,689 [Thread-59] INFO  common.Storage (DataStorage.java:loadStorageDirectory(282)) - Storage directory with location [DISK]file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1 is not formatted for namespace 200687926. Formatting...
2020-12-03 07:23:23,690 [Thread-59] INFO  common.Storage (DataStorage.java:createStorageID(160)) - Generated new storageID DS-86c38d19-e1c7-408b-beec-a26b98ac3f35 for directory /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1 
2020-12-03 07:23:23,853 [Thread-59] INFO  common.Storage (Storage.java:tryLock(923)) - Lock on /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/in_use.lock acquired by nodename 9607@38432bcddbf1
2020-12-03 07:23:23,853 [Thread-59] INFO  common.Storage (DataStorage.java:loadStorageDirectory(282)) - Storage directory with location [DISK]file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2 is not formatted for namespace 200687926. Formatting...
2020-12-03 07:23:23,854 [Thread-59] INFO  common.Storage (DataStorage.java:createStorageID(160)) - Generated new storageID DS-c636ee3f-1da8-4dc7-9587-a6f1cdb36618 for directory /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2 
2020-12-03 07:23:23,929 [Thread-59] INFO  common.Storage (BlockPoolSliceStorage.java:recoverTransitionRead(251)) - Analyzing storage directories for bpid BP-2057880481-172.17.0.10-1606980199510
2020-12-03 07:23:23,930 [Thread-59] INFO  common.Storage (Storage.java:lock(882)) - Locking is disabled for /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-2057880481-172.17.0.10-1606980199510
2020-12-03 07:23:23,930 [Thread-59] INFO  common.Storage (BlockPoolSliceStorage.java:loadStorageDirectory(168)) - Block pool storage directory for location [DISK]file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1 and block pool id BP-2057880481-172.17.0.10-1606980199510 is not formatted. Formatting ...
2020-12-03 07:23:23,931 [Thread-59] INFO  common.Storage (BlockPoolSliceStorage.java:format(280)) - Formatting block pool BP-2057880481-172.17.0.10-1606980199510 directory /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-2057880481-172.17.0.10-1606980199510/current
2020-12-03 07:23:23,944 [IPC Server handler 0 on default port 35089] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8074)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=datanodeReport	src=null	dst=null	perm=null	proto=rpc
2020-12-03 07:23:23,954 [Listener at localhost/38521] INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:shouldWait(2782)) - dnInfo.length != numDataNodes
2020-12-03 07:23:23,954 [Listener at localhost/38521] INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:waitActive(2703)) - Waiting for cluster to become active
2020-12-03 07:23:24,024 [Thread-59] INFO  common.Storage (BlockPoolSliceStorage.java:recoverTransitionRead(251)) - Analyzing storage directories for bpid BP-2057880481-172.17.0.10-1606980199510
2020-12-03 07:23:24,025 [Thread-59] INFO  common.Storage (Storage.java:lock(882)) - Locking is disabled for /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-2057880481-172.17.0.10-1606980199510
2020-12-03 07:23:24,028 [Thread-59] INFO  common.Storage (BlockPoolSliceStorage.java:loadStorageDirectory(168)) - Block pool storage directory for location [DISK]file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2 and block pool id BP-2057880481-172.17.0.10-1606980199510 is not formatted. Formatting ...
2020-12-03 07:23:24,028 [Thread-59] INFO  common.Storage (BlockPoolSliceStorage.java:format(280)) - Formatting block pool BP-2057880481-172.17.0.10-1606980199510 directory /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-2057880481-172.17.0.10-1606980199510/current
2020-12-03 07:23:24,057 [IPC Server handler 2 on default port 35089] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8074)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=datanodeReport	src=null	dst=null	perm=null	proto=rpc
2020-12-03 07:23:24,058 [Listener at localhost/38521] INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:shouldWait(2782)) - dnInfo.length != numDataNodes
2020-12-03 07:23:24,059 [Listener at localhost/38521] INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:waitActive(2703)) - Waiting for cluster to become active
2020-12-03 07:23:24,106 [Thread-59] INFO  datanode.DataNode (DataNode.java:initStorage(1746)) - Setting up storage: nsid=200687926;bpid=BP-2057880481-172.17.0.10-1606980199510;lv=-57;nsInfo=lv=-65;cid=testClusterID;nsid=200687926;c=1606980199510;bpid=BP-2057880481-172.17.0.10-1606980199510;dnuuid=null
2020-12-03 07:23:24,161 [IPC Server handler 4 on default port 35089] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8074)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=datanodeReport	src=null	dst=null	perm=null	proto=rpc
2020-12-03 07:23:24,162 [Listener at localhost/38521] INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:shouldWait(2782)) - dnInfo.length != numDataNodes
2020-12-03 07:23:24,162 [Listener at localhost/38521] INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:waitActive(2703)) - Waiting for cluster to become active
2020-12-03 07:23:24,179 [Thread-59] INFO  datanode.DataNode (DataNode.java:checkDatanodeUuid(1546)) - Generated and persisted new Datanode UUID 92140061-a997-4f98-95c8-65cba4629fb7
2020-12-03 07:23:24,265 [IPC Server handler 1 on default port 35089] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8074)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=datanodeReport	src=null	dst=null	perm=null	proto=rpc
2020-12-03 07:23:24,267 [Listener at localhost/38521] INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:shouldWait(2782)) - dnInfo.length != numDataNodes
2020-12-03 07:23:24,267 [Listener at localhost/38521] INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:waitActive(2703)) - Waiting for cluster to become active
2020-12-03 07:23:24,335 [Thread-59] INFO  impl.FsDatasetImpl (FsVolumeList.java:addVolume(304)) - Added new volume: DS-86c38d19-e1c7-408b-beec-a26b98ac3f35
2020-12-03 07:23:24,337 [Thread-59] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:addVolume(450)) - Added volume - [DISK]file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1, StorageType: DISK
2020-12-03 07:23:24,340 [Thread-59] INFO  impl.FsDatasetImpl (FsVolumeList.java:addVolume(304)) - Added new volume: DS-c636ee3f-1da8-4dc7-9587-a6f1cdb36618
2020-12-03 07:23:24,342 [Thread-59] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:addVolume(450)) - Added volume - [DISK]file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2, StorageType: DISK
2020-12-03 07:23:24,348 [Thread-59] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:registerMBean(2280)) - Registered FSDatasetState MBean
2020-12-03 07:23:24,358 [Thread-59] INFO  checker.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(137)) - Scheduling a check for /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1
2020-12-03 07:23:24,369 [Thread-59] INFO  checker.DatasetVolumeChecker (DatasetVolumeChecker.java:checkAllVolumes(222)) - Scheduled health check for volume /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1
2020-12-03 07:23:24,369 [IPC Server handler 0 on default port 35089] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8074)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=datanodeReport	src=null	dst=null	perm=null	proto=rpc
2020-12-03 07:23:24,370 [Listener at localhost/38521] INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:shouldWait(2782)) - dnInfo.length != numDataNodes
2020-12-03 07:23:24,370 [Listener at localhost/38521] INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:waitActive(2703)) - Waiting for cluster to become active
2020-12-03 07:23:24,371 [Thread-59] INFO  checker.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(137)) - Scheduling a check for /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2
2020-12-03 07:23:24,371 [Thread-59] INFO  checker.DatasetVolumeChecker (DatasetVolumeChecker.java:checkAllVolumes(222)) - Scheduled health check for volume /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2
2020-12-03 07:23:24,372 [Thread-59] DEBUG datanode.DataNode (DataNode.java:checkDiskError(3390)) - checkDiskError encountered no failures
2020-12-03 07:23:24,372 [Thread-59] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:addBlockPool(2791)) - Adding block pool BP-2057880481-172.17.0.10-1606980199510
2020-12-03 07:23:24,373 [Thread-117] INFO  impl.FsDatasetImpl (FsVolumeList.java:run(406)) - Scanning block pool BP-2057880481-172.17.0.10-1606980199510 on volume /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1...
2020-12-03 07:23:24,373 [Thread-118] INFO  impl.FsDatasetImpl (FsVolumeList.java:run(406)) - Scanning block pool BP-2057880481-172.17.0.10-1606980199510 on volume /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2...
2020-12-03 07:23:24,414 [Thread-117] INFO  impl.FsDatasetImpl (FsVolumeList.java:run(411)) - Time taken to scan block pool BP-2057880481-172.17.0.10-1606980199510 on /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1: 41ms
2020-12-03 07:23:24,417 [Thread-118] INFO  impl.FsDatasetImpl (FsVolumeList.java:run(411)) - Time taken to scan block pool BP-2057880481-172.17.0.10-1606980199510 on /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2: 43ms
2020-12-03 07:23:24,418 [Thread-59] INFO  impl.FsDatasetImpl (FsVolumeList.java:addBlockPool(431)) - Total time to scan all replicas for block pool BP-2057880481-172.17.0.10-1606980199510: 46ms
2020-12-03 07:23:24,421 [Thread-121] INFO  impl.FsDatasetImpl (FsVolumeList.java:run(199)) - Adding replicas to map for block pool BP-2057880481-172.17.0.10-1606980199510 on volume /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1...
2020-12-03 07:23:24,421 [Thread-122] INFO  impl.FsDatasetImpl (FsVolumeList.java:run(199)) - Adding replicas to map for block pool BP-2057880481-172.17.0.10-1606980199510 on volume /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2...
2020-12-03 07:23:24,421 [Thread-121] INFO  impl.BlockPoolSlice (BlockPoolSlice.java:readReplicasFromCache(876)) - Replica Cache file: /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-2057880481-172.17.0.10-1606980199510/current/replicas doesn't exist 
2020-12-03 07:23:24,421 [Thread-122] INFO  impl.BlockPoolSlice (BlockPoolSlice.java:readReplicasFromCache(876)) - Replica Cache file: /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-2057880481-172.17.0.10-1606980199510/current/replicas doesn't exist 
2020-12-03 07:23:24,423 [Thread-121] INFO  impl.FsDatasetImpl (FsVolumeList.java:run(204)) - Time to add replicas to map for block pool BP-2057880481-172.17.0.10-1606980199510 on volume /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1: 2ms
2020-12-03 07:23:24,424 [Thread-122] INFO  impl.FsDatasetImpl (FsVolumeList.java:run(204)) - Time to add replicas to map for block pool BP-2057880481-172.17.0.10-1606980199510 on volume /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2: 3ms
2020-12-03 07:23:24,424 [Thread-59] INFO  impl.FsDatasetImpl (FsVolumeList.java:getAllVolumesMap(225)) - Total time to add all replicas to map for block pool BP-2057880481-172.17.0.10-1606980199510: 4ms
2020-12-03 07:23:24,426 [VolumeScannerThread(/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1)] INFO  datanode.VolumeScanner (VolumeScanner.java:findNextUsableBlockIter(381)) - Now scanning bpid BP-2057880481-172.17.0.10-1606980199510 on volume /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1
2020-12-03 07:23:24,427 [VolumeScannerThread(/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2)] INFO  datanode.VolumeScanner (VolumeScanner.java:findNextUsableBlockIter(381)) - Now scanning bpid BP-2057880481-172.17.0.10-1606980199510 on volume /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2
2020-12-03 07:23:24,429 [VolumeScannerThread(/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2)] INFO  datanode.VolumeScanner (VolumeScanner.java:runLoop(539)) - VolumeScanner(/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2, DS-c636ee3f-1da8-4dc7-9587-a6f1cdb36618): finished scanning block pool BP-2057880481-172.17.0.10-1606980199510
2020-12-03 07:23:24,429 [VolumeScannerThread(/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1)] INFO  datanode.VolumeScanner (VolumeScanner.java:runLoop(539)) - VolumeScanner(/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1, DS-86c38d19-e1c7-408b-beec-a26b98ac3f35): finished scanning block pool BP-2057880481-172.17.0.10-1606980199510
2020-12-03 07:23:24,469 [VolumeScannerThread(/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2)] INFO  datanode.VolumeScanner (VolumeScanner.java:findNextUsableBlockIter(398)) - VolumeScanner(/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2, DS-c636ee3f-1da8-4dc7-9587-a6f1cdb36618): no suitable block pools found to scan.  Waiting 1814399957 ms.
2020-12-03 07:23:24,469 [VolumeScannerThread(/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1)] INFO  datanode.VolumeScanner (VolumeScanner.java:findNextUsableBlockIter(398)) - VolumeScanner(/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1, DS-86c38d19-e1c7-408b-beec-a26b98ac3f35): no suitable block pools found to scan.  Waiting 1814399957 ms.
2020-12-03 07:23:24,473 [IPC Server handler 2 on default port 35089] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8074)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=datanodeReport	src=null	dst=null	perm=null	proto=rpc
2020-12-03 07:23:24,474 [Listener at localhost/38521] INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:shouldWait(2782)) - dnInfo.length != numDataNodes
2020-12-03 07:23:24,474 [Listener at localhost/38521] INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:waitActive(2703)) - Waiting for cluster to become active
2020-12-03 07:23:24,479 [Thread-59] INFO  datanode.DirectoryScanner (DirectoryScanner.java:start(284)) - Periodic Directory Tree Verification scan starting at 12/3/20 9:34 AM with interval of 21600000ms
2020-12-03 07:23:24,494 [BP-2057880481-172.17.0.10-1606980199510 heartbeating to localhost/127.0.0.1:35089] INFO  datanode.DataNode (BPServiceActor.java:register(767)) - Block pool BP-2057880481-172.17.0.10-1606980199510 (Datanode Uuid 92140061-a997-4f98-95c8-65cba4629fb7) service to localhost/127.0.0.1:35089 beginning handshake with NN
2020-12-03 07:23:24,511 [IPC Server handler 4 on default port 35089] INFO  hdfs.StateChange (DatanodeManager.java:registerDatanode(1042)) - BLOCK* registerDatanode: from DatanodeRegistration(127.0.0.1:46659, datanodeUuid=92140061-a997-4f98-95c8-65cba4629fb7, infoPort=42682, infoSecurePort=0, ipcPort=38521, storageInfo=lv=-57;cid=testClusterID;nsid=200687926;c=1606980199510) storage 92140061-a997-4f98-95c8-65cba4629fb7
2020-12-03 07:23:24,513 [IPC Server handler 4 on default port 35089] INFO  net.NetworkTopology (NetworkTopology.java:add(145)) - Adding a new node: /default-rack/127.0.0.1:46659
2020-12-03 07:23:24,514 [IPC Server handler 4 on default port 35089] INFO  blockmanagement.BlockReportLeaseManager (BlockReportLeaseManager.java:registerNode(204)) - Registered DN 92140061-a997-4f98-95c8-65cba4629fb7 (127.0.0.1:46659).
2020-12-03 07:23:24,521 [BP-2057880481-172.17.0.10-1606980199510 heartbeating to localhost/127.0.0.1:35089] INFO  datanode.DataNode (BPServiceActor.java:register(786)) - Block pool Block pool BP-2057880481-172.17.0.10-1606980199510 (Datanode Uuid 92140061-a997-4f98-95c8-65cba4629fb7) service to localhost/127.0.0.1:35089 successfully registered with NN
2020-12-03 07:23:24,522 [BP-2057880481-172.17.0.10-1606980199510 heartbeating to localhost/127.0.0.1:35089] INFO  datanode.DataNode (BPServiceActor.java:offerService(616)) - For namenode localhost/127.0.0.1:35089 using BLOCKREPORT_INTERVAL of 21600000msec CACHEREPORT_INTERVAL of 10000msec Initial delay: 0msec; heartBeatInterval=3000
2020-12-03 07:23:24,523 [BP-2057880481-172.17.0.10-1606980199510 heartbeating to localhost/127.0.0.1:35089] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(497)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-2057880481-172.17.0.10-1606980199510 (Datanode Uuid 92140061-a997-4f98-95c8-65cba4629fb7) service to localhost/127.0.0.1:35089
2020-12-03 07:23:24,545 [IPC Server handler 6 on default port 35089] INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateStorage(987)) - Adding new storage ID DS-86c38d19-e1c7-408b-beec-a26b98ac3f35 for DN 127.0.0.1:46659
2020-12-03 07:23:24,546 [IPC Server handler 6 on default port 35089] INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateStorage(987)) - Adding new storage ID DS-c636ee3f-1da8-4dc7-9587-a6f1cdb36618 for DN 127.0.0.1:46659
2020-12-03 07:23:24,577 [IPC Server handler 7 on default port 35089] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReport(1566)) - *BLOCK* NameNode.blockReport: from DatanodeRegistration(127.0.0.1:46659, datanodeUuid=92140061-a997-4f98-95c8-65cba4629fb7, infoPort=42682, infoSecurePort=0, ipcPort=38521, storageInfo=lv=-57;cid=testClusterID;nsid=200687926;c=1606980199510), reports.length=2
2020-12-03 07:23:24,583 [IPC Server handler 8 on default port 35089] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8074)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=datanodeReport	src=null	dst=null	perm=null	proto=rpc
2020-12-03 07:23:24,583 [Block report processor] INFO  BlockStateChange (BlockManager.java:processReport(2648)) - BLOCK* processReport 0x79511ddaf33226a8: Processing first storage report for DS-c636ee3f-1da8-4dc7-9587-a6f1cdb36618 from datanode 92140061-a997-4f98-95c8-65cba4629fb7
2020-12-03 07:23:24,585 [Block report processor] INFO  BlockStateChange (BlockManager.java:processReport(2677)) - BLOCK* processReport 0x79511ddaf33226a8: from storage DS-c636ee3f-1da8-4dc7-9587-a6f1cdb36618 node DatanodeRegistration(127.0.0.1:46659, datanodeUuid=92140061-a997-4f98-95c8-65cba4629fb7, infoPort=42682, infoSecurePort=0, ipcPort=38521, storageInfo=lv=-57;cid=testClusterID;nsid=200687926;c=1606980199510), blocks: 0, hasStaleStorage: true, processing time: 2 msecs, invalidatedBlocks: 0
2020-12-03 07:23:24,585 [Block report processor] INFO  BlockStateChange (BlockManager.java:processReport(2648)) - BLOCK* processReport 0x79511ddaf33226a8: Processing first storage report for DS-86c38d19-e1c7-408b-beec-a26b98ac3f35 from datanode 92140061-a997-4f98-95c8-65cba4629fb7
2020-12-03 07:23:24,586 [Block report processor] INFO  BlockStateChange (BlockManager.java:processReport(2677)) - BLOCK* processReport 0x79511ddaf33226a8: from storage DS-86c38d19-e1c7-408b-beec-a26b98ac3f35 node DatanodeRegistration(127.0.0.1:46659, datanodeUuid=92140061-a997-4f98-95c8-65cba4629fb7, infoPort=42682, infoSecurePort=0, ipcPort=38521, storageInfo=lv=-57;cid=testClusterID;nsid=200687926;c=1606980199510), blocks: 0, hasStaleStorage: false, processing time: 0 msecs, invalidatedBlocks: 0
2020-12-03 07:23:24,586 [IPC Server handler 7 on default port 35089] DEBUG blockmanagement.BlockManager (BlockManager.java:removeBRLeaseIfNeeded(2700)) - Processing RPC with index 0 out of total 1 RPCs in processReport 0x79511ddaf33226a8
2020-12-03 07:23:24,593 [Listener at localhost/38521] INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:waitActive(2758)) - Cluster is active
2020-12-03 07:23:24,602 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSClient.java:<init>(318)) - Sets dfs.client.block.write.replace-datanode-on-failure.min-replication to 0
2020-12-03 07:23:24,613 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSClient.java:create(1216)) - /simpleAppend.dat: masked={ masked: rw-r--r--, unmasked: rw-rw-rw- }
2020-12-03 07:23:24,615 [BP-2057880481-172.17.0.10-1606980199510 heartbeating to localhost/127.0.0.1:35089] INFO  datanode.DataNode (BPServiceActor.java:blockReport(424)) - Successfully sent block report 0x79511ddaf33226a8,  containing 2 storage report(s), of which we sent 2. The reports had 0 total blocks and used 1 RPC(s). This took 5 msec to generate and 49 msecs for RPC and NN processing. Got back one command: FinalizeCommand/5.
2020-12-03 07:23:24,615 [BP-2057880481-172.17.0.10-1606980199510 heartbeating to localhost/127.0.0.1:35089] INFO  datanode.DataNode (BPOfferService.java:processCommandFromActive(759)) - Got finalize command for block pool BP-2057880481-172.17.0.10-1606980199510
2020-12-03 07:23:24,633 [IPC Server handler 3 on default port 35089] DEBUG hdfs.StateChange (NameNodeRpcServer.java:create(774)) - *DIR* NameNode.create: file /simpleAppend.dat for DFSClient_NONMAPREDUCE_1712663744_1 at 127.0.0.1
2020-12-03 07:23:24,634 [IPC Server handler 3 on default port 35089] DEBUG hdfs.StateChange (FSNamesystem.java:startFileInt(2460)) - DIR* NameSystem.startFile: src=/simpleAppend.dat, holder=DFSClient_NONMAPREDUCE_1712663744_1, clientMachine=127.0.0.1, createParent=true, replication=1, createFlag=[CREATE, OVERWRITE], blockSize=1024, supportedVersions=[CryptoProtocolVersion{description='Encryption zones', version=2, unknownValue=null}]
2020-12-03 07:23:24,651 [IPC Server handler 3 on default port 35089] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addFile(579)) - DIR* addFile: simpleAppend.dat is added
2020-12-03 07:23:24,653 [IPC Server handler 3 on default port 35089] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:startFile(415)) - DIR* NameSystem.startFile: added /simpleAppend.dat inode 16386 DFSClient_NONMAPREDUCE_1712663744_1
2020-12-03 07:23:24,667 [IPC Server handler 3 on default port 35089] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8074)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=create	src=/simpleAppend.dat	dst=null	perm=root:supergroup:rw-r--r--	proto=rpc
2020-12-03 07:23:24,692 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/simpleAppend.dat, chunkSize=516, chunksPerPacket=126, packetSize=65016
Created file simpleAppend.dat
Writing 186 bytes to file /simpleAppend.dat
2020-12-03 07:23:24,711 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=0, src=/simpleAppend.dat, packetSize=65016, chunksPerPacket=126, bytesCurBlock=0, DFSOutputStream:block==null
2020-12-03 07:23:24,721 [IPC Server handler 9 on default port 35089] DEBUG hdfs.StateChange (FSNamesystem.java:getAdditionalBlock(2767)) - BLOCK* getAdditionalBlock: /simpleAppend.dat  inodeId 16386 for DFSClient_NONMAPREDUCE_1712663744_1
2020-12-03 07:23:24,733 [IPC Server handler 9 on default port 35089] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addBlock(524)) - DIR* FSDirectory.addBlock: /simpleAppend.dat with blk_1073741825_1001 block is added to the in-memory file system
2020-12-03 07:23:24,734 [IPC Server handler 9 on default port 35089] INFO  hdfs.StateChange (FSDirWriteFileOp.java:logAllocatedBlock(798)) - BLOCK* allocate blk_1073741825_1001, replicas=127.0.0.1:46659 for /simpleAppend.dat
2020-12-03 07:23:24,735 [IPC Server handler 9 on default port 35089] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistNewBlock(758)) - persistNewBlock: /simpleAppend.dat with new block blk_1073741825_1001, current total block count is 1
2020-12-03 07:23:24,759 [Thread-126] INFO  sasl.SaslDataTransferClient (SaslDataTransferClient.java:checkTrustAndSend(239)) - SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
2020-12-03 07:23:24,774 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@3276732] DEBUG datanode.DataNode (DataXceiver.java:<init>(154)) - Number of active connections is: 1
2020-12-03 07:23:24,834 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:47964 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1001]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(728)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_1712663744_1
  block  =BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1001, newGs=0, bytesRcvd=[0, 0]
  targets=[]; pipelineSize=1, srcDataNode=:0, pinning=false
2020-12-03 07:23:24,835 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:47964 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1001]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(734)) - isDatanode=false, isClient=true, isTransfer=false
2020-12-03 07:23:24,835 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:47964 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1001]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(736)) - writeBlock receive buf size 531128 tcp no delay true
2020-12-03 07:23:24,835 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:47964 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1001]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(747)) - Receiving BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1001 src: /127.0.0.1:47964 dest: /127.0.0.1:46659
2020-12-03 07:23:24,844 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:47964 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1001]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1001
 storageType=DISK, inAddr=/127.0.0.1:47964, myAddr=/127.0.0.1:46659
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_1712663744_1, srcDataNode=:0, datanode=127.0.0.1:46659
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-c636ee3f-1da8-4dc7-9587-a6f1cdb36618
2020-12-03 07:23:24,854 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:47964 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1001]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-2057880481-172.17.0.10-1606980199510/current/rbw/blk_1073741825 of size 0
2020-12-03 07:23:24,854 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:47964 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1001]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-2057880481-172.17.0.10-1606980199510/current/rbw/blk_1073741825_1001.meta of size 0
2020-12-03 07:23:24,872 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1001, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1001, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-12-03 07:23:24,884 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:47964 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1001]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1001: PacketHeader with packetLen=194 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 186

2020-12-03 07:23:24,886 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:47964 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1001]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1001, type=LAST_IN_PIPELINE: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=186, ackEnqueueNanoTime=141196661450338, ackStatus=SUCCESS)
2020-12-03 07:23:24,894 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:47964 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1001]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1001: PacketHeader with packetLen=4 header data: offsetInBlock: 186
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-12-03 07:23:24,895 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:47964 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1001]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1001
2020-12-03 07:23:24,895 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:47964 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1001]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1001, type=LAST_IN_PIPELINE: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=186, ackEnqueueNanoTime=141196670216346, ackStatus=SUCCESS)
2020-12-03 07:23:24,896 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1001, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1001, type=LAST_IN_PIPELINE, replyAck=seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:24,901 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1001, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:47964, dest: /127.0.0.1:46659, bytes: 186, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_1712663744_1, offset: 0, srvID: 92140061-a997-4f98-95c8-65cba4629fb7, blockid: BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1001, duration(ns): 25355985
2020-12-03 07:23:24,902 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1001, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1001, type=LAST_IN_PIPELINE, replyAck=seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:24,902 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1001, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1001, type=LAST_IN_PIPELINE terminating
2020-12-03 07:23:24,902 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:47964 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1001]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1001, type=LAST_IN_PIPELINE: closing
2020-12-03 07:23:24,909 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:47964 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1001]] DEBUG datanode.DataNode (DataXceiver.java:run(328)) - 127.0.0.1:46659:Number of active connections is: 2
2020-12-03 07:23:24,911 [IPC Server handler 1 on default port 35089] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(674)) - DIR* NameSystem.completeFile: /simpleAppend.dat for DFSClient_NONMAPREDUCE_1712663744_1
2020-12-03 07:23:24,915 [IPC Server handler 1 on default port 35089] INFO  namenode.FSNamesystem (FSNamesystem.java:checkBlocksComplete(2995)) - BLOCK* blk_1073741825_1001 is COMMITTED but not COMPLETE(numNodes= 0 <  minimum = 1) in file /simpleAppend.dat
2020-12-03 07:23:24,930 [IPC Server handler 0 on default port 35089] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1627)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:46659, datanodeUuid=92140061-a997-4f98-95c8-65cba4629fb7, infoPort=42682, infoSecurePort=0, ipcPort=38521, storageInfo=lv=-57;cid=testClusterID;nsid=200687926;c=1606980199510) 1 blocks.
2020-12-03 07:23:24,932 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(4021)) - Reported block blk_1073741825_1001 on 127.0.0.1:46659 size 186 replicaState = FINALIZED
2020-12-03 07:23:24,932 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(4044)) - In memory blockUCState = COMMITTED
2020-12-03 07:23:24,933 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3351)) - BLOCK* addStoredBlock: 127.0.0.1:46659 is added to blk_1073741825_1001 (size=186)
2020-12-03 07:23:24,934 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4154)) - BLOCK* block RECEIVED_BLOCK: blk_1073741825_1001 is received from 127.0.0.1:46659
2020-12-03 07:23:24,934 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4157)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:46659 receiving: 0, received: 1, deleted: 0
2020-12-03 07:23:25,162 [RedundancyMonitor] DEBUG BlockStateChange (BlockManager.java:computeReconstructionWorkForBlocks(1998)) - BLOCK* neededReconstruction = 0 pendingReconstruction = 0
2020-12-03 07:23:25,321 [IPC Server handler 2 on default port 35089] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(674)) - DIR* NameSystem.completeFile: /simpleAppend.dat for DFSClient_NONMAPREDUCE_1712663744_1
2020-12-03 07:23:25,322 [IPC Server handler 2 on default port 35089] DEBUG hdfs.StateChange (FSNamesystem.java:closeFile(4036)) - closeFile: /simpleAppend.dat with 1 blocks is persisted to the file system
2020-12-03 07:23:25,323 [IPC Server handler 2 on default port 35089] INFO  hdfs.StateChange (FSNamesystem.java:completeFile(2948)) - DIR* completeFile: /simpleAppend.dat is closed by DFSClient_NONMAPREDUCE_1712663744_1
Wrote and Closed first part of file.
Writing 186 bytes to file /simpleAppend.dat
2020-12-03 07:23:25,329 [IPC Server handler 4 on default port 35089] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(809)) - *DIR* NameNode.append: file /simpleAppend.dat for DFSClient_NONMAPREDUCE_1712663744_1 at 127.0.0.1
2020-12-03 07:23:25,329 [IPC Server handler 4 on default port 35089] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2710)) - DIR* NameSystem.appendFile: src=/simpleAppend.dat, holder=DFSClient_NONMAPREDUCE_1712663744_1, clientMachine=127.0.0.1
2020-12-03 07:23:25,339 [IPC Server handler 4 on default port 35089] DEBUG hdfs.StateChange (FSDirAppendOp.java:appendFile(154)) - DIR* NameSystem.appendFile: file /simpleAppend.dat for DFSClient_NONMAPREDUCE_1712663744_1 at 127.0.0.1 block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1001 block size 186
2020-12-03 07:23:25,339 [IPC Server handler 4 on default port 35089] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8074)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=append	src=/simpleAppend.dat	dst=null	perm=null	proto=rpc
2020-12-03 07:23:25,346 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/simpleAppend.dat, chunkSize=330, chunksPerPacket=1, packetSize=330
2020-12-03 07:23:25,346 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=0, src=/simpleAppend.dat, packetSize=330, chunksPerPacket=1, bytesCurBlock=186, DFSOutputStream:blk_1073741825_1001
2020-12-03 07:23:25,346 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/simpleAppend.dat, chunkSize=516, chunksPerPacket=1, packetSize=516
2020-12-03 07:23:25,347 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=1, src=/simpleAppend.dat, packetSize=516, chunksPerPacket=1, bytesCurBlock=512, DFSOutputStream:blk_1073741825_1001
2020-12-03 07:23:25,347 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/simpleAppend.dat, chunkSize=516, chunksPerPacket=1, packetSize=516
2020-12-03 07:23:25,361 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@3276732] DEBUG datanode.DataNode (DataXceiver.java:<init>(154)) - Number of active connections is: 1
2020-12-03 07:23:25,361 [Thread-131] INFO  sasl.SaslDataTransferClient (SaslDataTransferClient.java:checkTrustAndSend(239)) - SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
2020-12-03 07:23:25,363 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48118 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1001]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(728)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_1712663744_1
  block  =BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1001, newGs=1002, bytesRcvd=[186, 186]
  targets=[]; pipelineSize=1, srcDataNode=:0, pinning=false
2020-12-03 07:23:25,363 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48118 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1001]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(734)) - isDatanode=false, isClient=true, isTransfer=false
2020-12-03 07:23:25,364 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48118 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1001]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(736)) - writeBlock receive buf size 531128 tcp no delay true
2020-12-03 07:23:25,364 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48118 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1001]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(747)) - Receiving BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1001 src: /127.0.0.1:48118 dest: /127.0.0.1:46659
2020-12-03 07:23:25,364 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48118 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1001]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1001
 storageType=DISK, inAddr=/127.0.0.1:48118, myAddr=/127.0.0.1:46659
 stage=PIPELINE_SETUP_APPEND, newGs=1002, minBytesRcvd=186, maxBytesRcvd=186
 clientname=DFSClient_NONMAPREDUCE_1712663744_1, srcDataNode=:0, datanode=127.0.0.1:46659
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-86c38d19-e1c7-408b-beec-a26b98ac3f35
2020-12-03 07:23:25,365 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48118 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1001]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741825_1001, FINALIZED
  getNumBytes()     = 186
  getBytesOnDisk()  = 186
  getVisibleLength()= 186
  getVolume()       = /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1
  getBlockURI()     = file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-2057880481-172.17.0.10-1606980199510/current/finalized/subdir0/subdir0/blk_1073741825
2020-12-03 07:23:25,388 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48118 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1001]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-2057880481-172.17.0.10-1606980199510/current/rbw/blk_1073741825 of size 186
2020-12-03 07:23:25,388 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48118 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1001]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-2057880481-172.17.0.10-1606980199510/current/rbw/blk_1073741825_1002.meta of size 11
2020-12-03 07:23:25,394 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1002, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1002, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-12-03 07:23:25,398 [IPC Server handler 8 on default port 35089] INFO  namenode.FSNamesystem (FSNamesystem.java:updatePipeline(5430)) - updatePipeline(blk_1073741825_1001, newGS=1002, newLength=186, newNodes=[127.0.0.1:46659], client=DFSClient_NONMAPREDUCE_1712663744_1)
2020-12-03 07:23:25,399 [IPC Server handler 8 on default port 35089] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3891)) - BLOCK* removeStoredBlock: blk_1073741825_1002 from 127.0.0.1:46659
2020-12-03 07:23:25,401 [IPC Server handler 8 on default port 35089] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3935)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-86c38d19-e1c7-408b-beec-a26b98ac3f35:NORMAL:127.0.0.1:46659|RBW] of blk_1073741825_1001
2020-12-03 07:23:25,402 [IPC Server handler 8 on default port 35089] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistBlocks(111)) - persistBlocks: /simpleAppend.dat with 1 blocks is persisted to the file system
2020-12-03 07:23:25,402 [IPC Server handler 8 on default port 35089] INFO  namenode.FSNamesystem (FSNamesystem.java:updatePipeline(5448)) - updatePipeline(blk_1073741825_1001 => blk_1073741825_1002) success
2020-12-03 07:23:25,405 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48118 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1001]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1002: PacketHeader with packetLen=334 header data: offsetInBlock: 186
seqno: 0
lastPacketInBlock: false
dataLen: 326

2020-12-03 07:23:25,405 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48118 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1001]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1002: previous write did not end at the chunk boundary. onDiskLen=186
2020-12-03 07:23:25,405 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48118 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1001]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1002: sizePartialChunk=186, block offset=0, metafile offset=7
2020-12-03 07:23:25,407 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48118 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1001]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1002
2020-12-03 07:23:25,408 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48118 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1001]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 326, skip=0
2020-12-03 07:23:25,408 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48118 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1001]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1002, type=LAST_IN_PIPELINE: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=512, ackEnqueueNanoTime=141197183066756, ackStatus=SUCCESS)
2020-12-03 07:23:25,408 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48118 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1001]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1002: PacketHeader with packetLen=103 header data: offsetInBlock: 512
seqno: 1
lastPacketInBlock: false
dataLen: 95

2020-12-03 07:23:25,409 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48118 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1001]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1002, type=LAST_IN_PIPELINE: enqueue Packet(seqno=1, lastPacketInBlock=false, offsetInBlock=607, ackEnqueueNanoTime=141197184631443, ackStatus=SUCCESS)
2020-12-03 07:23:25,411 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1002, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1002, type=LAST_IN_PIPELINE, replyAck=seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:25,412 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1002, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1002, type=LAST_IN_PIPELINE, replyAck=seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:25,412 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1002, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1002, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-12-03 07:23:25,412 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48118 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1001]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1002: PacketHeader with packetLen=4 header data: offsetInBlock: 607
seqno: 2
lastPacketInBlock: true
dataLen: 0

2020-12-03 07:23:25,413 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48118 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1001]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1002
2020-12-03 07:23:25,413 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48118 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1001]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1002, type=LAST_IN_PIPELINE: enqueue Packet(seqno=2, lastPacketInBlock=true, offsetInBlock=607, ackEnqueueNanoTime=141197188043703, ackStatus=SUCCESS)
2020-12-03 07:23:25,415 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1002, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:48118, dest: /127.0.0.1:46659, bytes: 607, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_1712663744_1, offset: 0, srvID: 92140061-a997-4f98-95c8-65cba4629fb7, blockid: BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1002, duration(ns): 20383176
2020-12-03 07:23:25,416 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1002, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1002, type=LAST_IN_PIPELINE, replyAck=seqno: 2 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:25,416 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1002, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1002, type=LAST_IN_PIPELINE terminating
2020-12-03 07:23:25,416 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48118 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1001]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1002, type=LAST_IN_PIPELINE: closing
2020-12-03 07:23:25,417 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48118 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1001]] DEBUG datanode.DataNode (DataXceiver.java:run(328)) - 127.0.0.1:46659:Number of active connections is: 2
2020-12-03 07:23:25,425 [IPC Server handler 7 on default port 35089] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1627)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:46659, datanodeUuid=92140061-a997-4f98-95c8-65cba4629fb7, infoPort=42682, infoSecurePort=0, ipcPort=38521, storageInfo=lv=-57;cid=testClusterID;nsid=200687926;c=1606980199510) 1 blocks.
2020-12-03 07:23:25,426 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(4021)) - Reported block blk_1073741825_1002 on 127.0.0.1:46659 size 607 replicaState = FINALIZED
2020-12-03 07:23:25,426 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(4044)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-12-03 07:23:25,427 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3351)) - BLOCK* addStoredBlock: 127.0.0.1:46659 is added to blk_1073741825_1002 (size=186)
2020-12-03 07:23:25,427 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4154)) - BLOCK* block RECEIVED_BLOCK: blk_1073741825_1002 is received from 127.0.0.1:46659
2020-12-03 07:23:25,427 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4157)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:46659 receiving: 0, received: 1, deleted: 0
2020-12-03 07:23:25,431 [IPC Server handler 3 on default port 35089] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(674)) - DIR* NameSystem.completeFile: /simpleAppend.dat for DFSClient_NONMAPREDUCE_1712663744_1
2020-12-03 07:23:25,432 [IPC Server handler 3 on default port 35089] DEBUG hdfs.StateChange (FSNamesystem.java:closeFile(4036)) - closeFile: /simpleAppend.dat with 1 blocks is persisted to the file system
2020-12-03 07:23:25,432 [IPC Server handler 3 on default port 35089] INFO  hdfs.StateChange (FSNamesystem.java:completeFile(2948)) - DIR* completeFile: /simpleAppend.dat is closed by DFSClient_NONMAPREDUCE_1712663744_1
Wrote and Closed second part of file.
2020-12-03 07:23:25,436 [IPC Server handler 9 on default port 35089] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(809)) - *DIR* NameNode.append: file /simpleAppend.dat for DFSClient_NONMAPREDUCE_1712663744_1 at 127.0.0.1
2020-12-03 07:23:25,436 [IPC Server handler 9 on default port 35089] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2710)) - DIR* NameSystem.appendFile: src=/simpleAppend.dat, holder=DFSClient_NONMAPREDUCE_1712663744_1, clientMachine=127.0.0.1
2020-12-03 07:23:25,437 [IPC Server handler 9 on default port 35089] DEBUG hdfs.StateChange (FSDirAppendOp.java:appendFile(154)) - DIR* NameSystem.appendFile: file /simpleAppend.dat for DFSClient_NONMAPREDUCE_1712663744_1 at 127.0.0.1 block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1002 block size 607
2020-12-03 07:23:25,437 [IPC Server handler 9 on default port 35089] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8074)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=append	src=/simpleAppend.dat	dst=null	perm=null	proto=rpc
2020-12-03 07:23:25,439 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/simpleAppend.dat, chunkSize=421, chunksPerPacket=1, packetSize=421
Writing 9634 bytes to file /simpleAppend.dat
2020-12-03 07:23:25,440 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=0, src=/simpleAppend.dat, packetSize=421, chunksPerPacket=1, bytesCurBlock=607, DFSOutputStream:blk_1073741825_1002
2020-12-03 07:23:25,440 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/simpleAppend.dat, chunkSize=516, chunksPerPacket=1, packetSize=516
2020-12-03 07:23:25,446 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=2, src=/simpleAppend.dat, packetSize=516, chunksPerPacket=1, bytesCurBlock=0, DFSOutputStream:blk_1073741825_1002
2020-12-03 07:23:25,446 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/simpleAppend.dat, chunkSize=516, chunksPerPacket=1, packetSize=516
2020-12-03 07:23:25,447 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=3, src=/simpleAppend.dat, packetSize=516, chunksPerPacket=1, bytesCurBlock=512, DFSOutputStream:blk_1073741825_1002
2020-12-03 07:23:25,447 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/simpleAppend.dat, chunkSize=516, chunksPerPacket=1, packetSize=516
2020-12-03 07:23:25,448 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=5, src=/simpleAppend.dat, packetSize=516, chunksPerPacket=1, bytesCurBlock=0, DFSOutputStream:blk_1073741825_1002
2020-12-03 07:23:25,448 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/simpleAppend.dat, chunkSize=516, chunksPerPacket=1, packetSize=516
2020-12-03 07:23:25,448 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=6, src=/simpleAppend.dat, packetSize=516, chunksPerPacket=1, bytesCurBlock=512, DFSOutputStream:blk_1073741825_1002
2020-12-03 07:23:25,448 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/simpleAppend.dat, chunkSize=516, chunksPerPacket=1, packetSize=516
2020-12-03 07:23:25,448 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=8, src=/simpleAppend.dat, packetSize=516, chunksPerPacket=1, bytesCurBlock=0, DFSOutputStream:blk_1073741825_1002
2020-12-03 07:23:25,448 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/simpleAppend.dat, chunkSize=516, chunksPerPacket=1, packetSize=516
2020-12-03 07:23:25,448 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=9, src=/simpleAppend.dat, packetSize=516, chunksPerPacket=1, bytesCurBlock=512, DFSOutputStream:blk_1073741825_1002
2020-12-03 07:23:25,449 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/simpleAppend.dat, chunkSize=516, chunksPerPacket=1, packetSize=516
2020-12-03 07:23:25,449 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=11, src=/simpleAppend.dat, packetSize=516, chunksPerPacket=1, bytesCurBlock=0, DFSOutputStream:blk_1073741825_1002
2020-12-03 07:23:25,449 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/simpleAppend.dat, chunkSize=516, chunksPerPacket=1, packetSize=516
2020-12-03 07:23:25,449 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=12, src=/simpleAppend.dat, packetSize=516, chunksPerPacket=1, bytesCurBlock=512, DFSOutputStream:blk_1073741825_1002
2020-12-03 07:23:25,449 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@3276732] DEBUG datanode.DataNode (DataXceiver.java:<init>(154)) - Number of active connections is: 1
2020-12-03 07:23:25,449 [Thread-137] INFO  sasl.SaslDataTransferClient (SaslDataTransferClient.java:checkTrustAndSend(239)) - SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
2020-12-03 07:23:25,449 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/simpleAppend.dat, chunkSize=516, chunksPerPacket=1, packetSize=516
2020-12-03 07:23:25,450 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=14, src=/simpleAppend.dat, packetSize=516, chunksPerPacket=1, bytesCurBlock=0, DFSOutputStream:blk_1073741825_1002
2020-12-03 07:23:25,450 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/simpleAppend.dat, chunkSize=516, chunksPerPacket=1, packetSize=516
2020-12-03 07:23:25,450 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=15, src=/simpleAppend.dat, packetSize=516, chunksPerPacket=1, bytesCurBlock=512, DFSOutputStream:blk_1073741825_1002
2020-12-03 07:23:25,450 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/simpleAppend.dat, chunkSize=516, chunksPerPacket=1, packetSize=516
2020-12-03 07:23:25,450 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48152 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1002]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(728)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_1712663744_1
  block  =BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1002, newGs=1003, bytesRcvd=[607, 607]
  targets=[]; pipelineSize=1, srcDataNode=:0, pinning=false
2020-12-03 07:23:25,451 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=17, src=/simpleAppend.dat, packetSize=516, chunksPerPacket=1, bytesCurBlock=0, DFSOutputStream:blk_1073741825_1002
2020-12-03 07:23:25,451 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48152 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1002]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(734)) - isDatanode=false, isClient=true, isTransfer=false
2020-12-03 07:23:25,451 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/simpleAppend.dat, chunkSize=516, chunksPerPacket=1, packetSize=516
2020-12-03 07:23:25,451 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48152 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1002]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(736)) - writeBlock receive buf size 531128 tcp no delay true
2020-12-03 07:23:25,451 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=18, src=/simpleAppend.dat, packetSize=516, chunksPerPacket=1, bytesCurBlock=512, DFSOutputStream:blk_1073741825_1002
2020-12-03 07:23:25,451 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48152 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1002]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(747)) - Receiving BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1002 src: /127.0.0.1:48152 dest: /127.0.0.1:46659
2020-12-03 07:23:25,451 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/simpleAppend.dat, chunkSize=516, chunksPerPacket=1, packetSize=516
2020-12-03 07:23:25,451 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48152 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1002]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1002
 storageType=DISK, inAddr=/127.0.0.1:48152, myAddr=/127.0.0.1:46659
 stage=PIPELINE_SETUP_APPEND, newGs=1003, minBytesRcvd=607, maxBytesRcvd=607
 clientname=DFSClient_NONMAPREDUCE_1712663744_1, srcDataNode=:0, datanode=127.0.0.1:46659
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-86c38d19-e1c7-408b-beec-a26b98ac3f35
2020-12-03 07:23:25,452 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=20, src=/simpleAppend.dat, packetSize=516, chunksPerPacket=1, bytesCurBlock=0, DFSOutputStream:blk_1073741825_1002
2020-12-03 07:23:25,452 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/simpleAppend.dat, chunkSize=516, chunksPerPacket=1, packetSize=516
2020-12-03 07:23:25,452 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48152 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1002]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741825_1002, FINALIZED
  getNumBytes()     = 607
  getBytesOnDisk()  = 607
  getVisibleLength()= 607
  getVolume()       = /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1
  getBlockURI()     = file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-2057880481-172.17.0.10-1606980199510/current/finalized/subdir0/subdir0/blk_1073741825
2020-12-03 07:23:25,452 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=21, src=/simpleAppend.dat, packetSize=516, chunksPerPacket=1, bytesCurBlock=512, DFSOutputStream:blk_1073741825_1002
2020-12-03 07:23:25,453 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/simpleAppend.dat, chunkSize=516, chunksPerPacket=1, packetSize=516
2020-12-03 07:23:25,453 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=23, src=/simpleAppend.dat, packetSize=516, chunksPerPacket=1, bytesCurBlock=0, DFSOutputStream:blk_1073741825_1002
2020-12-03 07:23:25,453 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/simpleAppend.dat, chunkSize=516, chunksPerPacket=1, packetSize=516
2020-12-03 07:23:25,453 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=24, src=/simpleAppend.dat, packetSize=516, chunksPerPacket=1, bytesCurBlock=512, DFSOutputStream:blk_1073741825_1002
2020-12-03 07:23:25,453 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/simpleAppend.dat, chunkSize=516, chunksPerPacket=1, packetSize=516
2020-12-03 07:23:25,453 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=26, src=/simpleAppend.dat, packetSize=516, chunksPerPacket=1, bytesCurBlock=0, DFSOutputStream:blk_1073741825_1002
2020-12-03 07:23:25,454 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/simpleAppend.dat, chunkSize=516, chunksPerPacket=1, packetSize=516
2020-12-03 07:23:25,454 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=27, src=/simpleAppend.dat, packetSize=516, chunksPerPacket=1, bytesCurBlock=512, DFSOutputStream:blk_1073741825_1002
2020-12-03 07:23:25,454 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/simpleAppend.dat, chunkSize=516, chunksPerPacket=1, packetSize=516
Written second part of file
2020-12-03 07:23:25,454 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=29, src=/simpleAppend.dat, packetSize=516, chunksPerPacket=1, bytesCurBlock=0, DFSOutputStream:blk_1073741825_1002
2020-12-03 07:23:25,454 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/simpleAppend.dat, chunkSize=516, chunksPerPacket=1, packetSize=516
2020-12-03 07:23:25,470 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48152 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1002]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-2057880481-172.17.0.10-1606980199510/current/rbw/blk_1073741825 of size 607
2020-12-03 07:23:25,470 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48152 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1002]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-2057880481-172.17.0.10-1606980199510/current/rbw/blk_1073741825_1003.meta of size 15
2020-12-03 07:23:25,471 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1003, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1003, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-12-03 07:23:25,473 [IPC Server handler 1 on default port 35089] INFO  namenode.FSNamesystem (FSNamesystem.java:updatePipeline(5430)) - updatePipeline(blk_1073741825_1002, newGS=1003, newLength=607, newNodes=[127.0.0.1:46659], client=DFSClient_NONMAPREDUCE_1712663744_1)
2020-12-03 07:23:25,474 [IPC Server handler 1 on default port 35089] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3891)) - BLOCK* removeStoredBlock: blk_1073741825_1003 from 127.0.0.1:46659
2020-12-03 07:23:25,474 [IPC Server handler 1 on default port 35089] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3935)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-86c38d19-e1c7-408b-beec-a26b98ac3f35:NORMAL:127.0.0.1:46659|RBW] of blk_1073741825_1002
2020-12-03 07:23:25,474 [IPC Server handler 1 on default port 35089] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistBlocks(111)) - persistBlocks: /simpleAppend.dat with 1 blocks is persisted to the file system
2020-12-03 07:23:25,474 [IPC Server handler 1 on default port 35089] INFO  namenode.FSNamesystem (FSNamesystem.java:updatePipeline(5448)) - updatePipeline(blk_1073741825_1002 => blk_1073741825_1003) success
2020-12-03 07:23:25,477 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48152 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1002]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1003: PacketHeader with packetLen=425 header data: offsetInBlock: 607
seqno: 0
lastPacketInBlock: false
dataLen: 417

2020-12-03 07:23:25,477 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48152 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1002]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1003: previous write did not end at the chunk boundary. onDiskLen=607
2020-12-03 07:23:25,477 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48152 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1002]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1003: sizePartialChunk=95, block offset=512, metafile offset=11
2020-12-03 07:23:25,478 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48152 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1002]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1003
2020-12-03 07:23:25,478 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48152 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1002]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 417, skip=0
2020-12-03 07:23:25,478 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48152 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1002]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1003, type=LAST_IN_PIPELINE: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=1024, ackEnqueueNanoTime=141197253582073, ackStatus=SUCCESS)
2020-12-03 07:23:25,479 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1003, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1003, type=LAST_IN_PIPELINE, replyAck=seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:25,479 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1003, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1003, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-12-03 07:23:25,480 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48152 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1002]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1003: PacketHeader with packetLen=4 header data: offsetInBlock: 1024
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-12-03 07:23:25,480 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48152 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1002]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1003
2020-12-03 07:23:25,480 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48152 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1002]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1003, type=LAST_IN_PIPELINE: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=1024, ackEnqueueNanoTime=141197255481789, ackStatus=SUCCESS)
2020-12-03 07:23:25,483 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1003, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:48152, dest: /127.0.0.1:46659, bytes: 1024, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_1712663744_1, offset: 0, srvID: 92140061-a997-4f98-95c8-65cba4629fb7, blockid: BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1003, duration(ns): 10245429
2020-12-03 07:23:25,483 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1003, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1003, type=LAST_IN_PIPELINE, replyAck=seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:25,483 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1003, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1003, type=LAST_IN_PIPELINE terminating
2020-12-03 07:23:25,483 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48152 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1002]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1003, type=LAST_IN_PIPELINE: closing
2020-12-03 07:23:25,487 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48152 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1002]] DEBUG datanode.DataNode (DataXceiver.java:run(328)) - 127.0.0.1:46659:Number of active connections is: 2
2020-12-03 07:23:25,488 [IPC Server handler 0 on default port 35089] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1627)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:46659, datanodeUuid=92140061-a997-4f98-95c8-65cba4629fb7, infoPort=42682, infoSecurePort=0, ipcPort=38521, storageInfo=lv=-57;cid=testClusterID;nsid=200687926;c=1606980199510) 1 blocks.
2020-12-03 07:23:25,488 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(4021)) - Reported block blk_1073741825_1003 on 127.0.0.1:46659 size 1024 replicaState = FINALIZED
2020-12-03 07:23:25,488 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(4044)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-12-03 07:23:25,488 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3351)) - BLOCK* addStoredBlock: 127.0.0.1:46659 is added to blk_1073741825_1003 (size=607)
2020-12-03 07:23:25,488 [IPC Server handler 2 on default port 35089] DEBUG hdfs.StateChange (FSNamesystem.java:getAdditionalBlock(2767)) - BLOCK* getAdditionalBlock: /simpleAppend.dat  inodeId 16386 for DFSClient_NONMAPREDUCE_1712663744_1
2020-12-03 07:23:25,488 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4154)) - BLOCK* block RECEIVED_BLOCK: blk_1073741825_1003 is received from 127.0.0.1:46659
2020-12-03 07:23:25,489 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4157)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:46659 receiving: 0, received: 1, deleted: 0
2020-12-03 07:23:25,493 [IPC Server handler 2 on default port 35089] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addBlock(524)) - DIR* FSDirectory.addBlock: /simpleAppend.dat with blk_1073741826_1004 block is added to the in-memory file system
2020-12-03 07:23:25,494 [IPC Server handler 2 on default port 35089] INFO  hdfs.StateChange (FSDirWriteFileOp.java:logAllocatedBlock(798)) - BLOCK* allocate blk_1073741826_1004, replicas=127.0.0.1:46659 for /simpleAppend.dat
2020-12-03 07:23:25,494 [IPC Server handler 2 on default port 35089] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistNewBlock(758)) - persistNewBlock: /simpleAppend.dat with new block blk_1073741826_1004, current total block count is 2
2020-12-03 07:23:25,496 [DataStreamer for file /simpleAppend.dat] INFO  sasl.SaslDataTransferClient (SaslDataTransferClient.java:checkTrustAndSend(239)) - SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
2020-12-03 07:23:25,498 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@3276732] DEBUG datanode.DataNode (DataXceiver.java:<init>(154)) - Number of active connections is: 1
2020-12-03 07:23:25,499 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48160 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741826_1004]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(728)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_1712663744_1
  block  =BP-2057880481-172.17.0.10-1606980199510:blk_1073741826_1004, newGs=0, bytesRcvd=[0, 0]
  targets=[]; pipelineSize=1, srcDataNode=:0, pinning=false
2020-12-03 07:23:25,500 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48160 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741826_1004]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(734)) - isDatanode=false, isClient=true, isTransfer=false
2020-12-03 07:23:25,500 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48160 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741826_1004]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(736)) - writeBlock receive buf size 531128 tcp no delay true
2020-12-03 07:23:25,500 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48160 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741826_1004]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(747)) - Receiving BP-2057880481-172.17.0.10-1606980199510:blk_1073741826_1004 src: /127.0.0.1:48160 dest: /127.0.0.1:46659
2020-12-03 07:23:25,500 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48160 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741826_1004]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-2057880481-172.17.0.10-1606980199510:blk_1073741826_1004
 storageType=DISK, inAddr=/127.0.0.1:48160, myAddr=/127.0.0.1:46659
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_1712663744_1, srcDataNode=:0, datanode=127.0.0.1:46659
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-c636ee3f-1da8-4dc7-9587-a6f1cdb36618
2020-12-03 07:23:25,501 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48160 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741826_1004]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-2057880481-172.17.0.10-1606980199510/current/rbw/blk_1073741826 of size 0
2020-12-03 07:23:25,501 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48160 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741826_1004]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-2057880481-172.17.0.10-1606980199510/current/rbw/blk_1073741826_1004.meta of size 0
2020-12-03 07:23:25,502 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741826_1004, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741826_1004, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-12-03 07:23:25,504 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48160 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741826_1004]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-2057880481-172.17.0.10-1606980199510:blk_1073741826_1004: PacketHeader with packetLen=520 header data: offsetInBlock: 0
seqno: 2
lastPacketInBlock: false
dataLen: 512

2020-12-03 07:23:25,504 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48160 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741826_1004]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741826_1004, type=LAST_IN_PIPELINE: enqueue Packet(seqno=2, lastPacketInBlock=false, offsetInBlock=512, ackEnqueueNanoTime=141197279846711, ackStatus=SUCCESS)
2020-12-03 07:23:25,509 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741826_1004, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741826_1004, type=LAST_IN_PIPELINE, replyAck=seqno: 2 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:25,509 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741826_1004, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741826_1004, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-12-03 07:23:25,509 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48160 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741826_1004]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-2057880481-172.17.0.10-1606980199510:blk_1073741826_1004: PacketHeader with packetLen=520 header data: offsetInBlock: 512
seqno: 3
lastPacketInBlock: false
dataLen: 512

2020-12-03 07:23:25,509 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48160 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741826_1004]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741826_1004, type=LAST_IN_PIPELINE: enqueue Packet(seqno=3, lastPacketInBlock=false, offsetInBlock=1024, ackEnqueueNanoTime=141197284817194, ackStatus=SUCCESS)
2020-12-03 07:23:25,510 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741826_1004, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741826_1004, type=LAST_IN_PIPELINE, replyAck=seqno: 3 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:25,510 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741826_1004, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741826_1004, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-12-03 07:23:25,510 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48160 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741826_1004]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-2057880481-172.17.0.10-1606980199510:blk_1073741826_1004: PacketHeader with packetLen=4 header data: offsetInBlock: 1024
seqno: 4
lastPacketInBlock: true
dataLen: 0

2020-12-03 07:23:25,511 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48160 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741826_1004]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-2057880481-172.17.0.10-1606980199510:blk_1073741826_1004
2020-12-03 07:23:25,511 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48160 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741826_1004]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741826_1004, type=LAST_IN_PIPELINE: enqueue Packet(seqno=4, lastPacketInBlock=true, offsetInBlock=1024, ackEnqueueNanoTime=141197286159807, ackStatus=SUCCESS)
2020-12-03 07:23:25,513 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741826_1004, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:48160, dest: /127.0.0.1:46659, bytes: 1024, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_1712663744_1, offset: 0, srvID: 92140061-a997-4f98-95c8-65cba4629fb7, blockid: BP-2057880481-172.17.0.10-1606980199510:blk_1073741826_1004, duration(ns): 10276788
2020-12-03 07:23:25,514 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741826_1004, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741826_1004, type=LAST_IN_PIPELINE, replyAck=seqno: 4 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:25,515 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741826_1004, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741826_1004, type=LAST_IN_PIPELINE terminating
2020-12-03 07:23:25,515 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48160 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741826_1004]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741826_1004, type=LAST_IN_PIPELINE: closing
2020-12-03 07:23:25,516 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48160 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741826_1004]] DEBUG datanode.DataNode (DataXceiver.java:run(328)) - 127.0.0.1:46659:Number of active connections is: 2
2020-12-03 07:23:25,516 [IPC Server handler 6 on default port 35089] DEBUG hdfs.StateChange (FSNamesystem.java:getAdditionalBlock(2767)) - BLOCK* getAdditionalBlock: /simpleAppend.dat  inodeId 16386 for DFSClient_NONMAPREDUCE_1712663744_1
2020-12-03 07:23:25,518 [IPC Server handler 6 on default port 35089] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addBlock(524)) - DIR* FSDirectory.addBlock: /simpleAppend.dat with blk_1073741827_1005 block is added to the in-memory file system
2020-12-03 07:23:25,518 [IPC Server handler 6 on default port 35089] INFO  hdfs.StateChange (FSDirWriteFileOp.java:logAllocatedBlock(798)) - BLOCK* allocate blk_1073741827_1005, replicas=127.0.0.1:46659 for /simpleAppend.dat
2020-12-03 07:23:25,518 [IPC Server handler 6 on default port 35089] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistNewBlock(758)) - persistNewBlock: /simpleAppend.dat with new block blk_1073741827_1005, current total block count is 3
2020-12-03 07:23:25,519 [IPC Server handler 4 on default port 35089] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1627)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:46659, datanodeUuid=92140061-a997-4f98-95c8-65cba4629fb7, infoPort=42682, infoSecurePort=0, ipcPort=38521, storageInfo=lv=-57;cid=testClusterID;nsid=200687926;c=1606980199510) 1 blocks.
2020-12-03 07:23:25,519 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(4021)) - Reported block blk_1073741826_1004 on 127.0.0.1:46659 size 1024 replicaState = FINALIZED
2020-12-03 07:23:25,519 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(4044)) - In memory blockUCState = COMMITTED
2020-12-03 07:23:25,519 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3351)) - BLOCK* addStoredBlock: 127.0.0.1:46659 is added to blk_1073741826_1004 (size=1024)
2020-12-03 07:23:25,519 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4154)) - BLOCK* block RECEIVED_BLOCK: blk_1073741826_1004 is received from 127.0.0.1:46659
2020-12-03 07:23:25,520 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4157)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:46659 receiving: 0, received: 1, deleted: 0
2020-12-03 07:23:25,520 [DataStreamer for file /simpleAppend.dat] INFO  sasl.SaslDataTransferClient (SaslDataTransferClient.java:checkTrustAndSend(239)) - SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
2020-12-03 07:23:25,521 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@3276732] DEBUG datanode.DataNode (DataXceiver.java:<init>(154)) - Number of active connections is: 1
2020-12-03 07:23:25,522 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48162 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741827_1005]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(728)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_1712663744_1
  block  =BP-2057880481-172.17.0.10-1606980199510:blk_1073741827_1005, newGs=0, bytesRcvd=[0, 0]
  targets=[]; pipelineSize=1, srcDataNode=:0, pinning=false
2020-12-03 07:23:25,522 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48162 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741827_1005]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(734)) - isDatanode=false, isClient=true, isTransfer=false
2020-12-03 07:23:25,522 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48162 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741827_1005]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(736)) - writeBlock receive buf size 531128 tcp no delay true
2020-12-03 07:23:25,522 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48162 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741827_1005]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(747)) - Receiving BP-2057880481-172.17.0.10-1606980199510:blk_1073741827_1005 src: /127.0.0.1:48162 dest: /127.0.0.1:46659
2020-12-03 07:23:25,522 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48162 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741827_1005]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-2057880481-172.17.0.10-1606980199510:blk_1073741827_1005
 storageType=DISK, inAddr=/127.0.0.1:48162, myAddr=/127.0.0.1:46659
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_1712663744_1, srcDataNode=:0, datanode=127.0.0.1:46659
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-c636ee3f-1da8-4dc7-9587-a6f1cdb36618
2020-12-03 07:23:25,523 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48162 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741827_1005]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-2057880481-172.17.0.10-1606980199510/current/rbw/blk_1073741827 of size 0
2020-12-03 07:23:25,523 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48162 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741827_1005]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-2057880481-172.17.0.10-1606980199510/current/rbw/blk_1073741827_1005.meta of size 0
2020-12-03 07:23:25,524 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741827_1005, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741827_1005, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-12-03 07:23:25,525 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48162 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741827_1005]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-2057880481-172.17.0.10-1606980199510:blk_1073741827_1005: PacketHeader with packetLen=520 header data: offsetInBlock: 0
seqno: 5
lastPacketInBlock: false
dataLen: 512

2020-12-03 07:23:25,526 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48162 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741827_1005]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741827_1005, type=LAST_IN_PIPELINE: enqueue Packet(seqno=5, lastPacketInBlock=false, offsetInBlock=512, ackEnqueueNanoTime=141197301032278, ackStatus=SUCCESS)
2020-12-03 07:23:25,526 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48162 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741827_1005]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-2057880481-172.17.0.10-1606980199510:blk_1073741827_1005: PacketHeader with packetLen=520 header data: offsetInBlock: 512
seqno: 6
lastPacketInBlock: false
dataLen: 512

2020-12-03 07:23:25,527 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48162 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741827_1005]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741827_1005, type=LAST_IN_PIPELINE: enqueue Packet(seqno=6, lastPacketInBlock=false, offsetInBlock=1024, ackEnqueueNanoTime=141197301936155, ackStatus=SUCCESS)
2020-12-03 07:23:25,527 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741827_1005, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741827_1005, type=LAST_IN_PIPELINE, replyAck=seqno: 5 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:25,527 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741827_1005, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741827_1005, type=LAST_IN_PIPELINE, replyAck=seqno: 6 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:25,527 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741827_1005, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741827_1005, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-12-03 07:23:25,527 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48162 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741827_1005]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-2057880481-172.17.0.10-1606980199510:blk_1073741827_1005: PacketHeader with packetLen=4 header data: offsetInBlock: 1024
seqno: 7
lastPacketInBlock: true
dataLen: 0

2020-12-03 07:23:25,528 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48162 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741827_1005]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-2057880481-172.17.0.10-1606980199510:blk_1073741827_1005
2020-12-03 07:23:25,528 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48162 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741827_1005]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741827_1005, type=LAST_IN_PIPELINE: enqueue Packet(seqno=7, lastPacketInBlock=true, offsetInBlock=1024, ackEnqueueNanoTime=141197303028039, ackStatus=SUCCESS)
2020-12-03 07:23:25,531 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741827_1005, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:48162, dest: /127.0.0.1:46659, bytes: 1024, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_1712663744_1, offset: 0, srvID: 92140061-a997-4f98-95c8-65cba4629fb7, blockid: BP-2057880481-172.17.0.10-1606980199510:blk_1073741827_1005, duration(ns): 5020154
2020-12-03 07:23:25,532 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741827_1005, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741827_1005, type=LAST_IN_PIPELINE, replyAck=seqno: 7 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:25,532 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741827_1005, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741827_1005, type=LAST_IN_PIPELINE terminating
2020-12-03 07:23:25,532 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48162 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741827_1005]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741827_1005, type=LAST_IN_PIPELINE: closing
2020-12-03 07:23:25,535 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48162 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741827_1005]] DEBUG datanode.DataNode (DataXceiver.java:run(328)) - 127.0.0.1:46659:Number of active connections is: 2
2020-12-03 07:23:25,535 [IPC Server handler 8 on default port 35089] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1627)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:46659, datanodeUuid=92140061-a997-4f98-95c8-65cba4629fb7, infoPort=42682, infoSecurePort=0, ipcPort=38521, storageInfo=lv=-57;cid=testClusterID;nsid=200687926;c=1606980199510) 1 blocks.
2020-12-03 07:23:25,535 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(4021)) - Reported block blk_1073741827_1005 on 127.0.0.1:46659 size 1024 replicaState = FINALIZED
2020-12-03 07:23:25,535 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(4044)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-12-03 07:23:25,536 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3351)) - BLOCK* addStoredBlock: 127.0.0.1:46659 is added to blk_1073741827_1005 (size=0)
2020-12-03 07:23:25,536 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4154)) - BLOCK* block RECEIVED_BLOCK: blk_1073741827_1005 is received from 127.0.0.1:46659
2020-12-03 07:23:25,536 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4157)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:46659 receiving: 0, received: 1, deleted: 0
2020-12-03 07:23:25,537 [IPC Server handler 7 on default port 35089] DEBUG hdfs.StateChange (FSNamesystem.java:getAdditionalBlock(2767)) - BLOCK* getAdditionalBlock: /simpleAppend.dat  inodeId 16386 for DFSClient_NONMAPREDUCE_1712663744_1
2020-12-03 07:23:25,538 [IPC Server handler 7 on default port 35089] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addBlock(524)) - DIR* FSDirectory.addBlock: /simpleAppend.dat with blk_1073741828_1006 block is added to the in-memory file system
2020-12-03 07:23:25,538 [IPC Server handler 7 on default port 35089] INFO  hdfs.StateChange (FSDirWriteFileOp.java:logAllocatedBlock(798)) - BLOCK* allocate blk_1073741828_1006, replicas=127.0.0.1:46659 for /simpleAppend.dat
2020-12-03 07:23:25,538 [IPC Server handler 7 on default port 35089] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistNewBlock(758)) - persistNewBlock: /simpleAppend.dat with new block blk_1073741828_1006, current total block count is 4
2020-12-03 07:23:25,540 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@3276732] DEBUG datanode.DataNode (DataXceiver.java:<init>(154)) - Number of active connections is: 1
2020-12-03 07:23:25,540 [DataStreamer for file /simpleAppend.dat] INFO  sasl.SaslDataTransferClient (SaslDataTransferClient.java:checkTrustAndSend(239)) - SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
2020-12-03 07:23:25,542 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48166 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741828_1006]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(728)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_1712663744_1
  block  =BP-2057880481-172.17.0.10-1606980199510:blk_1073741828_1006, newGs=0, bytesRcvd=[0, 0]
  targets=[]; pipelineSize=1, srcDataNode=:0, pinning=false
2020-12-03 07:23:25,542 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48166 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741828_1006]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(734)) - isDatanode=false, isClient=true, isTransfer=false
2020-12-03 07:23:25,543 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48166 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741828_1006]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(736)) - writeBlock receive buf size 531128 tcp no delay true
2020-12-03 07:23:25,543 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48166 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741828_1006]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(747)) - Receiving BP-2057880481-172.17.0.10-1606980199510:blk_1073741828_1006 src: /127.0.0.1:48166 dest: /127.0.0.1:46659
2020-12-03 07:23:25,543 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48166 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741828_1006]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-2057880481-172.17.0.10-1606980199510:blk_1073741828_1006
 storageType=DISK, inAddr=/127.0.0.1:48166, myAddr=/127.0.0.1:46659
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_1712663744_1, srcDataNode=:0, datanode=127.0.0.1:46659
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-c636ee3f-1da8-4dc7-9587-a6f1cdb36618
2020-12-03 07:23:25,544 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48166 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741828_1006]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-2057880481-172.17.0.10-1606980199510/current/rbw/blk_1073741828 of size 0
2020-12-03 07:23:25,544 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48166 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741828_1006]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-2057880481-172.17.0.10-1606980199510/current/rbw/blk_1073741828_1006.meta of size 0
2020-12-03 07:23:25,545 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741828_1006, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741828_1006, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-12-03 07:23:25,546 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48166 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741828_1006]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-2057880481-172.17.0.10-1606980199510:blk_1073741828_1006: PacketHeader with packetLen=520 header data: offsetInBlock: 0
seqno: 8
lastPacketInBlock: false
dataLen: 512

2020-12-03 07:23:25,546 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48166 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741828_1006]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741828_1006, type=LAST_IN_PIPELINE: enqueue Packet(seqno=8, lastPacketInBlock=false, offsetInBlock=512, ackEnqueueNanoTime=141197321549299, ackStatus=SUCCESS)
2020-12-03 07:23:25,550 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741828_1006, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741828_1006, type=LAST_IN_PIPELINE, replyAck=seqno: 8 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:25,550 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48166 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741828_1006]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-2057880481-172.17.0.10-1606980199510:blk_1073741828_1006: PacketHeader with packetLen=520 header data: offsetInBlock: 512
seqno: 9
lastPacketInBlock: false
dataLen: 512

2020-12-03 07:23:25,550 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741828_1006, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741828_1006, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-12-03 07:23:25,550 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48166 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741828_1006]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741828_1006, type=LAST_IN_PIPELINE: enqueue Packet(seqno=9, lastPacketInBlock=false, offsetInBlock=1024, ackEnqueueNanoTime=141197325635514, ackStatus=SUCCESS)
2020-12-03 07:23:25,551 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741828_1006, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741828_1006, type=LAST_IN_PIPELINE, replyAck=seqno: 9 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:25,551 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741828_1006, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741828_1006, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-12-03 07:23:25,556 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48166 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741828_1006]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-2057880481-172.17.0.10-1606980199510:blk_1073741828_1006: PacketHeader with packetLen=4 header data: offsetInBlock: 1024
seqno: 10
lastPacketInBlock: true
dataLen: 0

2020-12-03 07:23:25,556 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48166 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741828_1006]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-2057880481-172.17.0.10-1606980199510:blk_1073741828_1006
2020-12-03 07:23:25,556 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48166 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741828_1006]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741828_1006, type=LAST_IN_PIPELINE: enqueue Packet(seqno=10, lastPacketInBlock=true, offsetInBlock=1024, ackEnqueueNanoTime=141197331657017, ackStatus=SUCCESS)
2020-12-03 07:23:25,559 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741828_1006, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:48166, dest: /127.0.0.1:46659, bytes: 1024, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_1712663744_1, offset: 0, srvID: 92140061-a997-4f98-95c8-65cba4629fb7, blockid: BP-2057880481-172.17.0.10-1606980199510:blk_1073741828_1006, duration(ns): 13417309
2020-12-03 07:23:25,561 [IPC Server handler 3 on default port 35089] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1627)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:46659, datanodeUuid=92140061-a997-4f98-95c8-65cba4629fb7, infoPort=42682, infoSecurePort=0, ipcPort=38521, storageInfo=lv=-57;cid=testClusterID;nsid=200687926;c=1606980199510) 1 blocks.
2020-12-03 07:23:25,562 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(4021)) - Reported block blk_1073741828_1006 on 127.0.0.1:46659 size 1024 replicaState = FINALIZED
2020-12-03 07:23:25,562 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(4044)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-12-03 07:23:25,562 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3351)) - BLOCK* addStoredBlock: 127.0.0.1:46659 is added to blk_1073741828_1006 (size=0)
2020-12-03 07:23:25,562 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4154)) - BLOCK* block RECEIVED_BLOCK: blk_1073741828_1006 is received from 127.0.0.1:46659
2020-12-03 07:23:25,562 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4157)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:46659 receiving: 0, received: 1, deleted: 0
2020-12-03 07:23:25,566 [IPC Server handler 9 on default port 35089] DEBUG hdfs.StateChange (FSNamesystem.java:getAdditionalBlock(2767)) - BLOCK* getAdditionalBlock: /simpleAppend.dat  inodeId 16386 for DFSClient_NONMAPREDUCE_1712663744_1
2020-12-03 07:23:25,567 [IPC Server handler 9 on default port 35089] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addBlock(524)) - DIR* FSDirectory.addBlock: /simpleAppend.dat with blk_1073741829_1007 block is added to the in-memory file system
2020-12-03 07:23:25,568 [IPC Server handler 9 on default port 35089] INFO  hdfs.StateChange (FSDirWriteFileOp.java:logAllocatedBlock(798)) - BLOCK* allocate blk_1073741829_1007, replicas=127.0.0.1:46659 for /simpleAppend.dat
2020-12-03 07:23:25,568 [IPC Server handler 9 on default port 35089] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistNewBlock(758)) - persistNewBlock: /simpleAppend.dat with new block blk_1073741829_1007, current total block count is 5
2020-12-03 07:23:25,570 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@3276732] DEBUG datanode.DataNode (DataXceiver.java:<init>(154)) - Number of active connections is: 3
2020-12-03 07:23:25,570 [DataStreamer for file /simpleAppend.dat] INFO  sasl.SaslDataTransferClient (SaslDataTransferClient.java:checkTrustAndSend(239)) - SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
2020-12-03 07:23:25,571 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48172 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741829_1007]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(728)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_1712663744_1
  block  =BP-2057880481-172.17.0.10-1606980199510:blk_1073741829_1007, newGs=0, bytesRcvd=[0, 0]
  targets=[]; pipelineSize=1, srcDataNode=:0, pinning=false
2020-12-03 07:23:25,572 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48172 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741829_1007]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(734)) - isDatanode=false, isClient=true, isTransfer=false
2020-12-03 07:23:25,572 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48172 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741829_1007]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(736)) - writeBlock receive buf size 531128 tcp no delay true
2020-12-03 07:23:25,572 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48172 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741829_1007]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(747)) - Receiving BP-2057880481-172.17.0.10-1606980199510:blk_1073741829_1007 src: /127.0.0.1:48172 dest: /127.0.0.1:46659
2020-12-03 07:23:25,572 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48172 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741829_1007]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-2057880481-172.17.0.10-1606980199510:blk_1073741829_1007
 storageType=DISK, inAddr=/127.0.0.1:48172, myAddr=/127.0.0.1:46659
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_1712663744_1, srcDataNode=:0, datanode=127.0.0.1:46659
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-c636ee3f-1da8-4dc7-9587-a6f1cdb36618
2020-12-03 07:23:25,573 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48172 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741829_1007]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-2057880481-172.17.0.10-1606980199510/current/rbw/blk_1073741829 of size 0
2020-12-03 07:23:25,573 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48172 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741829_1007]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-2057880481-172.17.0.10-1606980199510/current/rbw/blk_1073741829_1007.meta of size 0
2020-12-03 07:23:25,573 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741828_1006, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741828_1006, type=LAST_IN_PIPELINE, replyAck=seqno: 10 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:25,574 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741828_1006, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741828_1006, type=LAST_IN_PIPELINE terminating
2020-12-03 07:23:25,574 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48166 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741828_1006]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741828_1006, type=LAST_IN_PIPELINE: closing
2020-12-03 07:23:25,578 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741829_1007, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741829_1007, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-12-03 07:23:25,578 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48166 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741828_1006]] DEBUG datanode.DataNode (DataXceiver.java:run(328)) - 127.0.0.1:46659:Number of active connections is: 4
2020-12-03 07:23:25,589 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48172 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741829_1007]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-2057880481-172.17.0.10-1606980199510:blk_1073741829_1007: PacketHeader with packetLen=520 header data: offsetInBlock: 0
seqno: 11
lastPacketInBlock: false
dataLen: 512

2020-12-03 07:23:25,590 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48172 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741829_1007]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741829_1007, type=LAST_IN_PIPELINE: enqueue Packet(seqno=11, lastPacketInBlock=false, offsetInBlock=512, ackEnqueueNanoTime=141197365271847, ackStatus=SUCCESS)
2020-12-03 07:23:25,590 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48172 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741829_1007]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-2057880481-172.17.0.10-1606980199510:blk_1073741829_1007: PacketHeader with packetLen=520 header data: offsetInBlock: 512
seqno: 12
lastPacketInBlock: false
dataLen: 512

2020-12-03 07:23:25,591 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48172 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741829_1007]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741829_1007, type=LAST_IN_PIPELINE: enqueue Packet(seqno=12, lastPacketInBlock=false, offsetInBlock=1024, ackEnqueueNanoTime=141197366808350, ackStatus=SUCCESS)
2020-12-03 07:23:25,593 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741829_1007, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741829_1007, type=LAST_IN_PIPELINE, replyAck=seqno: 11 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:25,594 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741829_1007, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741829_1007, type=LAST_IN_PIPELINE, replyAck=seqno: 12 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:25,594 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741829_1007, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741829_1007, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-12-03 07:23:25,594 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48172 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741829_1007]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-2057880481-172.17.0.10-1606980199510:blk_1073741829_1007: PacketHeader with packetLen=4 header data: offsetInBlock: 1024
seqno: 13
lastPacketInBlock: true
dataLen: 0

2020-12-03 07:23:25,594 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48172 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741829_1007]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-2057880481-172.17.0.10-1606980199510:blk_1073741829_1007
2020-12-03 07:23:25,595 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48172 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741829_1007]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741829_1007, type=LAST_IN_PIPELINE: enqueue Packet(seqno=13, lastPacketInBlock=true, offsetInBlock=1024, ackEnqueueNanoTime=141197369963859, ackStatus=SUCCESS)
2020-12-03 07:23:25,602 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741829_1007, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:48172, dest: /127.0.0.1:46659, bytes: 1024, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_1712663744_1, offset: 0, srvID: 92140061-a997-4f98-95c8-65cba4629fb7, blockid: BP-2057880481-172.17.0.10-1606980199510:blk_1073741829_1007, duration(ns): 21993688
2020-12-03 07:23:25,603 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741829_1007, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741829_1007, type=LAST_IN_PIPELINE, replyAck=seqno: 13 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:25,603 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741829_1007, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741829_1007, type=LAST_IN_PIPELINE terminating
2020-12-03 07:23:25,604 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48172 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741829_1007]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741829_1007, type=LAST_IN_PIPELINE: closing
2020-12-03 07:23:25,604 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48172 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741829_1007]] DEBUG datanode.DataNode (DataXceiver.java:run(328)) - 127.0.0.1:46659:Number of active connections is: 2
2020-12-03 07:23:25,606 [IPC Server handler 5 on default port 35089] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1627)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:46659, datanodeUuid=92140061-a997-4f98-95c8-65cba4629fb7, infoPort=42682, infoSecurePort=0, ipcPort=38521, storageInfo=lv=-57;cid=testClusterID;nsid=200687926;c=1606980199510) 1 blocks.
2020-12-03 07:23:25,607 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(4021)) - Reported block blk_1073741829_1007 on 127.0.0.1:46659 size 1024 replicaState = FINALIZED
2020-12-03 07:23:25,607 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(4044)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-12-03 07:23:25,607 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3351)) - BLOCK* addStoredBlock: 127.0.0.1:46659 is added to blk_1073741829_1007 (size=0)
2020-12-03 07:23:25,607 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4154)) - BLOCK* block RECEIVED_BLOCK: blk_1073741829_1007 is received from 127.0.0.1:46659
2020-12-03 07:23:25,607 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4157)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:46659 receiving: 0, received: 1, deleted: 0
2020-12-03 07:23:25,610 [IPC Server handler 1 on default port 35089] DEBUG hdfs.StateChange (FSNamesystem.java:getAdditionalBlock(2767)) - BLOCK* getAdditionalBlock: /simpleAppend.dat  inodeId 16386 for DFSClient_NONMAPREDUCE_1712663744_1
2020-12-03 07:23:25,611 [IPC Server handler 1 on default port 35089] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addBlock(524)) - DIR* FSDirectory.addBlock: /simpleAppend.dat with blk_1073741830_1008 block is added to the in-memory file system
2020-12-03 07:23:25,612 [IPC Server handler 1 on default port 35089] INFO  hdfs.StateChange (FSDirWriteFileOp.java:logAllocatedBlock(798)) - BLOCK* allocate blk_1073741830_1008, replicas=127.0.0.1:46659 for /simpleAppend.dat
2020-12-03 07:23:25,612 [IPC Server handler 1 on default port 35089] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistNewBlock(758)) - persistNewBlock: /simpleAppend.dat with new block blk_1073741830_1008, current total block count is 6
2020-12-03 07:23:25,615 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@3276732] DEBUG datanode.DataNode (DataXceiver.java:<init>(154)) - Number of active connections is: 1
2020-12-03 07:23:25,615 [DataStreamer for file /simpleAppend.dat] INFO  sasl.SaslDataTransferClient (SaslDataTransferClient.java:checkTrustAndSend(239)) - SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
2020-12-03 07:23:25,618 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48180 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741830_1008]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(728)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_1712663744_1
  block  =BP-2057880481-172.17.0.10-1606980199510:blk_1073741830_1008, newGs=0, bytesRcvd=[0, 0]
  targets=[]; pipelineSize=1, srcDataNode=:0, pinning=false
2020-12-03 07:23:25,618 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48180 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741830_1008]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(734)) - isDatanode=false, isClient=true, isTransfer=false
2020-12-03 07:23:25,618 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48180 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741830_1008]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(736)) - writeBlock receive buf size 531128 tcp no delay true
2020-12-03 07:23:25,618 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48180 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741830_1008]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(747)) - Receiving BP-2057880481-172.17.0.10-1606980199510:blk_1073741830_1008 src: /127.0.0.1:48180 dest: /127.0.0.1:46659
2020-12-03 07:23:25,618 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48180 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741830_1008]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-2057880481-172.17.0.10-1606980199510:blk_1073741830_1008
 storageType=DISK, inAddr=/127.0.0.1:48180, myAddr=/127.0.0.1:46659
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_1712663744_1, srcDataNode=:0, datanode=127.0.0.1:46659
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-c636ee3f-1da8-4dc7-9587-a6f1cdb36618
2020-12-03 07:23:25,619 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48180 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741830_1008]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-2057880481-172.17.0.10-1606980199510/current/rbw/blk_1073741830 of size 0
2020-12-03 07:23:25,619 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48180 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741830_1008]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-2057880481-172.17.0.10-1606980199510/current/rbw/blk_1073741830_1008.meta of size 0
2020-12-03 07:23:25,622 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741830_1008, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741830_1008, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-12-03 07:23:25,626 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48180 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741830_1008]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-2057880481-172.17.0.10-1606980199510:blk_1073741830_1008: PacketHeader with packetLen=520 header data: offsetInBlock: 0
seqno: 14
lastPacketInBlock: false
dataLen: 512

2020-12-03 07:23:25,626 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48180 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741830_1008]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741830_1008, type=LAST_IN_PIPELINE: enqueue Packet(seqno=14, lastPacketInBlock=false, offsetInBlock=512, ackEnqueueNanoTime=141197401858595, ackStatus=SUCCESS)
2020-12-03 07:23:25,627 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48180 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741830_1008]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-2057880481-172.17.0.10-1606980199510:blk_1073741830_1008: PacketHeader with packetLen=520 header data: offsetInBlock: 512
seqno: 15
lastPacketInBlock: false
dataLen: 512

2020-12-03 07:23:25,628 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48180 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741830_1008]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741830_1008, type=LAST_IN_PIPELINE: enqueue Packet(seqno=15, lastPacketInBlock=false, offsetInBlock=1024, ackEnqueueNanoTime=141197403117392, ackStatus=SUCCESS)
2020-12-03 07:23:25,628 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741830_1008, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741830_1008, type=LAST_IN_PIPELINE, replyAck=seqno: 14 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:25,629 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741830_1008, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741830_1008, type=LAST_IN_PIPELINE, replyAck=seqno: 15 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:25,629 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741830_1008, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741830_1008, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-12-03 07:23:25,633 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48180 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741830_1008]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-2057880481-172.17.0.10-1606980199510:blk_1073741830_1008: PacketHeader with packetLen=4 header data: offsetInBlock: 1024
seqno: 16
lastPacketInBlock: true
dataLen: 0

2020-12-03 07:23:25,633 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48180 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741830_1008]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-2057880481-172.17.0.10-1606980199510:blk_1073741830_1008
2020-12-03 07:23:25,633 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48180 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741830_1008]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741830_1008, type=LAST_IN_PIPELINE: enqueue Packet(seqno=16, lastPacketInBlock=true, offsetInBlock=1024, ackEnqueueNanoTime=141197408417448, ackStatus=SUCCESS)
2020-12-03 07:23:25,636 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741830_1008, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:48180, dest: /127.0.0.1:46659, bytes: 1024, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_1712663744_1, offset: 0, srvID: 92140061-a997-4f98-95c8-65cba4629fb7, blockid: BP-2057880481-172.17.0.10-1606980199510:blk_1073741830_1008, duration(ns): 12965357
2020-12-03 07:23:25,637 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741830_1008, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741830_1008, type=LAST_IN_PIPELINE, replyAck=seqno: 16 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:25,638 [IPC Server handler 0 on default port 35089] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1627)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:46659, datanodeUuid=92140061-a997-4f98-95c8-65cba4629fb7, infoPort=42682, infoSecurePort=0, ipcPort=38521, storageInfo=lv=-57;cid=testClusterID;nsid=200687926;c=1606980199510) 1 blocks.
2020-12-03 07:23:25,638 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741830_1008, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741830_1008, type=LAST_IN_PIPELINE terminating
2020-12-03 07:23:25,638 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48180 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741830_1008]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741830_1008, type=LAST_IN_PIPELINE: closing
2020-12-03 07:23:25,640 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48180 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741830_1008]] DEBUG datanode.DataNode (DataXceiver.java:run(328)) - 127.0.0.1:46659:Number of active connections is: 2
2020-12-03 07:23:25,641 [IPC Server handler 2 on default port 35089] DEBUG hdfs.StateChange (FSNamesystem.java:getAdditionalBlock(2767)) - BLOCK* getAdditionalBlock: /simpleAppend.dat  inodeId 16386 for DFSClient_NONMAPREDUCE_1712663744_1
2020-12-03 07:23:25,641 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(4021)) - Reported block blk_1073741830_1008 on 127.0.0.1:46659 size 1024 replicaState = FINALIZED
2020-12-03 07:23:25,641 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(4044)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-12-03 07:23:25,642 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3351)) - BLOCK* addStoredBlock: 127.0.0.1:46659 is added to blk_1073741830_1008 (size=0)
2020-12-03 07:23:25,642 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4154)) - BLOCK* block RECEIVED_BLOCK: blk_1073741830_1008 is received from 127.0.0.1:46659
2020-12-03 07:23:25,642 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4157)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:46659 receiving: 0, received: 1, deleted: 0
2020-12-03 07:23:25,644 [IPC Server handler 2 on default port 35089] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addBlock(524)) - DIR* FSDirectory.addBlock: /simpleAppend.dat with blk_1073741831_1009 block is added to the in-memory file system
2020-12-03 07:23:25,644 [IPC Server handler 2 on default port 35089] INFO  hdfs.StateChange (FSDirWriteFileOp.java:logAllocatedBlock(798)) - BLOCK* allocate blk_1073741831_1009, replicas=127.0.0.1:46659 for /simpleAppend.dat
2020-12-03 07:23:25,644 [IPC Server handler 2 on default port 35089] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistNewBlock(758)) - persistNewBlock: /simpleAppend.dat with new block blk_1073741831_1009, current total block count is 7
2020-12-03 07:23:25,646 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@3276732] DEBUG datanode.DataNode (DataXceiver.java:<init>(154)) - Number of active connections is: 1
2020-12-03 07:23:25,646 [DataStreamer for file /simpleAppend.dat] INFO  sasl.SaslDataTransferClient (SaslDataTransferClient.java:checkTrustAndSend(239)) - SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
2020-12-03 07:23:25,647 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48188 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741831_1009]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(728)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_1712663744_1
  block  =BP-2057880481-172.17.0.10-1606980199510:blk_1073741831_1009, newGs=0, bytesRcvd=[0, 0]
  targets=[]; pipelineSize=1, srcDataNode=:0, pinning=false
2020-12-03 07:23:25,647 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48188 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741831_1009]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(734)) - isDatanode=false, isClient=true, isTransfer=false
2020-12-03 07:23:25,647 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48188 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741831_1009]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(736)) - writeBlock receive buf size 531128 tcp no delay true
2020-12-03 07:23:25,648 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48188 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741831_1009]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(747)) - Receiving BP-2057880481-172.17.0.10-1606980199510:blk_1073741831_1009 src: /127.0.0.1:48188 dest: /127.0.0.1:46659
2020-12-03 07:23:25,648 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48188 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741831_1009]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-2057880481-172.17.0.10-1606980199510:blk_1073741831_1009
 storageType=DISK, inAddr=/127.0.0.1:48188, myAddr=/127.0.0.1:46659
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_1712663744_1, srcDataNode=:0, datanode=127.0.0.1:46659
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-c636ee3f-1da8-4dc7-9587-a6f1cdb36618
2020-12-03 07:23:25,648 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48188 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741831_1009]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-2057880481-172.17.0.10-1606980199510/current/rbw/blk_1073741831 of size 0
2020-12-03 07:23:25,648 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48188 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741831_1009]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-2057880481-172.17.0.10-1606980199510/current/rbw/blk_1073741831_1009.meta of size 0
2020-12-03 07:23:25,649 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741831_1009, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741831_1009, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-12-03 07:23:25,650 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48188 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741831_1009]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-2057880481-172.17.0.10-1606980199510:blk_1073741831_1009: PacketHeader with packetLen=520 header data: offsetInBlock: 0
seqno: 17
lastPacketInBlock: false
dataLen: 512

2020-12-03 07:23:25,651 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48188 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741831_1009]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741831_1009, type=LAST_IN_PIPELINE: enqueue Packet(seqno=17, lastPacketInBlock=false, offsetInBlock=512, ackEnqueueNanoTime=141197426137190, ackStatus=SUCCESS)
2020-12-03 07:23:25,651 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48188 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741831_1009]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-2057880481-172.17.0.10-1606980199510:blk_1073741831_1009: PacketHeader with packetLen=520 header data: offsetInBlock: 512
seqno: 18
lastPacketInBlock: false
dataLen: 512

2020-12-03 07:23:25,651 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48188 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741831_1009]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741831_1009, type=LAST_IN_PIPELINE: enqueue Packet(seqno=18, lastPacketInBlock=false, offsetInBlock=1024, ackEnqueueNanoTime=141197426717309, ackStatus=SUCCESS)
2020-12-03 07:23:25,653 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741831_1009, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741831_1009, type=LAST_IN_PIPELINE, replyAck=seqno: 17 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:25,654 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741831_1009, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741831_1009, type=LAST_IN_PIPELINE, replyAck=seqno: 18 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:25,654 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741831_1009, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741831_1009, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-12-03 07:23:25,662 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48188 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741831_1009]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-2057880481-172.17.0.10-1606980199510:blk_1073741831_1009: PacketHeader with packetLen=4 header data: offsetInBlock: 1024
seqno: 19
lastPacketInBlock: true
dataLen: 0

2020-12-03 07:23:25,662 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48188 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741831_1009]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-2057880481-172.17.0.10-1606980199510:blk_1073741831_1009
2020-12-03 07:23:25,663 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48188 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741831_1009]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741831_1009, type=LAST_IN_PIPELINE: enqueue Packet(seqno=19, lastPacketInBlock=true, offsetInBlock=1024, ackEnqueueNanoTime=141197437961638, ackStatus=SUCCESS)
2020-12-03 07:23:25,666 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741831_1009, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:48188, dest: /127.0.0.1:46659, bytes: 1024, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_1712663744_1, offset: 0, srvID: 92140061-a997-4f98-95c8-65cba4629fb7, blockid: BP-2057880481-172.17.0.10-1606980199510:blk_1073741831_1009, duration(ns): 15130618
2020-12-03 07:23:25,667 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741831_1009, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741831_1009, type=LAST_IN_PIPELINE, replyAck=seqno: 19 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:25,667 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741831_1009, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741831_1009, type=LAST_IN_PIPELINE terminating
2020-12-03 07:23:25,667 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48188 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741831_1009]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741831_1009, type=LAST_IN_PIPELINE: closing
2020-12-03 07:23:25,668 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48188 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741831_1009]] DEBUG datanode.DataNode (DataXceiver.java:run(328)) - 127.0.0.1:46659:Number of active connections is: 2
2020-12-03 07:23:25,669 [IPC Server handler 6 on default port 35089] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1627)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:46659, datanodeUuid=92140061-a997-4f98-95c8-65cba4629fb7, infoPort=42682, infoSecurePort=0, ipcPort=38521, storageInfo=lv=-57;cid=testClusterID;nsid=200687926;c=1606980199510) 1 blocks.
2020-12-03 07:23:25,669 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(4021)) - Reported block blk_1073741831_1009 on 127.0.0.1:46659 size 1024 replicaState = FINALIZED
2020-12-03 07:23:25,669 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(4044)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-12-03 07:23:25,669 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3351)) - BLOCK* addStoredBlock: 127.0.0.1:46659 is added to blk_1073741831_1009 (size=0)
2020-12-03 07:23:25,670 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4154)) - BLOCK* block RECEIVED_BLOCK: blk_1073741831_1009 is received from 127.0.0.1:46659
2020-12-03 07:23:25,670 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4157)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:46659 receiving: 0, received: 1, deleted: 0
2020-12-03 07:23:25,675 [IPC Server handler 4 on default port 35089] DEBUG hdfs.StateChange (FSNamesystem.java:getAdditionalBlock(2767)) - BLOCK* getAdditionalBlock: /simpleAppend.dat  inodeId 16386 for DFSClient_NONMAPREDUCE_1712663744_1
2020-12-03 07:23:25,676 [IPC Server handler 4 on default port 35089] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addBlock(524)) - DIR* FSDirectory.addBlock: /simpleAppend.dat with blk_1073741832_1010 block is added to the in-memory file system
2020-12-03 07:23:25,676 [IPC Server handler 4 on default port 35089] INFO  hdfs.StateChange (FSDirWriteFileOp.java:logAllocatedBlock(798)) - BLOCK* allocate blk_1073741832_1010, replicas=127.0.0.1:46659 for /simpleAppend.dat
2020-12-03 07:23:25,676 [IPC Server handler 4 on default port 35089] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistNewBlock(758)) - persistNewBlock: /simpleAppend.dat with new block blk_1073741832_1010, current total block count is 8
2020-12-03 07:23:25,678 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@3276732] DEBUG datanode.DataNode (DataXceiver.java:<init>(154)) - Number of active connections is: 1
2020-12-03 07:23:25,678 [DataStreamer for file /simpleAppend.dat] INFO  sasl.SaslDataTransferClient (SaslDataTransferClient.java:checkTrustAndSend(239)) - SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
2020-12-03 07:23:25,680 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48192 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741832_1010]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(728)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_1712663744_1
  block  =BP-2057880481-172.17.0.10-1606980199510:blk_1073741832_1010, newGs=0, bytesRcvd=[0, 0]
  targets=[]; pipelineSize=1, srcDataNode=:0, pinning=false
2020-12-03 07:23:25,680 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48192 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741832_1010]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(734)) - isDatanode=false, isClient=true, isTransfer=false
2020-12-03 07:23:25,680 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48192 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741832_1010]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(736)) - writeBlock receive buf size 531128 tcp no delay true
2020-12-03 07:23:25,680 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48192 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741832_1010]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(747)) - Receiving BP-2057880481-172.17.0.10-1606980199510:blk_1073741832_1010 src: /127.0.0.1:48192 dest: /127.0.0.1:46659
2020-12-03 07:23:25,680 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48192 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741832_1010]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-2057880481-172.17.0.10-1606980199510:blk_1073741832_1010
 storageType=DISK, inAddr=/127.0.0.1:48192, myAddr=/127.0.0.1:46659
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_1712663744_1, srcDataNode=:0, datanode=127.0.0.1:46659
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-c636ee3f-1da8-4dc7-9587-a6f1cdb36618
2020-12-03 07:23:25,681 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48192 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741832_1010]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-2057880481-172.17.0.10-1606980199510/current/rbw/blk_1073741832 of size 0
2020-12-03 07:23:25,681 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48192 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741832_1010]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-2057880481-172.17.0.10-1606980199510/current/rbw/blk_1073741832_1010.meta of size 0
2020-12-03 07:23:25,682 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741832_1010, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741832_1010, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-12-03 07:23:25,683 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48192 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741832_1010]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-2057880481-172.17.0.10-1606980199510:blk_1073741832_1010: PacketHeader with packetLen=520 header data: offsetInBlock: 0
seqno: 20
lastPacketInBlock: false
dataLen: 512

2020-12-03 07:23:25,684 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48192 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741832_1010]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741832_1010, type=LAST_IN_PIPELINE: enqueue Packet(seqno=20, lastPacketInBlock=false, offsetInBlock=512, ackEnqueueNanoTime=141197459076503, ackStatus=SUCCESS)
2020-12-03 07:23:25,684 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48192 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741832_1010]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-2057880481-172.17.0.10-1606980199510:blk_1073741832_1010: PacketHeader with packetLen=520 header data: offsetInBlock: 512
seqno: 21
lastPacketInBlock: false
dataLen: 512

2020-12-03 07:23:25,685 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48192 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741832_1010]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741832_1010, type=LAST_IN_PIPELINE: enqueue Packet(seqno=21, lastPacketInBlock=false, offsetInBlock=1024, ackEnqueueNanoTime=141197460298540, ackStatus=SUCCESS)
2020-12-03 07:23:25,686 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741832_1010, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741832_1010, type=LAST_IN_PIPELINE, replyAck=seqno: 20 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:25,687 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741832_1010, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741832_1010, type=LAST_IN_PIPELINE, replyAck=seqno: 21 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:25,687 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741832_1010, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741832_1010, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-12-03 07:23:25,687 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48192 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741832_1010]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-2057880481-172.17.0.10-1606980199510:blk_1073741832_1010: PacketHeader with packetLen=4 header data: offsetInBlock: 1024
seqno: 22
lastPacketInBlock: true
dataLen: 0

2020-12-03 07:23:25,688 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48192 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741832_1010]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-2057880481-172.17.0.10-1606980199510:blk_1073741832_1010
2020-12-03 07:23:25,688 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48192 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741832_1010]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741832_1010, type=LAST_IN_PIPELINE: enqueue Packet(seqno=22, lastPacketInBlock=true, offsetInBlock=1024, ackEnqueueNanoTime=141197463140565, ackStatus=SUCCESS)
2020-12-03 07:23:25,689 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741832_1010, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:48192, dest: /127.0.0.1:46659, bytes: 1024, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_1712663744_1, offset: 0, srvID: 92140061-a997-4f98-95c8-65cba4629fb7, blockid: BP-2057880481-172.17.0.10-1606980199510:blk_1073741832_1010, duration(ns): 5958331
2020-12-03 07:23:25,690 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741832_1010, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741832_1010, type=LAST_IN_PIPELINE, replyAck=seqno: 22 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:25,694 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741832_1010, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741832_1010, type=LAST_IN_PIPELINE terminating
2020-12-03 07:23:25,694 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48192 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741832_1010]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741832_1010, type=LAST_IN_PIPELINE: closing
2020-12-03 07:23:25,696 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48192 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741832_1010]] DEBUG datanode.DataNode (DataXceiver.java:run(328)) - 127.0.0.1:46659:Number of active connections is: 2
2020-12-03 07:23:25,696 [IPC Server handler 8 on default port 35089] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1627)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:46659, datanodeUuid=92140061-a997-4f98-95c8-65cba4629fb7, infoPort=42682, infoSecurePort=0, ipcPort=38521, storageInfo=lv=-57;cid=testClusterID;nsid=200687926;c=1606980199510) 1 blocks.
2020-12-03 07:23:25,696 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(4021)) - Reported block blk_1073741832_1010 on 127.0.0.1:46659 size 1024 replicaState = FINALIZED
2020-12-03 07:23:25,696 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(4044)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-12-03 07:23:25,697 [IPC Server handler 8 on default port 35089] DEBUG hdfs.StateChange (FSNamesystem.java:getAdditionalBlock(2767)) - BLOCK* getAdditionalBlock: /simpleAppend.dat  inodeId 16386 for DFSClient_NONMAPREDUCE_1712663744_1
2020-12-03 07:23:25,697 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3351)) - BLOCK* addStoredBlock: 127.0.0.1:46659 is added to blk_1073741832_1010 (size=0)
2020-12-03 07:23:25,697 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4154)) - BLOCK* block RECEIVED_BLOCK: blk_1073741832_1010 is received from 127.0.0.1:46659
2020-12-03 07:23:25,697 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4157)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:46659 receiving: 0, received: 1, deleted: 0
2020-12-03 07:23:25,698 [IPC Server handler 8 on default port 35089] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addBlock(524)) - DIR* FSDirectory.addBlock: /simpleAppend.dat with blk_1073741833_1011 block is added to the in-memory file system
2020-12-03 07:23:25,698 [IPC Server handler 8 on default port 35089] INFO  hdfs.StateChange (FSDirWriteFileOp.java:logAllocatedBlock(798)) - BLOCK* allocate blk_1073741833_1011, replicas=127.0.0.1:46659 for /simpleAppend.dat
2020-12-03 07:23:25,698 [IPC Server handler 8 on default port 35089] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistNewBlock(758)) - persistNewBlock: /simpleAppend.dat with new block blk_1073741833_1011, current total block count is 9
2020-12-03 07:23:25,700 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@3276732] DEBUG datanode.DataNode (DataXceiver.java:<init>(154)) - Number of active connections is: 1
2020-12-03 07:23:25,702 [DataStreamer for file /simpleAppend.dat] INFO  sasl.SaslDataTransferClient (SaslDataTransferClient.java:checkTrustAndSend(239)) - SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
2020-12-03 07:23:25,703 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48202 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741833_1011]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(728)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_1712663744_1
  block  =BP-2057880481-172.17.0.10-1606980199510:blk_1073741833_1011, newGs=0, bytesRcvd=[0, 0]
  targets=[]; pipelineSize=1, srcDataNode=:0, pinning=false
2020-12-03 07:23:25,703 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48202 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741833_1011]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(734)) - isDatanode=false, isClient=true, isTransfer=false
2020-12-03 07:23:25,704 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48202 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741833_1011]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(736)) - writeBlock receive buf size 531128 tcp no delay true
2020-12-03 07:23:25,704 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48202 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741833_1011]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(747)) - Receiving BP-2057880481-172.17.0.10-1606980199510:blk_1073741833_1011 src: /127.0.0.1:48202 dest: /127.0.0.1:46659
2020-12-03 07:23:25,704 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48202 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741833_1011]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-2057880481-172.17.0.10-1606980199510:blk_1073741833_1011
 storageType=DISK, inAddr=/127.0.0.1:48202, myAddr=/127.0.0.1:46659
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_1712663744_1, srcDataNode=:0, datanode=127.0.0.1:46659
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-c636ee3f-1da8-4dc7-9587-a6f1cdb36618
2020-12-03 07:23:25,705 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48202 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741833_1011]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-2057880481-172.17.0.10-1606980199510/current/rbw/blk_1073741833 of size 0
2020-12-03 07:23:25,705 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48202 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741833_1011]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-2057880481-172.17.0.10-1606980199510/current/rbw/blk_1073741833_1011.meta of size 0
2020-12-03 07:23:25,708 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741833_1011, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741833_1011, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-12-03 07:23:25,713 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48202 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741833_1011]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-2057880481-172.17.0.10-1606980199510:blk_1073741833_1011: PacketHeader with packetLen=520 header data: offsetInBlock: 0
seqno: 23
lastPacketInBlock: false
dataLen: 512

2020-12-03 07:23:25,713 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48202 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741833_1011]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741833_1011, type=LAST_IN_PIPELINE: enqueue Packet(seqno=23, lastPacketInBlock=false, offsetInBlock=512, ackEnqueueNanoTime=141197488537996, ackStatus=SUCCESS)
2020-12-03 07:23:25,714 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48202 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741833_1011]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-2057880481-172.17.0.10-1606980199510:blk_1073741833_1011: PacketHeader with packetLen=520 header data: offsetInBlock: 512
seqno: 24
lastPacketInBlock: false
dataLen: 512

2020-12-03 07:23:25,714 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48202 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741833_1011]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741833_1011, type=LAST_IN_PIPELINE: enqueue Packet(seqno=24, lastPacketInBlock=false, offsetInBlock=1024, ackEnqueueNanoTime=141197489556927, ackStatus=SUCCESS)
2020-12-03 07:23:25,715 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741833_1011, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741833_1011, type=LAST_IN_PIPELINE, replyAck=seqno: 23 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:25,716 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741833_1011, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741833_1011, type=LAST_IN_PIPELINE, replyAck=seqno: 24 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:25,716 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741833_1011, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741833_1011, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-12-03 07:23:25,721 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48202 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741833_1011]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-2057880481-172.17.0.10-1606980199510:blk_1073741833_1011: PacketHeader with packetLen=4 header data: offsetInBlock: 1024
seqno: 25
lastPacketInBlock: true
dataLen: 0

2020-12-03 07:23:25,721 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48202 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741833_1011]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-2057880481-172.17.0.10-1606980199510:blk_1073741833_1011
2020-12-03 07:23:25,722 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48202 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741833_1011]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741833_1011, type=LAST_IN_PIPELINE: enqueue Packet(seqno=25, lastPacketInBlock=true, offsetInBlock=1024, ackEnqueueNanoTime=141197496877123, ackStatus=SUCCESS)
2020-12-03 07:23:25,724 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741833_1011, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:48202, dest: /127.0.0.1:46659, bytes: 1024, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_1712663744_1, offset: 0, srvID: 92140061-a997-4f98-95c8-65cba4629fb7, blockid: BP-2057880481-172.17.0.10-1606980199510:blk_1073741833_1011, duration(ns): 14553368
2020-12-03 07:23:25,725 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741833_1011, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741833_1011, type=LAST_IN_PIPELINE, replyAck=seqno: 25 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:25,726 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741833_1011, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741833_1011, type=LAST_IN_PIPELINE terminating
2020-12-03 07:23:25,726 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48202 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741833_1011]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741833_1011, type=LAST_IN_PIPELINE: closing
2020-12-03 07:23:25,727 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48202 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741833_1011]] DEBUG datanode.DataNode (DataXceiver.java:run(328)) - 127.0.0.1:46659:Number of active connections is: 2
2020-12-03 07:23:25,727 [IPC Server handler 3 on default port 35089] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1627)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:46659, datanodeUuid=92140061-a997-4f98-95c8-65cba4629fb7, infoPort=42682, infoSecurePort=0, ipcPort=38521, storageInfo=lv=-57;cid=testClusterID;nsid=200687926;c=1606980199510) 1 blocks.
2020-12-03 07:23:25,727 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(4021)) - Reported block blk_1073741833_1011 on 127.0.0.1:46659 size 1024 replicaState = FINALIZED
2020-12-03 07:23:25,727 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(4044)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-12-03 07:23:25,727 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3351)) - BLOCK* addStoredBlock: 127.0.0.1:46659 is added to blk_1073741833_1011 (size=0)
2020-12-03 07:23:25,728 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4154)) - BLOCK* block RECEIVED_BLOCK: blk_1073741833_1011 is received from 127.0.0.1:46659
2020-12-03 07:23:25,728 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4157)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:46659 receiving: 0, received: 1, deleted: 0
2020-12-03 07:23:25,728 [IPC Server handler 9 on default port 35089] DEBUG hdfs.StateChange (FSNamesystem.java:getAdditionalBlock(2767)) - BLOCK* getAdditionalBlock: /simpleAppend.dat  inodeId 16386 for DFSClient_NONMAPREDUCE_1712663744_1
2020-12-03 07:23:25,729 [IPC Server handler 9 on default port 35089] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addBlock(524)) - DIR* FSDirectory.addBlock: /simpleAppend.dat with blk_1073741834_1012 block is added to the in-memory file system
2020-12-03 07:23:25,729 [IPC Server handler 9 on default port 35089] INFO  hdfs.StateChange (FSDirWriteFileOp.java:logAllocatedBlock(798)) - BLOCK* allocate blk_1073741834_1012, replicas=127.0.0.1:46659 for /simpleAppend.dat
2020-12-03 07:23:25,729 [IPC Server handler 9 on default port 35089] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistNewBlock(758)) - persistNewBlock: /simpleAppend.dat with new block blk_1073741834_1012, current total block count is 10
2020-12-03 07:23:25,731 [DataStreamer for file /simpleAppend.dat] INFO  sasl.SaslDataTransferClient (SaslDataTransferClient.java:checkTrustAndSend(239)) - SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
2020-12-03 07:23:25,731 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@3276732] DEBUG datanode.DataNode (DataXceiver.java:<init>(154)) - Number of active connections is: 1
2020-12-03 07:23:25,733 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48210 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741834_1012]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(728)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_1712663744_1
  block  =BP-2057880481-172.17.0.10-1606980199510:blk_1073741834_1012, newGs=0, bytesRcvd=[0, 0]
  targets=[]; pipelineSize=1, srcDataNode=:0, pinning=false
2020-12-03 07:23:25,733 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48210 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741834_1012]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(734)) - isDatanode=false, isClient=true, isTransfer=false
2020-12-03 07:23:25,733 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48210 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741834_1012]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(736)) - writeBlock receive buf size 531128 tcp no delay true
2020-12-03 07:23:25,733 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48210 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741834_1012]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(747)) - Receiving BP-2057880481-172.17.0.10-1606980199510:blk_1073741834_1012 src: /127.0.0.1:48210 dest: /127.0.0.1:46659
2020-12-03 07:23:25,733 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48210 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741834_1012]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-2057880481-172.17.0.10-1606980199510:blk_1073741834_1012
 storageType=DISK, inAddr=/127.0.0.1:48210, myAddr=/127.0.0.1:46659
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_1712663744_1, srcDataNode=:0, datanode=127.0.0.1:46659
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-c636ee3f-1da8-4dc7-9587-a6f1cdb36618
2020-12-03 07:23:25,734 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48210 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741834_1012]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-2057880481-172.17.0.10-1606980199510/current/rbw/blk_1073741834 of size 0
2020-12-03 07:23:25,734 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48210 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741834_1012]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-2057880481-172.17.0.10-1606980199510/current/rbw/blk_1073741834_1012.meta of size 0
2020-12-03 07:23:25,736 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741834_1012, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741834_1012, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-12-03 07:23:25,742 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48210 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741834_1012]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-2057880481-172.17.0.10-1606980199510:blk_1073741834_1012: PacketHeader with packetLen=520 header data: offsetInBlock: 0
seqno: 26
lastPacketInBlock: false
dataLen: 512

2020-12-03 07:23:25,742 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48210 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741834_1012]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741834_1012, type=LAST_IN_PIPELINE: enqueue Packet(seqno=26, lastPacketInBlock=false, offsetInBlock=512, ackEnqueueNanoTime=141197517363601, ackStatus=SUCCESS)
2020-12-03 07:23:25,749 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48210 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741834_1012]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-2057880481-172.17.0.10-1606980199510:blk_1073741834_1012: PacketHeader with packetLen=520 header data: offsetInBlock: 512
seqno: 27
lastPacketInBlock: false
dataLen: 512

2020-12-03 07:23:25,749 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48210 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741834_1012]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741834_1012, type=LAST_IN_PIPELINE: enqueue Packet(seqno=27, lastPacketInBlock=false, offsetInBlock=1024, ackEnqueueNanoTime=141197524616976, ackStatus=SUCCESS)
2020-12-03 07:23:25,750 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741834_1012, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741834_1012, type=LAST_IN_PIPELINE, replyAck=seqno: 26 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:25,751 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741834_1012, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741834_1012, type=LAST_IN_PIPELINE, replyAck=seqno: 27 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:25,751 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741834_1012, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741834_1012, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-12-03 07:23:25,752 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48210 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741834_1012]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-2057880481-172.17.0.10-1606980199510:blk_1073741834_1012: PacketHeader with packetLen=4 header data: offsetInBlock: 1024
seqno: 28
lastPacketInBlock: true
dataLen: 0

2020-12-03 07:23:25,752 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48210 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741834_1012]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-2057880481-172.17.0.10-1606980199510:blk_1073741834_1012
2020-12-03 07:23:25,752 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48210 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741834_1012]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741834_1012, type=LAST_IN_PIPELINE: enqueue Packet(seqno=28, lastPacketInBlock=true, offsetInBlock=1024, ackEnqueueNanoTime=141197527307624, ackStatus=SUCCESS)
2020-12-03 07:23:25,755 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741834_1012, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:48210, dest: /127.0.0.1:46659, bytes: 1024, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_1712663744_1, offset: 0, srvID: 92140061-a997-4f98-95c8-65cba4629fb7, blockid: BP-2057880481-172.17.0.10-1606980199510:blk_1073741834_1012, duration(ns): 16873411
2020-12-03 07:23:25,755 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741834_1012, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741834_1012, type=LAST_IN_PIPELINE, replyAck=seqno: 28 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:25,755 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741834_1012, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741834_1012, type=LAST_IN_PIPELINE terminating
2020-12-03 07:23:25,756 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48210 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741834_1012]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741834_1012, type=LAST_IN_PIPELINE: closing
2020-12-03 07:23:25,761 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48210 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741834_1012]] DEBUG datanode.DataNode (DataXceiver.java:run(328)) - 127.0.0.1:46659:Number of active connections is: 2
2020-12-03 07:23:25,765 [IPC Server handler 5 on default port 35089] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1627)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:46659, datanodeUuid=92140061-a997-4f98-95c8-65cba4629fb7, infoPort=42682, infoSecurePort=0, ipcPort=38521, storageInfo=lv=-57;cid=testClusterID;nsid=200687926;c=1606980199510) 1 blocks.
2020-12-03 07:23:25,769 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(4021)) - Reported block blk_1073741834_1012 on 127.0.0.1:46659 size 1024 replicaState = FINALIZED
2020-12-03 07:23:25,769 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(4044)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-12-03 07:23:25,775 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3351)) - BLOCK* addStoredBlock: 127.0.0.1:46659 is added to blk_1073741834_1012 (size=0)
2020-12-03 07:23:25,775 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4154)) - BLOCK* block RECEIVED_BLOCK: blk_1073741834_1012 is received from 127.0.0.1:46659
2020-12-03 07:23:25,776 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4157)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:46659 receiving: 0, received: 1, deleted: 0
2020-12-03 07:23:25,776 [IPC Server handler 1 on default port 35089] DEBUG hdfs.StateChange (FSNamesystem.java:getAdditionalBlock(2767)) - BLOCK* getAdditionalBlock: /simpleAppend.dat  inodeId 16386 for DFSClient_NONMAPREDUCE_1712663744_1
2020-12-03 07:23:25,777 [IPC Server handler 1 on default port 35089] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addBlock(524)) - DIR* FSDirectory.addBlock: /simpleAppend.dat with blk_1073741835_1013 block is added to the in-memory file system
2020-12-03 07:23:25,778 [IPC Server handler 1 on default port 35089] INFO  hdfs.StateChange (FSDirWriteFileOp.java:logAllocatedBlock(798)) - BLOCK* allocate blk_1073741835_1013, replicas=127.0.0.1:46659 for /simpleAppend.dat
2020-12-03 07:23:25,778 [IPC Server handler 1 on default port 35089] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistNewBlock(758)) - persistNewBlock: /simpleAppend.dat with new block blk_1073741835_1013, current total block count is 11
2020-12-03 07:23:25,779 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@3276732] DEBUG datanode.DataNode (DataXceiver.java:<init>(154)) - Number of active connections is: 1
2020-12-03 07:23:25,780 [DataStreamer for file /simpleAppend.dat] INFO  sasl.SaslDataTransferClient (SaslDataTransferClient.java:checkTrustAndSend(239)) - SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
2020-12-03 07:23:25,782 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48214 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741835_1013]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(728)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_1712663744_1
  block  =BP-2057880481-172.17.0.10-1606980199510:blk_1073741835_1013, newGs=0, bytesRcvd=[0, 0]
  targets=[]; pipelineSize=1, srcDataNode=:0, pinning=false
2020-12-03 07:23:25,782 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48214 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741835_1013]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(734)) - isDatanode=false, isClient=true, isTransfer=false
2020-12-03 07:23:25,782 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48214 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741835_1013]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(736)) - writeBlock receive buf size 531128 tcp no delay true
2020-12-03 07:23:25,782 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48214 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741835_1013]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(747)) - Receiving BP-2057880481-172.17.0.10-1606980199510:blk_1073741835_1013 src: /127.0.0.1:48214 dest: /127.0.0.1:46659
2020-12-03 07:23:25,782 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48214 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741835_1013]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-2057880481-172.17.0.10-1606980199510:blk_1073741835_1013
 storageType=DISK, inAddr=/127.0.0.1:48214, myAddr=/127.0.0.1:46659
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_1712663744_1, srcDataNode=:0, datanode=127.0.0.1:46659
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-c636ee3f-1da8-4dc7-9587-a6f1cdb36618
2020-12-03 07:23:25,783 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48214 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741835_1013]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-2057880481-172.17.0.10-1606980199510/current/rbw/blk_1073741835 of size 0
2020-12-03 07:23:25,783 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48214 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741835_1013]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-2057880481-172.17.0.10-1606980199510/current/rbw/blk_1073741835_1013.meta of size 0
2020-12-03 07:23:25,789 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741835_1013, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741835_1013, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-12-03 07:23:25,790 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48214 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741835_1013]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-2057880481-172.17.0.10-1606980199510:blk_1073741835_1013: PacketHeader with packetLen=9 header data: offsetInBlock: 0
seqno: 29
lastPacketInBlock: false
dataLen: 1

2020-12-03 07:23:25,792 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48214 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741835_1013]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741835_1013, type=LAST_IN_PIPELINE: enqueue Packet(seqno=29, lastPacketInBlock=false, offsetInBlock=1, ackEnqueueNanoTime=141197567023610, ackStatus=SUCCESS)
2020-12-03 07:23:25,794 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741835_1013, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741835_1013, type=LAST_IN_PIPELINE, replyAck=seqno: 29 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:25,794 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741835_1013, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741835_1013, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-12-03 07:23:25,795 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48214 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741835_1013]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-2057880481-172.17.0.10-1606980199510:blk_1073741835_1013: PacketHeader with packetLen=4 header data: offsetInBlock: 1
seqno: 30
lastPacketInBlock: true
dataLen: 0

2020-12-03 07:23:25,795 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48214 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741835_1013]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-2057880481-172.17.0.10-1606980199510:blk_1073741835_1013
2020-12-03 07:23:25,795 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48214 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741835_1013]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741835_1013, type=LAST_IN_PIPELINE: enqueue Packet(seqno=30, lastPacketInBlock=true, offsetInBlock=1, ackEnqueueNanoTime=141197570706225, ackStatus=SUCCESS)
2020-12-03 07:23:25,797 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741835_1013, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:48214, dest: /127.0.0.1:46659, bytes: 1, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_1712663744_1, offset: 0, srvID: 92140061-a997-4f98-95c8-65cba4629fb7, blockid: BP-2057880481-172.17.0.10-1606980199510:blk_1073741835_1013, duration(ns): 6597157
2020-12-03 07:23:25,798 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741835_1013, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741835_1013, type=LAST_IN_PIPELINE, replyAck=seqno: 30 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:25,798 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741835_1013, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741835_1013, type=LAST_IN_PIPELINE terminating
2020-12-03 07:23:25,798 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48214 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741835_1013]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741835_1013, type=LAST_IN_PIPELINE: closing
2020-12-03 07:23:25,799 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48214 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741835_1013]] DEBUG datanode.DataNode (DataXceiver.java:run(328)) - 127.0.0.1:46659:Number of active connections is: 2
2020-12-03 07:23:25,800 [IPC Server handler 0 on default port 35089] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1627)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:46659, datanodeUuid=92140061-a997-4f98-95c8-65cba4629fb7, infoPort=42682, infoSecurePort=0, ipcPort=38521, storageInfo=lv=-57;cid=testClusterID;nsid=200687926;c=1606980199510) 1 blocks.
2020-12-03 07:23:25,800 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(4021)) - Reported block blk_1073741835_1013 on 127.0.0.1:46659 size 1 replicaState = FINALIZED
2020-12-03 07:23:25,800 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(4044)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-12-03 07:23:25,801 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3351)) - BLOCK* addStoredBlock: 127.0.0.1:46659 is added to blk_1073741835_1013 (size=0)
2020-12-03 07:23:25,801 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4154)) - BLOCK* block RECEIVED_BLOCK: blk_1073741835_1013 is received from 127.0.0.1:46659
2020-12-03 07:23:25,801 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4157)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:46659 receiving: 0, received: 1, deleted: 0
2020-12-03 07:23:25,801 [IPC Server handler 2 on default port 35089] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(674)) - DIR* NameSystem.completeFile: /simpleAppend.dat for DFSClient_NONMAPREDUCE_1712663744_1
2020-12-03 07:23:25,802 [IPC Server handler 2 on default port 35089] DEBUG hdfs.StateChange (FSNamesystem.java:closeFile(4036)) - closeFile: /simpleAppend.dat with 11 blocks is persisted to the file system
2020-12-03 07:23:25,802 [IPC Server handler 2 on default port 35089] INFO  hdfs.StateChange (FSNamesystem.java:completeFile(2948)) - DIR* completeFile: /simpleAppend.dat is closed by DFSClient_NONMAPREDUCE_1712663744_1
Wrote and Closed second part of file.
2020-12-03 07:23:25,808 [IPC Server handler 6 on default port 35089] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8074)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=getfileinfo	src=/simpleAppend.dat	dst=null	perm=null	proto=rpc
2020-12-03 07:23:25,818 [IPC Server handler 4 on default port 35089] DEBUG blockmanagement.BlockManager (BlockManager.java:createLocatedBlocks(1433)) - blocks = [blk_1073741825_1003, blk_1073741826_1004, blk_1073741827_1005, blk_1073741828_1006, blk_1073741829_1007, blk_1073741830_1008, blk_1073741831_1009, blk_1073741832_1010, blk_1073741833_1011, blk_1073741834_1012, blk_1073741835_1013]
2020-12-03 07:23:25,821 [IPC Server handler 4 on default port 35089] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8074)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=open	src=/simpleAppend.dat	dst=null	perm=null	proto=rpc
2020-12-03 07:23:25,840 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSInputStream.java:fetchLocatedBlocksAndGetLastBlockLength(243)) - newInfo = LocatedBlocks{;  fileLength=10241;  underConstruction=false;  blocks=[LocatedBlock{BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1003; getBlockSize()=1024; corrupt=false; offset=0; locs=[DatanodeInfoWithStorage[127.0.0.1:46659,DS-86c38d19-e1c7-408b-beec-a26b98ac3f35,DISK]]}, LocatedBlock{BP-2057880481-172.17.0.10-1606980199510:blk_1073741826_1004; getBlockSize()=1024; corrupt=false; offset=1024; locs=[DatanodeInfoWithStorage[127.0.0.1:46659,DS-c636ee3f-1da8-4dc7-9587-a6f1cdb36618,DISK]]}, LocatedBlock{BP-2057880481-172.17.0.10-1606980199510:blk_1073741827_1005; getBlockSize()=1024; corrupt=false; offset=2048; locs=[DatanodeInfoWithStorage[127.0.0.1:46659,DS-86c38d19-e1c7-408b-beec-a26b98ac3f35,DISK]]}, LocatedBlock{BP-2057880481-172.17.0.10-1606980199510:blk_1073741828_1006; getBlockSize()=1024; corrupt=false; offset=3072; locs=[DatanodeInfoWithStorage[127.0.0.1:46659,DS-c636ee3f-1da8-4dc7-9587-a6f1cdb36618,DISK]]}, LocatedBlock{BP-2057880481-172.17.0.10-1606980199510:blk_1073741829_1007; getBlockSize()=1024; corrupt=false; offset=4096; locs=[DatanodeInfoWithStorage[127.0.0.1:46659,DS-86c38d19-e1c7-408b-beec-a26b98ac3f35,DISK]]}, LocatedBlock{BP-2057880481-172.17.0.10-1606980199510:blk_1073741830_1008; getBlockSize()=1024; corrupt=false; offset=5120; locs=[DatanodeInfoWithStorage[127.0.0.1:46659,DS-c636ee3f-1da8-4dc7-9587-a6f1cdb36618,DISK]]}, LocatedBlock{BP-2057880481-172.17.0.10-1606980199510:blk_1073741831_1009; getBlockSize()=1024; corrupt=false; offset=6144; locs=[DatanodeInfoWithStorage[127.0.0.1:46659,DS-86c38d19-e1c7-408b-beec-a26b98ac3f35,DISK]]}, LocatedBlock{BP-2057880481-172.17.0.10-1606980199510:blk_1073741832_1010; getBlockSize()=1024; corrupt=false; offset=7168; locs=[DatanodeInfoWithStorage[127.0.0.1:46659,DS-c636ee3f-1da8-4dc7-9587-a6f1cdb36618,DISK]]}, LocatedBlock{BP-2057880481-172.17.0.10-1606980199510:blk_1073741833_1011; getBlockSize()=1024; corrupt=false; offset=8192; locs=[DatanodeInfoWithStorage[127.0.0.1:46659,DS-86c38d19-e1c7-408b-beec-a26b98ac3f35,DISK]]}, LocatedBlock{BP-2057880481-172.17.0.10-1606980199510:blk_1073741834_1012; getBlockSize()=1024; corrupt=false; offset=9216; locs=[DatanodeInfoWithStorage[127.0.0.1:46659,DS-c636ee3f-1da8-4dc7-9587-a6f1cdb36618,DISK]]}, LocatedBlock{BP-2057880481-172.17.0.10-1606980199510:blk_1073741835_1013; getBlockSize()=1; corrupt=false; offset=10240; locs=[DatanodeInfoWithStorage[127.0.0.1:46659,DS-86c38d19-e1c7-408b-beec-a26b98ac3f35,DISK]]}];  lastLocatedBlock=LocatedBlock{BP-2057880481-172.17.0.10-1606980199510:blk_1073741835_1013; getBlockSize()=1; corrupt=false; offset=10240; locs=[DatanodeInfoWithStorage[127.0.0.1:46659,DS-86c38d19-e1c7-408b-beec-a26b98ac3f35,DISK]]};  isLastBlockComplete=true;  ecPolicy=null}
2020-12-03 07:23:25,845 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSInputStream.java:getBestNodeDNAddrPair(952)) - Connecting to datanode 127.0.0.1:46659
2020-12-03 07:23:25,853 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@3276732] DEBUG datanode.DataNode (DataXceiver.java:<init>(154)) - Number of active connections is: 1
2020-12-03 07:23:25,855 [Listener at localhost/38521] INFO  sasl.SaslDataTransferClient (SaslDataTransferClient.java:checkTrustAndSend(239)) - SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
2020-12-03 07:23:25,878 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48228 [Sending block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1003]] DEBUG datanode.DataNode (BlockSender.java:<init>(287)) - block=BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1003, replica=FinalizedReplica, blk_1073741825_1003, FINALIZED
  getNumBytes()     = 1024
  getBytesOnDisk()  = 1024
  getVisibleLength()= 1024
  getVolume()       = /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1
  getBlockURI()     = file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-2057880481-172.17.0.10-1606980199510/current/finalized/subdir0/subdir0/blk_1073741825
2020-12-03 07:23:25,878 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48228 [Sending block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1003]] DEBUG datanode.DataNode (BlockSender.java:<init>(427)) - replica=FinalizedReplica, blk_1073741825_1003, FINALIZED
  getNumBytes()     = 1024
  getBytesOnDisk()  = 1024
  getVisibleLength()= 1024
  getVolume()       = /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1
  getBlockURI()     = file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-2057880481-172.17.0.10-1606980199510/current/finalized/subdir0/subdir0/blk_1073741825
2020-12-03 07:23:25,883 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48228 [Sending block BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1003]] DEBUG DataNode.clienttrace (BlockSender.java:doSendBlock(851)) - src: /127.0.0.1:46659, dest: /127.0.0.1:48228, bytes: 1032, op: HDFS_READ, cliID: DFSClient_NONMAPREDUCE_1712663744_1, offset: 0, srvID: 92140061-a997-4f98-95c8-65cba4629fb7, blockid: BP-2057880481-172.17.0.10-1606980199510:blk_1073741825_1003, duration(ns): 1801369
2020-12-03 07:23:25,889 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSInputStream.java:getBestNodeDNAddrPair(952)) - Connecting to datanode 127.0.0.1:46659
2020-12-03 07:23:25,891 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48228 [Sending block BP-2057880481-172.17.0.10-1606980199510:blk_1073741826_1004]] DEBUG datanode.DataNode (BlockSender.java:<init>(287)) - block=BP-2057880481-172.17.0.10-1606980199510:blk_1073741826_1004, replica=FinalizedReplica, blk_1073741826_1004, FINALIZED
  getNumBytes()     = 1024
  getBytesOnDisk()  = 1024
  getVisibleLength()= 1024
  getVolume()       = /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2
  getBlockURI()     = file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-2057880481-172.17.0.10-1606980199510/current/finalized/subdir0/subdir0/blk_1073741826
2020-12-03 07:23:25,892 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48228 [Sending block BP-2057880481-172.17.0.10-1606980199510:blk_1073741826_1004]] DEBUG datanode.DataNode (BlockSender.java:<init>(427)) - replica=FinalizedReplica, blk_1073741826_1004, FINALIZED
  getNumBytes()     = 1024
  getBytesOnDisk()  = 1024
  getVisibleLength()= 1024
  getVolume()       = /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2
  getBlockURI()     = file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-2057880481-172.17.0.10-1606980199510/current/finalized/subdir0/subdir0/blk_1073741826
2020-12-03 07:23:25,892 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48228 [Sending block BP-2057880481-172.17.0.10-1606980199510:blk_1073741826_1004]] DEBUG DataNode.clienttrace (BlockSender.java:doSendBlock(851)) - src: /127.0.0.1:46659, dest: /127.0.0.1:48228, bytes: 1032, op: HDFS_READ, cliID: DFSClient_NONMAPREDUCE_1712663744_1, offset: 0, srvID: 92140061-a997-4f98-95c8-65cba4629fb7, blockid: BP-2057880481-172.17.0.10-1606980199510:blk_1073741826_1004, duration(ns): 362156
2020-12-03 07:23:25,893 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSInputStream.java:getBestNodeDNAddrPair(952)) - Connecting to datanode 127.0.0.1:46659
2020-12-03 07:23:25,901 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48228 [Sending block BP-2057880481-172.17.0.10-1606980199510:blk_1073741827_1005]] DEBUG datanode.DataNode (BlockSender.java:<init>(287)) - block=BP-2057880481-172.17.0.10-1606980199510:blk_1073741827_1005, replica=FinalizedReplica, blk_1073741827_1005, FINALIZED
  getNumBytes()     = 1024
  getBytesOnDisk()  = 1024
  getVisibleLength()= 1024
  getVolume()       = /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1
  getBlockURI()     = file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-2057880481-172.17.0.10-1606980199510/current/finalized/subdir0/subdir0/blk_1073741827
2020-12-03 07:23:25,902 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48228 [Sending block BP-2057880481-172.17.0.10-1606980199510:blk_1073741827_1005]] DEBUG datanode.DataNode (BlockSender.java:<init>(427)) - replica=FinalizedReplica, blk_1073741827_1005, FINALIZED
  getNumBytes()     = 1024
  getBytesOnDisk()  = 1024
  getVisibleLength()= 1024
  getVolume()       = /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1
  getBlockURI()     = file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-2057880481-172.17.0.10-1606980199510/current/finalized/subdir0/subdir0/blk_1073741827
2020-12-03 07:23:25,903 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48228 [Sending block BP-2057880481-172.17.0.10-1606980199510:blk_1073741827_1005]] DEBUG DataNode.clienttrace (BlockSender.java:doSendBlock(851)) - src: /127.0.0.1:46659, dest: /127.0.0.1:48228, bytes: 1032, op: HDFS_READ, cliID: DFSClient_NONMAPREDUCE_1712663744_1, offset: 0, srvID: 92140061-a997-4f98-95c8-65cba4629fb7, blockid: BP-2057880481-172.17.0.10-1606980199510:blk_1073741827_1005, duration(ns): 406724
2020-12-03 07:23:25,903 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSInputStream.java:getBestNodeDNAddrPair(952)) - Connecting to datanode 127.0.0.1:46659
2020-12-03 07:23:25,905 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48228 [Sending block BP-2057880481-172.17.0.10-1606980199510:blk_1073741828_1006]] DEBUG datanode.DataNode (BlockSender.java:<init>(287)) - block=BP-2057880481-172.17.0.10-1606980199510:blk_1073741828_1006, replica=FinalizedReplica, blk_1073741828_1006, FINALIZED
  getNumBytes()     = 1024
  getBytesOnDisk()  = 1024
  getVisibleLength()= 1024
  getVolume()       = /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2
  getBlockURI()     = file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-2057880481-172.17.0.10-1606980199510/current/finalized/subdir0/subdir0/blk_1073741828
2020-12-03 07:23:25,905 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48228 [Sending block BP-2057880481-172.17.0.10-1606980199510:blk_1073741828_1006]] DEBUG datanode.DataNode (BlockSender.java:<init>(427)) - replica=FinalizedReplica, blk_1073741828_1006, FINALIZED
  getNumBytes()     = 1024
  getBytesOnDisk()  = 1024
  getVisibleLength()= 1024
  getVolume()       = /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2
  getBlockURI()     = file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-2057880481-172.17.0.10-1606980199510/current/finalized/subdir0/subdir0/blk_1073741828
2020-12-03 07:23:25,906 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48228 [Sending block BP-2057880481-172.17.0.10-1606980199510:blk_1073741828_1006]] DEBUG DataNode.clienttrace (BlockSender.java:doSendBlock(851)) - src: /127.0.0.1:46659, dest: /127.0.0.1:48228, bytes: 1032, op: HDFS_READ, cliID: DFSClient_NONMAPREDUCE_1712663744_1, offset: 0, srvID: 92140061-a997-4f98-95c8-65cba4629fb7, blockid: BP-2057880481-172.17.0.10-1606980199510:blk_1073741828_1006, duration(ns): 364027
2020-12-03 07:23:25,906 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSInputStream.java:getBestNodeDNAddrPair(952)) - Connecting to datanode 127.0.0.1:46659
2020-12-03 07:23:25,908 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48228 [Sending block BP-2057880481-172.17.0.10-1606980199510:blk_1073741829_1007]] DEBUG datanode.DataNode (BlockSender.java:<init>(287)) - block=BP-2057880481-172.17.0.10-1606980199510:blk_1073741829_1007, replica=FinalizedReplica, blk_1073741829_1007, FINALIZED
  getNumBytes()     = 1024
  getBytesOnDisk()  = 1024
  getVisibleLength()= 1024
  getVolume()       = /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1
  getBlockURI()     = file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-2057880481-172.17.0.10-1606980199510/current/finalized/subdir0/subdir0/blk_1073741829
2020-12-03 07:23:25,908 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48228 [Sending block BP-2057880481-172.17.0.10-1606980199510:blk_1073741829_1007]] DEBUG datanode.DataNode (BlockSender.java:<init>(427)) - replica=FinalizedReplica, blk_1073741829_1007, FINALIZED
  getNumBytes()     = 1024
  getBytesOnDisk()  = 1024
  getVisibleLength()= 1024
  getVolume()       = /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1
  getBlockURI()     = file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-2057880481-172.17.0.10-1606980199510/current/finalized/subdir0/subdir0/blk_1073741829
2020-12-03 07:23:25,909 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48228 [Sending block BP-2057880481-172.17.0.10-1606980199510:blk_1073741829_1007]] DEBUG DataNode.clienttrace (BlockSender.java:doSendBlock(851)) - src: /127.0.0.1:46659, dest: /127.0.0.1:48228, bytes: 1032, op: HDFS_READ, cliID: DFSClient_NONMAPREDUCE_1712663744_1, offset: 0, srvID: 92140061-a997-4f98-95c8-65cba4629fb7, blockid: BP-2057880481-172.17.0.10-1606980199510:blk_1073741829_1007, duration(ns): 455785
2020-12-03 07:23:25,910 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSInputStream.java:getBestNodeDNAddrPair(952)) - Connecting to datanode 127.0.0.1:46659
2020-12-03 07:23:25,913 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48228 [Sending block BP-2057880481-172.17.0.10-1606980199510:blk_1073741830_1008]] DEBUG datanode.DataNode (BlockSender.java:<init>(287)) - block=BP-2057880481-172.17.0.10-1606980199510:blk_1073741830_1008, replica=FinalizedReplica, blk_1073741830_1008, FINALIZED
  getNumBytes()     = 1024
  getBytesOnDisk()  = 1024
  getVisibleLength()= 1024
  getVolume()       = /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2
  getBlockURI()     = file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-2057880481-172.17.0.10-1606980199510/current/finalized/subdir0/subdir0/blk_1073741830
2020-12-03 07:23:25,915 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48228 [Sending block BP-2057880481-172.17.0.10-1606980199510:blk_1073741830_1008]] DEBUG datanode.DataNode (BlockSender.java:<init>(427)) - replica=FinalizedReplica, blk_1073741830_1008, FINALIZED
  getNumBytes()     = 1024
  getBytesOnDisk()  = 1024
  getVisibleLength()= 1024
  getVolume()       = /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2
  getBlockURI()     = file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-2057880481-172.17.0.10-1606980199510/current/finalized/subdir0/subdir0/blk_1073741830
2020-12-03 07:23:25,916 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48228 [Sending block BP-2057880481-172.17.0.10-1606980199510:blk_1073741830_1008]] DEBUG DataNode.clienttrace (BlockSender.java:doSendBlock(851)) - src: /127.0.0.1:46659, dest: /127.0.0.1:48228, bytes: 1032, op: HDFS_READ, cliID: DFSClient_NONMAPREDUCE_1712663744_1, offset: 0, srvID: 92140061-a997-4f98-95c8-65cba4629fb7, blockid: BP-2057880481-172.17.0.10-1606980199510:blk_1073741830_1008, duration(ns): 449203
2020-12-03 07:23:25,916 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSInputStream.java:getBestNodeDNAddrPair(952)) - Connecting to datanode 127.0.0.1:46659
2020-12-03 07:23:25,919 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48228 [Sending block BP-2057880481-172.17.0.10-1606980199510:blk_1073741831_1009]] DEBUG datanode.DataNode (BlockSender.java:<init>(287)) - block=BP-2057880481-172.17.0.10-1606980199510:blk_1073741831_1009, replica=FinalizedReplica, blk_1073741831_1009, FINALIZED
  getNumBytes()     = 1024
  getBytesOnDisk()  = 1024
  getVisibleLength()= 1024
  getVolume()       = /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1
  getBlockURI()     = file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-2057880481-172.17.0.10-1606980199510/current/finalized/subdir0/subdir0/blk_1073741831
2020-12-03 07:23:25,920 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48228 [Sending block BP-2057880481-172.17.0.10-1606980199510:blk_1073741831_1009]] DEBUG datanode.DataNode (BlockSender.java:<init>(427)) - replica=FinalizedReplica, blk_1073741831_1009, FINALIZED
  getNumBytes()     = 1024
  getBytesOnDisk()  = 1024
  getVisibleLength()= 1024
  getVolume()       = /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1
  getBlockURI()     = file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-2057880481-172.17.0.10-1606980199510/current/finalized/subdir0/subdir0/blk_1073741831
2020-12-03 07:23:25,921 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48228 [Sending block BP-2057880481-172.17.0.10-1606980199510:blk_1073741831_1009]] DEBUG DataNode.clienttrace (BlockSender.java:doSendBlock(851)) - src: /127.0.0.1:46659, dest: /127.0.0.1:48228, bytes: 1032, op: HDFS_READ, cliID: DFSClient_NONMAPREDUCE_1712663744_1, offset: 0, srvID: 92140061-a997-4f98-95c8-65cba4629fb7, blockid: BP-2057880481-172.17.0.10-1606980199510:blk_1073741831_1009, duration(ns): 428897
2020-12-03 07:23:25,921 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSInputStream.java:getBestNodeDNAddrPair(952)) - Connecting to datanode 127.0.0.1:46659
2020-12-03 07:23:25,924 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48228 [Sending block BP-2057880481-172.17.0.10-1606980199510:blk_1073741832_1010]] DEBUG datanode.DataNode (BlockSender.java:<init>(287)) - block=BP-2057880481-172.17.0.10-1606980199510:blk_1073741832_1010, replica=FinalizedReplica, blk_1073741832_1010, FINALIZED
  getNumBytes()     = 1024
  getBytesOnDisk()  = 1024
  getVisibleLength()= 1024
  getVolume()       = /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2
  getBlockURI()     = file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-2057880481-172.17.0.10-1606980199510/current/finalized/subdir0/subdir0/blk_1073741832
2020-12-03 07:23:25,924 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48228 [Sending block BP-2057880481-172.17.0.10-1606980199510:blk_1073741832_1010]] DEBUG datanode.DataNode (BlockSender.java:<init>(427)) - replica=FinalizedReplica, blk_1073741832_1010, FINALIZED
  getNumBytes()     = 1024
  getBytesOnDisk()  = 1024
  getVisibleLength()= 1024
  getVolume()       = /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2
  getBlockURI()     = file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-2057880481-172.17.0.10-1606980199510/current/finalized/subdir0/subdir0/blk_1073741832
2020-12-03 07:23:25,925 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48228 [Sending block BP-2057880481-172.17.0.10-1606980199510:blk_1073741832_1010]] DEBUG DataNode.clienttrace (BlockSender.java:doSendBlock(851)) - src: /127.0.0.1:46659, dest: /127.0.0.1:48228, bytes: 1032, op: HDFS_READ, cliID: DFSClient_NONMAPREDUCE_1712663744_1, offset: 0, srvID: 92140061-a997-4f98-95c8-65cba4629fb7, blockid: BP-2057880481-172.17.0.10-1606980199510:blk_1073741832_1010, duration(ns): 421939
2020-12-03 07:23:25,926 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSInputStream.java:getBestNodeDNAddrPair(952)) - Connecting to datanode 127.0.0.1:46659
2020-12-03 07:23:25,929 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48228 [Sending block BP-2057880481-172.17.0.10-1606980199510:blk_1073741833_1011]] DEBUG datanode.DataNode (BlockSender.java:<init>(287)) - block=BP-2057880481-172.17.0.10-1606980199510:blk_1073741833_1011, replica=FinalizedReplica, blk_1073741833_1011, FINALIZED
  getNumBytes()     = 1024
  getBytesOnDisk()  = 1024
  getVisibleLength()= 1024
  getVolume()       = /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1
  getBlockURI()     = file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-2057880481-172.17.0.10-1606980199510/current/finalized/subdir0/subdir0/blk_1073741833
2020-12-03 07:23:25,930 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48228 [Sending block BP-2057880481-172.17.0.10-1606980199510:blk_1073741833_1011]] DEBUG datanode.DataNode (BlockSender.java:<init>(427)) - replica=FinalizedReplica, blk_1073741833_1011, FINALIZED
  getNumBytes()     = 1024
  getBytesOnDisk()  = 1024
  getVisibleLength()= 1024
  getVolume()       = /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1
  getBlockURI()     = file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-2057880481-172.17.0.10-1606980199510/current/finalized/subdir0/subdir0/blk_1073741833
2020-12-03 07:23:25,931 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48228 [Sending block BP-2057880481-172.17.0.10-1606980199510:blk_1073741833_1011]] DEBUG DataNode.clienttrace (BlockSender.java:doSendBlock(851)) - src: /127.0.0.1:46659, dest: /127.0.0.1:48228, bytes: 1032, op: HDFS_READ, cliID: DFSClient_NONMAPREDUCE_1712663744_1, offset: 0, srvID: 92140061-a997-4f98-95c8-65cba4629fb7, blockid: BP-2057880481-172.17.0.10-1606980199510:blk_1073741833_1011, duration(ns): 405157
2020-12-03 07:23:25,931 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSInputStream.java:getBestNodeDNAddrPair(952)) - Connecting to datanode 127.0.0.1:46659
2020-12-03 07:23:25,932 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48228 [Sending block BP-2057880481-172.17.0.10-1606980199510:blk_1073741834_1012]] DEBUG datanode.DataNode (BlockSender.java:<init>(287)) - block=BP-2057880481-172.17.0.10-1606980199510:blk_1073741834_1012, replica=FinalizedReplica, blk_1073741834_1012, FINALIZED
  getNumBytes()     = 1024
  getBytesOnDisk()  = 1024
  getVisibleLength()= 1024
  getVolume()       = /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2
  getBlockURI()     = file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-2057880481-172.17.0.10-1606980199510/current/finalized/subdir0/subdir0/blk_1073741834
2020-12-03 07:23:25,933 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48228 [Sending block BP-2057880481-172.17.0.10-1606980199510:blk_1073741834_1012]] DEBUG datanode.DataNode (BlockSender.java:<init>(427)) - replica=FinalizedReplica, blk_1073741834_1012, FINALIZED
  getNumBytes()     = 1024
  getBytesOnDisk()  = 1024
  getVisibleLength()= 1024
  getVolume()       = /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2
  getBlockURI()     = file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-2057880481-172.17.0.10-1606980199510/current/finalized/subdir0/subdir0/blk_1073741834
2020-12-03 07:23:25,934 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48228 [Sending block BP-2057880481-172.17.0.10-1606980199510:blk_1073741834_1012]] DEBUG DataNode.clienttrace (BlockSender.java:doSendBlock(851)) - src: /127.0.0.1:46659, dest: /127.0.0.1:48228, bytes: 1032, op: HDFS_READ, cliID: DFSClient_NONMAPREDUCE_1712663744_1, offset: 0, srvID: 92140061-a997-4f98-95c8-65cba4629fb7, blockid: BP-2057880481-172.17.0.10-1606980199510:blk_1073741834_1012, duration(ns): 392750
2020-12-03 07:23:25,936 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSInputStream.java:getBestNodeDNAddrPair(952)) - Connecting to datanode 127.0.0.1:46659
2020-12-03 07:23:25,938 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48228 [Sending block BP-2057880481-172.17.0.10-1606980199510:blk_1073741835_1013]] DEBUG datanode.DataNode (BlockSender.java:<init>(287)) - block=BP-2057880481-172.17.0.10-1606980199510:blk_1073741835_1013, replica=FinalizedReplica, blk_1073741835_1013, FINALIZED
  getNumBytes()     = 1
  getBytesOnDisk()  = 1
  getVisibleLength()= 1
  getVolume()       = /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1
  getBlockURI()     = file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-2057880481-172.17.0.10-1606980199510/current/finalized/subdir0/subdir0/blk_1073741835
2020-12-03 07:23:25,938 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48228 [Sending block BP-2057880481-172.17.0.10-1606980199510:blk_1073741835_1013]] DEBUG datanode.DataNode (BlockSender.java:<init>(427)) - replica=FinalizedReplica, blk_1073741835_1013, FINALIZED
  getNumBytes()     = 1
  getBytesOnDisk()  = 1
  getVisibleLength()= 1
  getVolume()       = /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1
  getBlockURI()     = file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-2057880481-172.17.0.10-1606980199510/current/finalized/subdir0/subdir0/blk_1073741835
2020-12-03 07:23:25,939 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48228 [Sending block BP-2057880481-172.17.0.10-1606980199510:blk_1073741835_1013]] DEBUG DataNode.clienttrace (BlockSender.java:doSendBlock(851)) - src: /127.0.0.1:46659, dest: /127.0.0.1:48228, bytes: 5, op: HDFS_READ, cliID: DFSClient_NONMAPREDUCE_1712663744_1, offset: 0, srvID: 92140061-a997-4f98-95c8-65cba4629fb7, blockid: BP-2057880481-172.17.0.10-1606980199510:blk_1073741835_1013, duration(ns): 408766
2020-12-03 07:23:25,959 [IPC Server handler 7 on default port 35089] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(809)) - *DIR* NameNode.append: file /non-existing.dat for DFSClient_NONMAPREDUCE_1712663744_1 at 127.0.0.1
2020-12-03 07:23:25,960 [IPC Server handler 7 on default port 35089] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2710)) - DIR* NameSystem.appendFile: src=/non-existing.dat, holder=DFSClient_NONMAPREDUCE_1712663744_1, clientMachine=127.0.0.1
2020-12-03 07:23:25,961 [IPC Server handler 7 on default port 35089] WARN  hdfs.StateChange (FSDirAppendOp.java:appendFile(145)) - DIR* NameSystem.append: Failed to append to non-existent file /non-existing.dat for client 127.0.0.1
2020-12-03 07:23:25,962 [IPC Server handler 7 on default port 35089] INFO  ipc.Server (Server.java:logException(2969)) - IPC Server handler 7 on default port 35089, call Call#49 Retry#0 org.apache.hadoop.hdfs.protocol.ClientProtocol.append from 127.0.0.1:37936: java.io.FileNotFoundException: Failed to append to non-existent file /non-existing.dat for client 127.0.0.1
Good: got java.io.FileNotFoundException: Failed to append to non-existent file /non-existing.dat for client 127.0.0.1
	at org.apache.hadoop.hdfs.server.namenode.FSDirAppendOp.appendFile(FSDirAppendOp.java:104)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.appendFile(FSNamesystem.java:2722)
	at org.apache.hadoop.hdfs.server.namenode.NameNodeRpcServer.append(NameNodeRpcServer.java:822)
	at org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolServerSideTranslatorPB.append(ClientNamenodeProtocolServerSideTranslatorPB.java:500)
	at org.apache.hadoop.hdfs.protocol.proto.ClientNamenodeProtocolProtos$ClientNamenodeProtocol$2.callBlockingMethod(ClientNamenodeProtocolProtos.java)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine.java:528)
	at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:1070)
	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:999)
	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:927)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1730)
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2915)

java.io.FileNotFoundException: Failed to append to non-existent file /non-existing.dat for client 127.0.0.1
	at org.apache.hadoop.hdfs.server.namenode.FSDirAppendOp.appendFile(FSDirAppendOp.java:104)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.appendFile(FSNamesystem.java:2722)
	at org.apache.hadoop.hdfs.server.namenode.NameNodeRpcServer.append(NameNodeRpcServer.java:822)
	at org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolServerSideTranslatorPB.append(ClientNamenodeProtocolServerSideTranslatorPB.java:500)
	at org.apache.hadoop.hdfs.protocol.proto.ClientNamenodeProtocolProtos$ClientNamenodeProtocol$2.callBlockingMethod(ClientNamenodeProtocolProtos.java)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine.java:528)
	at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:1070)
	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:999)
	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:927)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1730)
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2915)

	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.hadoop.ipc.RemoteException.instantiateException(RemoteException.java:121)
	at org.apache.hadoop.ipc.RemoteException.unwrapRemoteException(RemoteException.java:88)
	at org.apache.hadoop.hdfs.DFSClient.callAppend(DFSClient.java:1362)
	at org.apache.hadoop.hdfs.DFSClient.append(DFSClient.java:1419)
	at org.apache.hadoop.hdfs.DFSClient.append(DFSClient.java:1389)
	at org.apache.hadoop.hdfs.DistributedFileSystem$5.doCall(DistributedFileSystem.java:420)
	at org.apache.hadoop.hdfs.DistributedFileSystem$5.doCall(DistributedFileSystem.java:416)
	at org.apache.hadoop.fs.FileSystemLinkResolver.resolve(FileSystemLinkResolver.java:81)
	at org.apache.hadoop.hdfs.DistributedFileSystem.append(DistributedFileSystem.java:428)
	at org.apache.hadoop.hdfs.DistributedFileSystem.append(DistributedFileSystem.java:397)
	at org.apache.hadoop.fs.FileSystem.append(FileSystem.java:1379)
	at org.apache.hadoop.hdfs.TestFileAppend2.testSimpleAppend(TestFileAppend2.java:130)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
Caused by: org.apache.hadoop.ipc.RemoteException(java.io.FileNotFoundException): Failed to append to non-existent file /non-existing.dat for client 127.0.0.1
	at org.apache.hadoop.hdfs.server.namenode.FSDirAppendOp.appendFile(FSDirAppendOp.java:104)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.appendFile(FSNamesystem.java:2722)
	at org.apache.hadoop.hdfs.server.namenode.NameNodeRpcServer.append(NameNodeRpcServer.java:822)
	at org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolServerSideTranslatorPB.append(ClientNamenodeProtocolServerSideTranslatorPB.java:500)
	at org.apache.hadoop.hdfs.protocol.proto.ClientNamenodeProtocolProtos$ClientNamenodeProtocol$2.callBlockingMethod(ClientNamenodeProtocolProtos.java)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine.java:528)
	at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:1070)
	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:999)
	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:927)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1730)
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2915)

	at org.apache.hadoop.ipc.Client.getRpcResponse(Client.java:1545)
	at org.apache.hadoop.ipc.Client.call(Client.java:1491)
	at org.apache.hadoop.ipc.Client.call(Client.java:1388)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:233)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:118)
	at com.sun.proxy.$Proxy23.append(Unknown Source)
	at org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolTranslatorPB.append(ClientNamenodeProtocolTranslatorPB.java:400)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.io.retry.RetryInvocationHandler.invokeMethod(RetryInvocationHandler.java:422)
	at org.apache.hadoop.io.retry.RetryInvocationHandler$Call.invokeMethod(RetryInvocationHandler.java:165)
	at org.apache.hadoop.io.retry.RetryInvocationHandler$Call.invoke(RetryInvocationHandler.java:157)
	at org.apache.hadoop.io.retry.RetryInvocationHandler$Call.invokeOnce(RetryInvocationHandler.java:95)
	at org.apache.hadoop.io.retry.RetryInvocationHandler.invoke(RetryInvocationHandler.java:359)
	at com.sun.proxy.$Proxy24.append(Unknown Source)
	at org.apache.hadoop.hdfs.DFSClient.callAppend(DFSClient.java:1328)
	at org.apache.hadoop.hdfs.DFSClient.callAppend(DFSClient.java:1350)
	... 34 more
2020-12-03 07:23:25,981 [IPC Server handler 8 on default port 35089] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8074)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=setPermission	src=/	dst=null	perm=root:supergroup:rwxrwxrwx	proto=rpc
2020-12-03 07:23:25,996 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSClient.java:<init>(318)) - Sets dfs.client.block.write.replace-datanode-on-failure.min-replication to 0
2020-12-03 07:23:25,998 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSClient.java:create(1216)) - /TestFileAppend2/foo.dat: masked={ masked: rw-r--r--, unmasked: rw-rw-rw- }
2020-12-03 07:23:26,003 [IPC Server handler 3 on default port 35089] DEBUG hdfs.StateChange (NameNodeRpcServer.java:create(774)) - *DIR* NameNode.create: file /TestFileAppend2/foo.dat for DFSClient_NONMAPREDUCE_2923820_1 at 127.0.0.1
2020-12-03 07:23:26,003 [IPC Server handler 3 on default port 35089] DEBUG hdfs.StateChange (FSNamesystem.java:startFileInt(2460)) - DIR* NameSystem.startFile: src=/TestFileAppend2/foo.dat, holder=DFSClient_NONMAPREDUCE_2923820_1, clientMachine=127.0.0.1, createParent=true, replication=1, createFlag=[CREATE, OVERWRITE], blockSize=134217728, supportedVersions=[CryptoProtocolVersion{description='Encryption zones', version=2, unknownValue=null}]
2020-12-03 07:23:26,005 [IPC Server handler 3 on default port 35089] DEBUG hdfs.StateChange (FSDirMkdirOp.java:createSingleDirectory(182)) - mkdirs: created directory /TestFileAppend2
2020-12-03 07:23:26,006 [IPC Server handler 3 on default port 35089] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addFile(579)) - DIR* addFile: foo.dat is added
2020-12-03 07:23:26,006 [IPC Server handler 3 on default port 35089] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:startFile(415)) - DIR* NameSystem.startFile: added /TestFileAppend2/foo.dat inode 16388 DFSClient_NONMAPREDUCE_2923820_1
2020-12-03 07:23:26,007 [IPC Server handler 3 on default port 35089] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8074)) - allowed=true	ugi=testappenduser (auth:SIMPLE)	ip=/127.0.0.1	cmd=create	src=/TestFileAppend2/foo.dat	dst=null	perm=testappenduser:supergroup:rw-r--r--	proto=rpc
2020-12-03 07:23:26,009 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/TestFileAppend2/foo.dat, chunkSize=516, chunksPerPacket=126, packetSize=65016
2020-12-03 07:23:26,010 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=0, src=/TestFileAppend2/foo.dat, packetSize=65016, chunksPerPacket=126, bytesCurBlock=0, DFSOutputStream:block==null
2020-12-03 07:23:26,012 [IPC Server handler 9 on default port 35089] DEBUG hdfs.StateChange (FSNamesystem.java:getAdditionalBlock(2767)) - BLOCK* getAdditionalBlock: /TestFileAppend2/foo.dat  inodeId 16388 for DFSClient_NONMAPREDUCE_2923820_1
2020-12-03 07:23:26,013 [IPC Server handler 9 on default port 35089] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addBlock(524)) - DIR* FSDirectory.addBlock: /TestFileAppend2/foo.dat with blk_1073741836_1014 block is added to the in-memory file system
2020-12-03 07:23:26,013 [IPC Server handler 9 on default port 35089] INFO  hdfs.StateChange (FSDirWriteFileOp.java:logAllocatedBlock(798)) - BLOCK* allocate blk_1073741836_1014, replicas=127.0.0.1:46659 for /TestFileAppend2/foo.dat
2020-12-03 07:23:26,014 [IPC Server handler 9 on default port 35089] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistNewBlock(758)) - persistNewBlock: /TestFileAppend2/foo.dat with new block blk_1073741836_1014, current total block count is 1
2020-12-03 07:23:26,019 [Thread-176] INFO  sasl.SaslDataTransferClient (SaslDataTransferClient.java:checkTrustAndSend(239)) - SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
2020-12-03 07:23:26,020 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@3276732] DEBUG datanode.DataNode (DataXceiver.java:<init>(154)) - Number of active connections is: 2
2020-12-03 07:23:26,076 [DataXceiver for client DFSClient_NONMAPREDUCE_2923820_1 at /127.0.0.1:48298 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1014]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(728)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_2923820_1
  block  =BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1014, newGs=0, bytesRcvd=[0, 0]
  targets=[]; pipelineSize=1, srcDataNode=:0, pinning=false
2020-12-03 07:23:26,076 [DataXceiver for client DFSClient_NONMAPREDUCE_2923820_1 at /127.0.0.1:48298 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1014]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(734)) - isDatanode=false, isClient=true, isTransfer=false
2020-12-03 07:23:26,077 [DataXceiver for client DFSClient_NONMAPREDUCE_2923820_1 at /127.0.0.1:48298 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1014]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(736)) - writeBlock receive buf size 531128 tcp no delay true
2020-12-03 07:23:26,077 [DataXceiver for client DFSClient_NONMAPREDUCE_2923820_1 at /127.0.0.1:48298 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1014]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(747)) - Receiving BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1014 src: /127.0.0.1:48298 dest: /127.0.0.1:46659
2020-12-03 07:23:26,077 [DataXceiver for client DFSClient_NONMAPREDUCE_2923820_1 at /127.0.0.1:48298 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1014]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1014
 storageType=DISK, inAddr=/127.0.0.1:48298, myAddr=/127.0.0.1:46659
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_2923820_1, srcDataNode=:0, datanode=127.0.0.1:46659
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-c636ee3f-1da8-4dc7-9587-a6f1cdb36618
2020-12-03 07:23:26,078 [DataXceiver for client DFSClient_NONMAPREDUCE_2923820_1 at /127.0.0.1:48298 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1014]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-2057880481-172.17.0.10-1606980199510/current/rbw/blk_1073741836 of size 0
2020-12-03 07:23:26,078 [DataXceiver for client DFSClient_NONMAPREDUCE_2923820_1 at /127.0.0.1:48298 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1014]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-2057880481-172.17.0.10-1606980199510/current/rbw/blk_1073741836_1014.meta of size 0
2020-12-03 07:23:26,079 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1014, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1014, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-12-03 07:23:26,083 [DataXceiver for client DFSClient_NONMAPREDUCE_2923820_1 at /127.0.0.1:48298 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1014]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1014: PacketHeader with packetLen=92 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 84

2020-12-03 07:23:26,083 [DataXceiver for client DFSClient_NONMAPREDUCE_2923820_1 at /127.0.0.1:48298 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1014]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1014, type=LAST_IN_PIPELINE: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=84, ackEnqueueNanoTime=141197858758220, ackStatus=SUCCESS)
2020-12-03 07:23:26,085 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1014, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1014, type=LAST_IN_PIPELINE, replyAck=seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:26,085 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1014, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1014, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-12-03 07:23:26,086 [DataXceiver for client DFSClient_NONMAPREDUCE_2923820_1 at /127.0.0.1:48298 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1014]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1014: PacketHeader with packetLen=4 header data: offsetInBlock: 84
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-12-03 07:23:26,086 [DataXceiver for client DFSClient_NONMAPREDUCE_2923820_1 at /127.0.0.1:48298 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1014]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1014
2020-12-03 07:23:26,086 [DataXceiver for client DFSClient_NONMAPREDUCE_2923820_1 at /127.0.0.1:48298 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1014]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1014, type=LAST_IN_PIPELINE: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=84, ackEnqueueNanoTime=141197861248790, ackStatus=SUCCESS)
2020-12-03 07:23:26,088 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1014, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:48298, dest: /127.0.0.1:46659, bytes: 84, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_2923820_1, offset: 0, srvID: 92140061-a997-4f98-95c8-65cba4629fb7, blockid: BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1014, duration(ns): 7447717
2020-12-03 07:23:26,088 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1014, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1014, type=LAST_IN_PIPELINE, replyAck=seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:26,088 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1014, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1014, type=LAST_IN_PIPELINE terminating
2020-12-03 07:23:26,088 [DataXceiver for client DFSClient_NONMAPREDUCE_2923820_1 at /127.0.0.1:48298 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1014]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1014, type=LAST_IN_PIPELINE: closing
2020-12-03 07:23:26,089 [DataXceiver for client DFSClient_NONMAPREDUCE_2923820_1 at /127.0.0.1:48298 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1014]] DEBUG datanode.DataNode (DataXceiver.java:run(328)) - 127.0.0.1:46659:Number of active connections is: 3
2020-12-03 07:23:26,090 [IPC Server handler 1 on default port 35089] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1627)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:46659, datanodeUuid=92140061-a997-4f98-95c8-65cba4629fb7, infoPort=42682, infoSecurePort=0, ipcPort=38521, storageInfo=lv=-57;cid=testClusterID;nsid=200687926;c=1606980199510) 1 blocks.
2020-12-03 07:23:26,090 [IPC Server handler 0 on default port 35089] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(674)) - DIR* NameSystem.completeFile: /TestFileAppend2/foo.dat for DFSClient_NONMAPREDUCE_2923820_1
2020-12-03 07:23:26,091 [IPC Server handler 0 on default port 35089] INFO  namenode.FSNamesystem (FSNamesystem.java:checkBlocksComplete(2995)) - BLOCK* blk_1073741836_1014 is COMMITTED but not COMPLETE(numNodes= 0 <  minimum = 1) in file /TestFileAppend2/foo.dat
2020-12-03 07:23:26,091 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(4021)) - Reported block blk_1073741836_1014 on 127.0.0.1:46659 size 84 replicaState = FINALIZED
2020-12-03 07:23:26,091 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(4044)) - In memory blockUCState = COMMITTED
2020-12-03 07:23:26,091 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3351)) - BLOCK* addStoredBlock: 127.0.0.1:46659 is added to blk_1073741836_1014 (size=84)
2020-12-03 07:23:26,092 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4154)) - BLOCK* block RECEIVED_BLOCK: blk_1073741836_1014 is received from 127.0.0.1:46659
2020-12-03 07:23:26,092 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4157)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:46659 receiving: 0, received: 1, deleted: 0
2020-12-03 07:23:26,494 [IPC Server handler 2 on default port 35089] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(674)) - DIR* NameSystem.completeFile: /TestFileAppend2/foo.dat for DFSClient_NONMAPREDUCE_2923820_1
2020-12-03 07:23:26,494 [IPC Server handler 2 on default port 35089] DEBUG hdfs.StateChange (FSNamesystem.java:closeFile(4036)) - closeFile: /TestFileAppend2/foo.dat with 1 blocks is persisted to the file system
2020-12-03 07:23:26,494 [IPC Server handler 2 on default port 35089] INFO  hdfs.StateChange (FSNamesystem.java:completeFile(2948)) - DIR* completeFile: /TestFileAppend2/foo.dat is closed by DFSClient_NONMAPREDUCE_2923820_1
2020-12-03 07:23:26,497 [IPC Server handler 6 on default port 35089] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8074)) - allowed=true	ugi=testappenduser (auth:SIMPLE)	ip=/127.0.0.1	cmd=setPermission	src=/TestFileAppend2	dst=null	perm=testappenduser:supergroup:--x------	proto=rpc
2020-12-03 07:23:26,502 [IPC Server handler 4 on default port 35089] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8074)) - allowed=true	ugi=testappenduser (auth:SIMPLE)	ip=/127.0.0.1	cmd=setPermission	src=/TestFileAppend2/foo.dat	dst=null	perm=testappenduser:supergroup:-w-------	proto=rpc
2020-12-03 07:23:26,504 [IPC Server handler 7 on default port 35089] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(809)) - *DIR* NameNode.append: file /TestFileAppend2/foo.dat for DFSClient_NONMAPREDUCE_2923820_1 at 127.0.0.1
2020-12-03 07:23:26,504 [IPC Server handler 7 on default port 35089] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2710)) - DIR* NameSystem.appendFile: src=/TestFileAppend2/foo.dat, holder=DFSClient_NONMAPREDUCE_2923820_1, clientMachine=127.0.0.1
2020-12-03 07:23:26,505 [IPC Server handler 7 on default port 35089] DEBUG hdfs.StateChange (FSDirAppendOp.java:appendFile(154)) - DIR* NameSystem.appendFile: file /TestFileAppend2/foo.dat for DFSClient_NONMAPREDUCE_2923820_1 at 127.0.0.1 block BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1014 block size 84
2020-12-03 07:23:26,506 [IPC Server handler 7 on default port 35089] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8074)) - allowed=true	ugi=testappenduser (auth:SIMPLE)	ip=/127.0.0.1	cmd=append	src=/TestFileAppend2/foo.dat	dst=null	perm=null	proto=rpc
2020-12-03 07:23:26,508 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/TestFileAppend2/foo.dat, chunkSize=432, chunksPerPacket=1, packetSize=432
2020-12-03 07:23:26,508 [Listener at localhost/38521] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=0, src=/TestFileAppend2/foo.dat, packetSize=432, chunksPerPacket=1, bytesCurBlock=84, DFSOutputStream:blk_1073741836_1014
2020-12-03 07:23:26,517 [Thread-181] INFO  sasl.SaslDataTransferClient (SaslDataTransferClient.java:checkTrustAndSend(239)) - SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false
2020-12-03 07:23:26,517 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@3276732] DEBUG datanode.DataNode (DataXceiver.java:<init>(154)) - Number of active connections is: 2
2020-12-03 07:23:26,519 [DataXceiver for client DFSClient_NONMAPREDUCE_2923820_1 at /127.0.0.1:48462 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1014]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(728)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_2923820_1
  block  =BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1014, newGs=1015, bytesRcvd=[84, 84]
  targets=[]; pipelineSize=1, srcDataNode=:0, pinning=false
2020-12-03 07:23:26,519 [DataXceiver for client DFSClient_NONMAPREDUCE_2923820_1 at /127.0.0.1:48462 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1014]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(734)) - isDatanode=false, isClient=true, isTransfer=false
2020-12-03 07:23:26,520 [DataXceiver for client DFSClient_NONMAPREDUCE_2923820_1 at /127.0.0.1:48462 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1014]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(736)) - writeBlock receive buf size 531128 tcp no delay true
2020-12-03 07:23:26,520 [DataXceiver for client DFSClient_NONMAPREDUCE_2923820_1 at /127.0.0.1:48462 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1014]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(747)) - Receiving BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1014 src: /127.0.0.1:48462 dest: /127.0.0.1:46659
2020-12-03 07:23:26,520 [DataXceiver for client DFSClient_NONMAPREDUCE_2923820_1 at /127.0.0.1:48462 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1014]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1014
 storageType=DISK, inAddr=/127.0.0.1:48462, myAddr=/127.0.0.1:46659
 stage=PIPELINE_SETUP_APPEND, newGs=1015, minBytesRcvd=84, maxBytesRcvd=84
 clientname=DFSClient_NONMAPREDUCE_2923820_1, srcDataNode=:0, datanode=127.0.0.1:46659
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-c636ee3f-1da8-4dc7-9587-a6f1cdb36618
2020-12-03 07:23:26,520 [DataXceiver for client DFSClient_NONMAPREDUCE_2923820_1 at /127.0.0.1:48462 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1014]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741836_1014, FINALIZED
  getNumBytes()     = 84
  getBytesOnDisk()  = 84
  getVisibleLength()= 84
  getVolume()       = /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2
  getBlockURI()     = file:/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-2057880481-172.17.0.10-1606980199510/current/finalized/subdir0/subdir0/blk_1073741836
2020-12-03 07:23:26,543 [DataXceiver for client DFSClient_NONMAPREDUCE_2923820_1 at /127.0.0.1:48462 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1014]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-2057880481-172.17.0.10-1606980199510/current/rbw/blk_1073741836 of size 84
2020-12-03 07:23:26,544 [DataXceiver for client DFSClient_NONMAPREDUCE_2923820_1 at /127.0.0.1:48462 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1014]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-2057880481-172.17.0.10-1606980199510/current/rbw/blk_1073741836_1015.meta of size 11
2020-12-03 07:23:26,544 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1015, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1015, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-12-03 07:23:26,548 [IPC Server handler 3 on default port 35089] INFO  namenode.FSNamesystem (FSNamesystem.java:updatePipeline(5430)) - updatePipeline(blk_1073741836_1014, newGS=1015, newLength=84, newNodes=[127.0.0.1:46659], client=DFSClient_NONMAPREDUCE_2923820_1)
2020-12-03 07:23:26,549 [IPC Server handler 3 on default port 35089] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3891)) - BLOCK* removeStoredBlock: blk_1073741836_1015 from 127.0.0.1:46659
2020-12-03 07:23:26,549 [IPC Server handler 3 on default port 35089] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3935)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-c636ee3f-1da8-4dc7-9587-a6f1cdb36618:NORMAL:127.0.0.1:46659|RBW] of blk_1073741836_1014
2020-12-03 07:23:26,549 [IPC Server handler 3 on default port 35089] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistBlocks(111)) - persistBlocks: /TestFileAppend2/foo.dat with 1 blocks is persisted to the file system
2020-12-03 07:23:26,549 [IPC Server handler 3 on default port 35089] INFO  namenode.FSNamesystem (FSNamesystem.java:updatePipeline(5448)) - updatePipeline(blk_1073741836_1014 => blk_1073741836_1015) success
2020-12-03 07:23:26,553 [DataXceiver for client DFSClient_NONMAPREDUCE_2923820_1 at /127.0.0.1:48462 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1014]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1015: PacketHeader with packetLen=59 header data: offsetInBlock: 84
seqno: 0
lastPacketInBlock: false
dataLen: 51

2020-12-03 07:23:26,554 [DataXceiver for client DFSClient_NONMAPREDUCE_2923820_1 at /127.0.0.1:48462 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1014]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1015: previous write did not end at the chunk boundary. onDiskLen=84
2020-12-03 07:23:26,554 [DataXceiver for client DFSClient_NONMAPREDUCE_2923820_1 at /127.0.0.1:48462 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1014]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1015: sizePartialChunk=84, block offset=0, metafile offset=7
2020-12-03 07:23:26,554 [DataXceiver for client DFSClient_NONMAPREDUCE_2923820_1 at /127.0.0.1:48462 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1014]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1015
2020-12-03 07:23:26,554 [DataXceiver for client DFSClient_NONMAPREDUCE_2923820_1 at /127.0.0.1:48462 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1014]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 51, skip=0
2020-12-03 07:23:26,554 [DataXceiver for client DFSClient_NONMAPREDUCE_2923820_1 at /127.0.0.1:48462 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1014]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1015, type=LAST_IN_PIPELINE: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=135, ackEnqueueNanoTime=141198329736261, ackStatus=SUCCESS)
2020-12-03 07:23:26,556 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1015, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1015, type=LAST_IN_PIPELINE, replyAck=seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:26,556 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1015, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1015, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-12-03 07:23:26,558 [DataXceiver for client DFSClient_NONMAPREDUCE_2923820_1 at /127.0.0.1:48462 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1014]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1015: PacketHeader with packetLen=4 header data: offsetInBlock: 135
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-12-03 07:23:26,558 [DataXceiver for client DFSClient_NONMAPREDUCE_2923820_1 at /127.0.0.1:48462 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1014]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1015
2020-12-03 07:23:26,558 [DataXceiver for client DFSClient_NONMAPREDUCE_2923820_1 at /127.0.0.1:48462 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1014]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1015, type=LAST_IN_PIPELINE: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=135, ackEnqueueNanoTime=141198333301334, ackStatus=SUCCESS)
2020-12-03 07:23:26,560 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1015, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:48462, dest: /127.0.0.1:46659, bytes: 135, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_2923820_1, offset: 0, srvID: 92140061-a997-4f98-95c8-65cba4629fb7, blockid: BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1015, duration(ns): 14387232
2020-12-03 07:23:26,560 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1015, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1015, type=LAST_IN_PIPELINE, replyAck=seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-12-03 07:23:26,561 [PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1015, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1015, type=LAST_IN_PIPELINE terminating
2020-12-03 07:23:26,561 [DataXceiver for client DFSClient_NONMAPREDUCE_2923820_1 at /127.0.0.1:48462 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1014]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1015, type=LAST_IN_PIPELINE: closing
2020-12-03 07:23:26,561 [IPC Server handler 9 on default port 35089] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1627)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:46659, datanodeUuid=92140061-a997-4f98-95c8-65cba4629fb7, infoPort=42682, infoSecurePort=0, ipcPort=38521, storageInfo=lv=-57;cid=testClusterID;nsid=200687926;c=1606980199510) 1 blocks.
2020-12-03 07:23:26,562 [IPC Server handler 9 on default port 35089] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(674)) - DIR* NameSystem.completeFile: /TestFileAppend2/foo.dat for DFSClient_NONMAPREDUCE_2923820_1
2020-12-03 07:23:26,562 [IPC Server handler 9 on default port 35089] INFO  namenode.FSNamesystem (FSNamesystem.java:checkBlocksComplete(2995)) - BLOCK* blk_1073741836_1015 is COMMITTED but not COMPLETE(numNodes= 0 <  minimum = 1) in file /TestFileAppend2/foo.dat
2020-12-03 07:23:26,563 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(4021)) - Reported block blk_1073741836_1015 on 127.0.0.1:46659 size 135 replicaState = FINALIZED
2020-12-03 07:23:26,563 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(4044)) - In memory blockUCState = COMMITTED
2020-12-03 07:23:26,564 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3351)) - BLOCK* addStoredBlock: 127.0.0.1:46659 is added to blk_1073741836_1015 (size=135)
2020-12-03 07:23:26,564 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4154)) - BLOCK* block RECEIVED_BLOCK: blk_1073741836_1015 is received from 127.0.0.1:46659
2020-12-03 07:23:26,564 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4157)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:46659 receiving: 0, received: 1, deleted: 0
2020-12-03 07:23:26,566 [DataXceiver for client DFSClient_NONMAPREDUCE_2923820_1 at /127.0.0.1:48462 [Receiving block BP-2057880481-172.17.0.10-1606980199510:blk_1073741836_1014]] DEBUG datanode.DataNode (DataXceiver.java:run(328)) - 127.0.0.1:46659:Number of active connections is: 3
2020-12-03 07:23:26,964 [IPC Server handler 1 on default port 35089] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(674)) - DIR* NameSystem.completeFile: /TestFileAppend2/foo.dat for DFSClient_NONMAPREDUCE_2923820_1
2020-12-03 07:23:26,965 [IPC Server handler 1 on default port 35089] DEBUG hdfs.StateChange (FSNamesystem.java:closeFile(4036)) - closeFile: /TestFileAppend2/foo.dat with 1 blocks is persisted to the file system
2020-12-03 07:23:26,965 [IPC Server handler 1 on default port 35089] INFO  hdfs.StateChange (FSNamesystem.java:completeFile(2948)) - DIR* completeFile: /TestFileAppend2/foo.dat is closed by DFSClient_NONMAPREDUCE_2923820_1
2020-12-03 07:23:26,968 [IPC Server handler 0 on default port 35089] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8074)) - allowed=true	ugi=testappenduser (auth:SIMPLE)	ip=/127.0.0.1	cmd=setPermission	src=/TestFileAppend2/foo.dat	dst=null	perm=testappenduser:supergroup:r-xrwxrwx	proto=rpc
2020-12-03 07:23:26,970 [IPC Server handler 2 on default port 35089] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8074)) - allowed=true	ugi=testappenduser (auth:SIMPLE)	ip=/127.0.0.1	cmd=setPermission	src=/TestFileAppend2	dst=null	perm=testappenduser:supergroup:rwxrwxrwx	proto=rpc
2020-12-03 07:23:26,972 [IPC Server handler 6 on default port 35089] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(809)) - *DIR* NameNode.append: file /TestFileAppend2/foo.dat for DFSClient_NONMAPREDUCE_2923820_1 at 127.0.0.1
2020-12-03 07:23:26,972 [IPC Server handler 6 on default port 35089] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2710)) - DIR* NameSystem.appendFile: src=/TestFileAppend2/foo.dat, holder=DFSClient_NONMAPREDUCE_2923820_1, clientMachine=127.0.0.1
2020-12-03 07:23:26,973 [IPC Server handler 6 on default port 35089] WARN  hdfs.StateChange (FSDirAppendOp.java:appendFile(145)) - DIR* NameSystem.append: Permission denied: user=testappenduser, access=WRITE, inode="/TestFileAppend2/foo.dat":testappenduser:supergroup:-r-xrwxrwx
2020-12-03 07:23:26,973 [IPC Server handler 6 on default port 35089] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8074)) - allowed=false	ugi=testappenduser (auth:SIMPLE)	ip=/127.0.0.1	cmd=append	src=/TestFileAppend2/foo.dat	dst=null	perm=null	proto=rpc
2020-12-03 07:23:26,973 [IPC Server handler 6 on default port 35089] INFO  ipc.Server (Server.java:logException(2969)) - IPC Server handler 6 on default port 35089, call Call#67 Retry#0 org.apache.hadoop.hdfs.protocol.ClientProtocol.append from 127.0.0.1:38322: org.apache.hadoop.security.AccessControlException: Permission denied: user=testappenduser, access=WRITE, inode="/TestFileAppend2/foo.dat":testappenduser:supergroup:-r-xrwxrwx
Good: got org.apache.hadoop.security.AccessControlException: Permission denied: user=testappenduser, access=WRITE, inode="/TestFileAppend2/foo.dat":testappenduser:supergroup:-r-xrwxrwx
	at org.apache.hadoop.hdfs.server.namenode.FSPermissionChecker.check(FSPermissionChecker.java:399)
	at org.apache.hadoop.hdfs.server.namenode.FSPermissionChecker.checkPermission(FSPermissionChecker.java:261)
	at org.apache.hadoop.hdfs.server.namenode.FSPermissionChecker.checkPermission(FSPermissionChecker.java:193)
	at org.apache.hadoop.hdfs.server.namenode.FSDirectory.checkPermission(FSDirectory.java:1879)
	at org.apache.hadoop.hdfs.server.namenode.FSDirectory.checkPermission(FSDirectory.java:1863)
	at org.apache.hadoop.hdfs.server.namenode.FSDirectory.checkPathAccess(FSDirectory.java:1813)
	at org.apache.hadoop.hdfs.server.namenode.FSDirAppendOp.appendFile(FSDirAppendOp.java:100)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.appendFile(FSNamesystem.java:2722)
	at org.apache.hadoop.hdfs.server.namenode.NameNodeRpcServer.append(NameNodeRpcServer.java:822)
	at org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolServerSideTranslatorPB.append(ClientNamenodeProtocolServerSideTranslatorPB.java:500)
	at org.apache.hadoop.hdfs.protocol.proto.ClientNamenodeProtocolProtos$ClientNamenodeProtocol$2.callBlockingMethod(ClientNamenodeProtocolProtos.java)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine.java:528)
	at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:1070)
	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:999)
	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:927)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1730)
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2915)

org.apache.hadoop.security.AccessControlException: Permission denied: user=testappenduser, access=WRITE, inode="/TestFileAppend2/foo.dat":testappenduser:supergroup:-r-xrwxrwx
	at org.apache.hadoop.hdfs.server.namenode.FSPermissionChecker.check(FSPermissionChecker.java:399)
	at org.apache.hadoop.hdfs.server.namenode.FSPermissionChecker.checkPermission(FSPermissionChecker.java:261)
	at org.apache.hadoop.hdfs.server.namenode.FSPermissionChecker.checkPermission(FSPermissionChecker.java:193)
	at org.apache.hadoop.hdfs.server.namenode.FSDirectory.checkPermission(FSDirectory.java:1879)
	at org.apache.hadoop.hdfs.server.namenode.FSDirectory.checkPermission(FSDirectory.java:1863)
	at org.apache.hadoop.hdfs.server.namenode.FSDirectory.checkPathAccess(FSDirectory.java:1813)
	at org.apache.hadoop.hdfs.server.namenode.FSDirAppendOp.appendFile(FSDirAppendOp.java:100)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.appendFile(FSNamesystem.java:2722)
	at org.apache.hadoop.hdfs.server.namenode.NameNodeRpcServer.append(NameNodeRpcServer.java:822)
	at org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolServerSideTranslatorPB.append(ClientNamenodeProtocolServerSideTranslatorPB.java:500)
	at org.apache.hadoop.hdfs.protocol.proto.ClientNamenodeProtocolProtos$ClientNamenodeProtocol$2.callBlockingMethod(ClientNamenodeProtocolProtos.java)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine.java:528)
	at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:1070)
	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:999)
	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:927)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1730)
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2915)

	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.hadoop.ipc.RemoteException.instantiateException(RemoteException.java:121)
	at org.apache.hadoop.ipc.RemoteException.unwrapRemoteException(RemoteException.java:88)
	at org.apache.hadoop.hdfs.DFSClient.callAppend(DFSClient.java:1362)
	at org.apache.hadoop.hdfs.DFSClient.append(DFSClient.java:1419)
	at org.apache.hadoop.hdfs.DFSClient.append(DFSClient.java:1389)
	at org.apache.hadoop.hdfs.DistributedFileSystem$5.doCall(DistributedFileSystem.java:420)
	at org.apache.hadoop.hdfs.DistributedFileSystem$5.doCall(DistributedFileSystem.java:416)
	at org.apache.hadoop.fs.FileSystemLinkResolver.resolve(FileSystemLinkResolver.java:81)
	at org.apache.hadoop.hdfs.DistributedFileSystem.append(DistributedFileSystem.java:428)
	at org.apache.hadoop.hdfs.DistributedFileSystem.append(DistributedFileSystem.java:397)
	at org.apache.hadoop.fs.FileSystem.append(FileSystem.java:1379)
	at org.apache.hadoop.hdfs.TestFileAppend2.testSimpleAppend(TestFileAppend2.java:199)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
Caused by: org.apache.hadoop.ipc.RemoteException(org.apache.hadoop.security.AccessControlException): Permission denied: user=testappenduser, access=WRITE, inode="/TestFileAppend2/foo.dat":testappenduser:supergroup:-r-xrwxrwx
	at org.apache.hadoop.hdfs.server.namenode.FSPermissionChecker.check(FSPermissionChecker.java:399)
	at org.apache.hadoop.hdfs.server.namenode.FSPermissionChecker.checkPermission(FSPermissionChecker.java:261)
	at org.apache.hadoop.hdfs.server.namenode.FSPermissionChecker.checkPermission(FSPermissionChecker.java:193)
	at org.apache.hadoop.hdfs.server.namenode.FSDirectory.checkPermission(FSDirectory.java:1879)
	at org.apache.hadoop.hdfs.server.namenode.FSDirectory.checkPermission(FSDirectory.java:1863)
	at org.apache.hadoop.hdfs.server.namenode.FSDirectory.checkPathAccess(FSDirectory.java:1813)
	at org.apache.hadoop.hdfs.server.namenode.FSDirAppendOp.appendFile(FSDirAppendOp.java:100)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.appendFile(FSNamesystem.java:2722)
	at org.apache.hadoop.hdfs.server.namenode.NameNodeRpcServer.append(NameNodeRpcServer.java:822)
	at org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolServerSideTranslatorPB.append(ClientNamenodeProtocolServerSideTranslatorPB.java:500)
	at org.apache.hadoop.hdfs.protocol.proto.ClientNamenodeProtocolProtos$ClientNamenodeProtocol$2.callBlockingMethod(ClientNamenodeProtocolProtos.java)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine.java:528)
	at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:1070)
	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:999)
	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:927)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1730)
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2915)

	at org.apache.hadoop.ipc.Client.getRpcResponse(Client.java:1545)
	at org.apache.hadoop.ipc.Client.call(Client.java:1491)
	at org.apache.hadoop.ipc.Client.call(Client.java:1388)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:233)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:118)
	at com.sun.proxy.$Proxy23.append(Unknown Source)
	at org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolTranslatorPB.append(ClientNamenodeProtocolTranslatorPB.java:400)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.io.retry.RetryInvocationHandler.invokeMethod(RetryInvocationHandler.java:422)
	at org.apache.hadoop.io.retry.RetryInvocationHandler$Call.invokeMethod(RetryInvocationHandler.java:165)
	at org.apache.hadoop.io.retry.RetryInvocationHandler$Call.invoke(RetryInvocationHandler.java:157)
	at org.apache.hadoop.io.retry.RetryInvocationHandler$Call.invokeOnce(RetryInvocationHandler.java:95)
	at org.apache.hadoop.io.retry.RetryInvocationHandler.invoke(RetryInvocationHandler.java:359)
	at com.sun.proxy.$Proxy24.append(Unknown Source)
	at org.apache.hadoop.hdfs.DFSClient.callAppend(DFSClient.java:1328)
	at org.apache.hadoop.hdfs.DFSClient.callAppend(DFSClient.java:1350)
	... 34 more
2020-12-03 07:23:26,978 [Listener at localhost/38521] INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:shutdown(2049)) - Shutting down the Mini HDFS Cluster
2020-12-03 07:23:26,979 [Listener at localhost/38521] INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:shutdownDataNode(2097)) - Shutting down DataNode 0
2020-12-03 07:23:26,980 [Listener at localhost/38521] WARN  datanode.DirectoryScanner (DirectoryScanner.java:shutdown(343)) - DirectoryScanner: shutdown has been called
2020-12-03 07:23:26,981 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@3276732] INFO  datanode.DataNode (DataXceiverServer.java:closeAllPeers(281)) - Closing all peers.
2020-12-03 07:23:26,982 [VolumeScannerThread(/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1)] INFO  datanode.VolumeScanner (VolumeScanner.java:run(637)) - VolumeScanner(/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1, DS-86c38d19-e1c7-408b-beec-a26b98ac3f35) exiting.
2020-12-03 07:23:26,982 [VolumeScannerThread(/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2)] INFO  datanode.VolumeScanner (VolumeScanner.java:run(637)) - VolumeScanner(/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2, DS-c636ee3f-1da8-4dc7-9587-a6f1cdb36618) exiting.
2020-12-03 07:23:27,042 [Listener at localhost/38521] INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@d5ae57e{/,null,UNAVAILABLE}{/datanode}
2020-12-03 07:23:27,056 [Listener at localhost/38521] INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@68759011{HTTP/1.1,[http/1.1]}{localhost:0}
2020-12-03 07:23:27,057 [Listener at localhost/38521] INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@5b58ed3c{/static,file:///root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/src/main/webapps/static/,UNAVAILABLE}
2020-12-03 07:23:27,072 [Listener at localhost/38521] INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@3185fa6b{/logs,file:///root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/log/,UNAVAILABLE}
2020-12-03 07:23:27,083 [Listener at localhost/38521] INFO  ipc.Server (Server.java:stop(3359)) - Stopping server on 38521
2020-12-03 07:23:27,084 [DataXceiver for client DFSClient_NONMAPREDUCE_1712663744_1 at /127.0.0.1:48228 [Waiting for operation #12]] DEBUG datanode.DataNode (DataXceiver.java:run(328)) - 127.0.0.1:46659:Number of active connections is: 0
2020-12-03 07:23:27,093 [IPC Server listener on 0] INFO  ipc.Server (Server.java:run(1330)) - Stopping IPC Server listener on 0
2020-12-03 07:23:27,101 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1465)) - Stopping IPC Server Responder
2020-12-03 07:23:27,102 [BP-2057880481-172.17.0.10-1606980199510 heartbeating to localhost/127.0.0.1:35089] WARN  datanode.IncrementalBlockReportManager (IncrementalBlockReportManager.java:waitTillNextIBR(160)) - IncrementalBlockReportManager interrupted
2020-12-03 07:23:27,102 [BP-2057880481-172.17.0.10-1606980199510 heartbeating to localhost/127.0.0.1:35089] WARN  datanode.DataNode (BPServiceActor.java:run(860)) - Ending block pool service for: Block pool BP-2057880481-172.17.0.10-1606980199510 (Datanode Uuid 92140061-a997-4f98-95c8-65cba4629fb7) service to localhost/127.0.0.1:35089
2020-12-03 07:23:27,205 [BP-2057880481-172.17.0.10-1606980199510 heartbeating to localhost/127.0.0.1:35089] INFO  datanode.DataNode (BlockPoolManager.java:remove(102)) - Removed Block pool BP-2057880481-172.17.0.10-1606980199510 (Datanode Uuid 92140061-a997-4f98-95c8-65cba4629fb7)
2020-12-03 07:23:27,206 [BP-2057880481-172.17.0.10-1606980199510 heartbeating to localhost/127.0.0.1:35089] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:shutdownBlockPool(2814)) - Removing block pool BP-2057880481-172.17.0.10-1606980199510
2020-12-03 07:23:27,209 [refreshUsed-/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-2057880481-172.17.0.10-1606980199510] WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2020-12-03 07:23:27,212 [refreshUsed-/root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-2057880481-172.17.0.10-1606980199510] WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2020-12-03 07:23:27,213 [Listener at localhost/38521] INFO  impl.FsDatasetAsyncDiskService (FsDatasetAsyncDiskService.java:shutdown(193)) - Shutting down all async disk service threads
2020-12-03 07:23:27,214 [Listener at localhost/38521] INFO  impl.FsDatasetAsyncDiskService (FsDatasetAsyncDiskService.java:shutdown(201)) - All async disk service threads have been shut down
2020-12-03 07:23:27,215 [Listener at localhost/38521] INFO  impl.RamDiskAsyncLazyPersistService (RamDiskAsyncLazyPersistService.java:shutdown(177)) - Shutting down all async lazy persist service threads
2020-12-03 07:23:27,215 [Listener at localhost/38521] INFO  impl.RamDiskAsyncLazyPersistService (RamDiskAsyncLazyPersistService.java:shutdown(184)) - All async lazy persist service threads have been shut down
2020-12-03 07:23:27,224 [Listener at localhost/38521] INFO  datanode.DataNode (DataNode.java:shutdown(2164)) - Shutdown complete.
2020-12-03 07:23:27,225 [Listener at localhost/38521] INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:stopAndJoinNameNode(2130)) - Shutting down the namenode
2020-12-03 07:23:27,225 [Listener at localhost/38521] INFO  namenode.FSNamesystem (FSNamesystem.java:stopActiveServices(1334)) - Stopping services started for active state
2020-12-03 07:23:27,227 [org.apache.hadoop.hdfs.server.namenode.LeaseManager$Monitor@30f5a68a] DEBUG namenode.LeaseManager (LeaseManager.java:run(536)) - Monitor is interrupted
java.lang.InterruptedException: sleep interrupted
	at java.lang.Thread.sleep(Native Method)
	at org.apache.hadoop.hdfs.server.namenode.LeaseManager$Monitor.run(LeaseManager.java:534)
	at java.lang.Thread.run(Thread.java:748)
2020-12-03 07:23:27,230 [Listener at localhost/38521] INFO  namenode.FSEditLog (FSEditLog.java:endCurrentLogSegment(1410)) - Ending log segment 1, 59
2020-12-03 07:23:27,230 [org.apache.hadoop.hdfs.server.namenode.FSNamesystem$LazyPersistFileScrubber@4e28bdd1] INFO  namenode.FSNamesystem (FSNamesystem.java:run(4198)) - LazyPersistFileScrubber was interrupted, exiting
2020-12-03 07:23:27,232 [Listener at localhost/38521] INFO  namenode.FSEditLog (FSEditLog.java:printStatistics(778)) - Number of transactions: 60 Total time for transactions(ms): 26 Number of transactions batched in Syncs: 14 Number of syncs: 47 SyncTimes(ms): 11 3 
2020-12-03 07:23:27,232 [org.apache.hadoop.hdfs.server.namenode.FSNamesystem$NameNodeEditLogRoller@4f2c9ba6] INFO  namenode.FSNamesystem (FSNamesystem.java:run(4107)) - NameNodeEditLogRoller was interrupted, exiting
2020-12-03 07:23:27,235 [Listener at localhost/38521] INFO  namenode.FileJournalManager (FileJournalManager.java:finalizeLogSegment(145)) - Finalizing edits file /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/name-0-1/current/edits_inprogress_0000000000000000001 -> /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/name-0-1/current/edits_0000000000000000001-0000000000000000060
2020-12-03 07:23:27,237 [Listener at localhost/38521] INFO  namenode.FileJournalManager (FileJournalManager.java:finalizeLogSegment(145)) - Finalizing edits file /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/name-0-2/current/edits_inprogress_0000000000000000001 -> /root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/name-0-2/current/edits_0000000000000000001-0000000000000000060
2020-12-03 07:23:27,239 [FSEditLogAsync] INFO  namenode.FSEditLog (FSEditLogAsync.java:run(253)) - FSEditLogAsync was interrupted, exiting
2020-12-03 07:23:27,240 [CacheReplicationMonitor(810751973)] INFO  blockmanagement.CacheReplicationMonitor (CacheReplicationMonitor.java:run(169)) - Shutting down CacheReplicationMonitor
2020-12-03 07:23:27,248 [Listener at localhost/38521] INFO  ipc.Server (Server.java:stop(3359)) - Stopping server on 35089
2020-12-03 07:23:27,251 [IPC Server listener on 0] INFO  ipc.Server (Server.java:run(1330)) - Stopping IPC Server listener on 0
2020-12-03 07:23:27,266 [StorageInfoMonitor] INFO  blockmanagement.BlockManager (BlockManager.java:run(4722)) - Stopping thread.
2020-12-03 07:23:27,266 [RedundancyMonitor] INFO  blockmanagement.BlockManager (BlockManager.java:run(4687)) - Stopping RedundancyMonitor.
2020-12-03 07:23:27,266 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1465)) - Stopping IPC Server Responder
2020-12-03 07:23:27,277 [org.apache.hadoop.hdfs.server.blockmanagement.PendingReconstructionBlocks$PendingReconstructionMonitor@79da1ec0] DEBUG blockmanagement.BlockManager (PendingReconstructionBlocks.java:run(248)) - PendingReconstructionMonitor thread is interrupted.
java.lang.InterruptedException: sleep interrupted
	at java.lang.Thread.sleep(Native Method)
	at org.apache.hadoop.hdfs.server.blockmanagement.PendingReconstructionBlocks$PendingReconstructionMonitor.run(PendingReconstructionBlocks.java:246)
	at java.lang.Thread.run(Thread.java:748)
2020-12-03 07:23:27,334 [Listener at localhost/38521] INFO  namenode.FSNamesystem (FSNamesystem.java:stopActiveServices(1334)) - Stopping services started for active state
2020-12-03 07:23:27,334 [Listener at localhost/38521] INFO  namenode.FSNamesystem (FSNamesystem.java:stopStandbyServices(1434)) - Stopping services started for standby state
2020-12-03 07:23:27,335 [Listener at localhost/38521] INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@2fba3fc4{/,null,UNAVAILABLE}{/hdfs}
2020-12-03 07:23:27,342 [Listener at localhost/38521] INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@6a57ae10{HTTP/1.1,[http/1.1]}{localhost:0}
2020-12-03 07:23:27,343 [Listener at localhost/38521] INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@38145825{/static,file:///root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/src/main/webapps/static/,UNAVAILABLE}
2020-12-03 07:23:27,344 [Listener at localhost/38521] INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@12591ac8{/logs,file:///root/hadoop-3.2.1-src/hadoop-hdfs-project/hadoop-hdfs/target/log/,UNAVAILABLE}
2020-12-03 07:23:27,351 [Listener at localhost/38521] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:stop(210)) - Stopping DataNode metrics system...
2020-12-03 07:23:27,358 [Listener at localhost/38521] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:stop(216)) - DataNode metrics system stopped.
2020-12-03 07:23:27,358 [Listener at localhost/38521] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:shutdown(607)) - DataNode metrics system shutdown complete.
msx-rc 0
